(self.webpackChunkqslwidgets=self.webpackChunkqslwidgets||[]).push([[87,393,697],{81609:(e,t,n)=>{"use strict";n.d(t,{f:()=>At,U:()=>Bt});var a=n(56271),i=n.n(a),l=n(78564);const o=e=>{var{name:t,value:n,onValueChange:a,min:o,max:s,width:r,disabled:c,valueLabelDisplay:d="on"}=e,u=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["name","value","onValueChange","min","max","width","disabled","valueLabelDisplay"]);return i().createElement(l.Stack,{direction:"row",alignItems:"center",spacing:2,style:r?{width:r}:{}},i().createElement(l.Typography,{fontSize:"small"},t),i().createElement(l.Slider,Object.assign({},u,{size:"small",value:n,style:r?{width:r}:{},min:o,classes:{thumb:"slider-thumb"},max:s,disabled:c,valueLabelDisplay:d,valueLabelFormat:e=>e,onChange:(e,t)=>a(t)})))},s=i().createContext({}),r=()=>{const e=i().useContext(s);return i().createElement(l.Box,{style:{width:"100%",height:"100%",position:"absolute",top:0},onClick:e.setFocus})},c=255,d=[{dx:0,dy:-1},{dx:-1,dy:0},{dx:0,dy:1},{dx:1,dy:0}],u=(e,t)=>Object.assign(Object.assign({},e),{x:e.x+t.dx,y:e.y+t.dy}),m=(e,t)=>e.y*t+e.x,g=(e,t)=>({x:Math.round(e.x*t.sx),y:Math.round(e.y*t.sy)}),p=(e,t,n)=>{const a={x:Math.max(0,Math.round((e.x-t.dx)*n.width)),y:Math.max(0,Math.round((e.y-t.dy)*n.height))};return{point:a,kernel:{dx:Math.min(Math.round((2*t.dx+Math.min(0,e.x-t.dx))*n.width),n.width-a.x),dy:Math.min(Math.round((2*t.dy+Math.min(0,e.y-t.dy))*n.height),n.height-a.y)}}},h=(e,t,n,a)=>{if(t.x<0||t.y<0||t.x+n.dx>e.dimensions.width||t.y+n.dy>e.dimensions.height)throw`Detected invalid block fill point/parameters. kernel: (${n.dx}, ${n.dy}), point: (${t.x}, ${t.y}), dimensions: (${e.dimensions.width}, ${e.dimensions.height})`;const i=Array(n.dx).fill(a);Array.from(Array(n.dy).keys()).forEach((n=>{e.values.set(i,(t.y+n)*e.dimensions.width+t.x)}))},v=(e,t,n)=>{const a=p(e,n,t.dimensions);return h(t,a.point,a.kernel,0),t.values},b=(e,t,n)=>{const a=Math.pow(n.threshold,2);if(n.previous&&t.width*t.height!==n.previous.values.length)throw`Incompatible dimensions for mask (${n.previous.values.length}) and canvas (${t.width}x${t.height}).`;const i={values:new Uint8ClampedArray(n.previous?n.previous.dimensions.width*n.previous.dimensions.height:t.width*t.height),dimensions:n.previous?n.previous.dimensions:{height:t.height,width:t.width}},l={sx:i.dimensions.width/t.width,sy:i.dimensions.height/t.height},o={equals:(e,t)=>((e,t,n)=>{if(3!==e.length||3!==t.length)throw"These points do not have the same number of color values.";const[a,i,l]=e,[o,s,r]=t,c=2*Math.min(Math.abs(o-a),255-Math.abs(o-a)),d=Math.abs(s-i),u=Math.abs(r-l);return c*c+d*d+u*u<=n})(Array.from(e),Array.from(t),a),isInBounds:e=>e.x<t.width&&e.y<t.height&&e.x>=0&&e.y>=0,getImageValue:e=>{var n;const a=3*m(e,t.width);return null===(n=t.hsv)||void 0===n?void 0:n.slice(a,a+3)},getMatchValue:e=>{const t=m(g(e,l),i.dimensions.width),n=i.values[t];switch(n){case 0:return"unknown";case c:return"matched";default:return e.direction<0||"0"===n.toString(2).padStart(d.length,"0")[e.direction]?"unknown":"visited"}},setMatchValue:(e,t)=>{const n=m(g(e,l),i.dimensions.width);switch(t){case"matched":i.values[n]=c;break;case"visited":const a=i.values[n].toString(2).padStart(d.length,"0"),l=parseInt(a.substring(0,e.direction)+1+a.substring(e.direction+1),2);i.values[n]=l;break;default:throw`Unsupported flood map setting passed: ${t}`}}},s=p(e,n.radius,i.dimensions),r=p(e,n.radius,t);return h(i,s.point,s.kernel,c),((e,t,n)=>{const a=e.filter((e=>t.isInBounds(e)));let i=0;if(n)for(;a.length>0&&i<n;){const e=a.shift(),n=d.map(((t,n)=>Object.assign(Object.assign({},u(e,t)),{origin:e,direction:n}))).filter(t.isInBounds).filter((e=>"unknown"==t.getMatchValue(e))),l=n.filter((e=>{const n=t.getImageValue(e),a=t.getImageValue(e.origin);return void 0!==a&&void 0!==n&&t.equals(a,n)}));n.forEach((e=>t.setMatchValue(e,"visited"))),l.forEach((e=>t.setMatchValue(e,"matched"))),a.push(...l),i+=1}})(((e,t)=>[Array.from(Array(t.dx).keys()).map((n=>[{x:n+e.x,y:e.y},{x:n+e.x,y:e.y+t.dy}])),Array.from(Array(t.dy).keys()).map((n=>[{y:n+e.y,x:e.x},{y:n+e.y,x:e.x+t.dx}]))].flat(2).map((t=>Object.assign(Object.assign({},t),{origin:e,direction:-1}))))(r.point,r.kernel),o,t.hsv?1e6:0),n.previous&&n.previous.values.forEach(((e,t)=>{e===c&&(i.values[t]=e)})),n.radius&&t.hsv&&((e,t)=>{for(let n=0;n<=e.dimensions.height-t.dy;n++){let a=0;for(;a<=e.dimensions.width-t.dx;)[{dx:0,dy:0},{dx:t.dx,dy:0},t,{dx:0,dy:t.dy}].map((t=>(n+t.dy)*e.dimensions.width+a+t.dx)).every((t=>e.values[t]===c))?(h(e,{x:a,y:n},t,c),a+=t.dx):a+=1}})(i,{dx:Math.round(n.radius.dx*i.dimensions.width),dy:Math.round(n.radius.dy*i.dimensions.height)}),i.values},f=e=>100*e+"%",y=e=>{try{return JSON.parse(JSON.stringify(e))}catch(t){throw`Failed to copy object: ${e}`}},x=e=>Object.keys(e).filter((t=>1==e[t].length)).map((t=>`${t}: ${e[t][0]}`)).join(", "),w=1e-4,j=e=>({image:y((null==e?void 0:e.image)||{}),polygons:y((null==e?void 0:e.polygons)||[]),masks:((null==e?void 0:e.masks)||[]).map((e=>{return Object.assign(Object.assign({},e),{map:{dimensions:e.map.dimensions,values:(t=e.map.counts,new Uint8ClampedArray(t.map(((e,t)=>Array.from(Array(e).keys()).map((()=>t%2==0?c:0)))).flat()))}});var t})),dimensions:(null==e?void 0:e.dimensions)?y(e.dimensions):void 0,boxes:y((null==e?void 0:e.boxes)||[])}),k=e=>{const t=e.pt1,n=e.pt2||e.pt1;return Object.assign(Object.assign({},e),{pt1:{x:Math.min(t.x,n.x),y:Math.min(t.y,n.y)},pt2:{x:Math.max(t.x,n.x),y:Math.max(t.y,n.y)}})},E=e=>Object.assign(Object.assign({},e),{boxes:e.boxes.map(k),masks:e.masks.map((e=>{return Object.assign(Object.assign({},e),{map:{dimensions:e.map.dimensions,counts:(t=e.map.values,t.reduce(((e,t)=>((e.length-1)%2==0==(t==c)?e[e.length-1]+=1:e.push(1),e)),[0]))}});var t}))}),O=e=>{let t=e.reduce(((e,t)=>t.options?e.concat(t.options.filter((e=>e.shortcut)).map((e=>e.shortcut))):e),[]);return e.map((e=>Object.assign(Object.assign({},e),{options:e.options?e.options.map((e=>{let n=e.shortcut;return n||(n=[...e.name.toLowerCase()].find((e=>-1==t.indexOf(e))),n&&t.push(n)),Object.assign(Object.assign({},e),{shortcut:n})})):void 0})))},S=(e,t,n)=>Math.pow((e.x-t.x)*(n?n.width:1),2)+Math.pow((e.y-t.y)*(n?n.height:1),2),C=(e,t,n)=>{if(!t.active||"polygons"!==t.mode||0==t.active.region.points.length)return e;const a=t.active.region.points[0];return Math.sqrt(S(a,e,n))>10?e:a};var L=n(92519),M=n.n(L);const $=(e,t,n,a,i,l)=>{let o=M()(e.drawing),s=l;if(!n.source.current)throw"Did not find relevant media elements.";const r=parseFloat(getComputedStyle(n.source.current).getPropertyValue("--media-viewer-scale")||"1");if(1==parseFloat(getComputedStyle(n.source.current).getPropertyValue("--media-viewer-dragging")||"0"))return e;if(o.active&&!o.active.editable)return Object.assign(Object.assign({},e),{drawing:Object.assign(Object.assign({},o),{active:void 0}),labels:Object.assign(Object.assign({},e.labels),{[o.mode]:[o.active.region,...e.labels[o.mode]]})});if("masks"==o.mode){if(!n.canvas.current&&!e.canvas)throw"Did not find necessary canvas element.";const l=e.canvas||((e,t,n)=>{const a=t.getContext("2d"),i={width:"VIDEO"===(l=e).nodeName?l.videoWidth:l.naturalWidth,height:"VIDEO"===l.nodeName?l.videoHeight:l.naturalHeight};var l;if(!a)throw Error("Failed to get a drawing context.");const o=n/Math.max(i.width,i.height);t.width=Math.round(o*i.width),t.height=Math.round(o*i.height),a.filter=getComputedStyle(e).filter,a.drawImage(e,0,0,i.width,i.height,0,0,t.width,t.height);try{const e=Array.from(a.getImageData(0,0,t.width,t.height).data);return{hsv:new Uint8ClampedArray(Array.from(Array(t.width*t.height).keys()).map((t=>((...e)=>{const[t,n,a]=e,i=Math.max(t,n,a),l=Math.min(t,n,a),o=i-l,s=0===i?0:o/i,r=i/255,c=6*o;let d;switch(i){case l:d=0;break;case t:d=(n-a+o*(n<a?6:0))/c;break;case n:d=(a-t+2*o)/c;break;case a:d=(t-n+4*o)/c;break;default:throw"Failed to select appropriate value for h."}return[d,s,r].map((e=>Math.min(Math.round(255*e),255)))})(...e.slice(4*t,4*t+3)))).flat()),width:t.width,height:t.height}}catch(e){return console.error(`Failed to load image, likely due to CORS issues: ${e}.`),{width:t.width,height:t.height}}})(n.source.current,n.canvas.current,i||512),d=Object.assign(Object.assign({},l),{hsv:o.flood?l.hsv:void 0});if("masks"===o.mode&&o.flood&&!d.hsv)throw"Flood fill failed due to cross-origin media. Please disable flood fill.";const u={previous:o.active?o.active.region.map:void 0,radius:{dx:o.radius/n.source.current.clientWidth/r,dy:o.radius/n.source.current.clientHeight/r},threshold:o.threshold};if(o.active)o.active=Object.assign(Object.assign({},o.active),{region:Object.assign(Object.assign({},o.active.region),{map:Object.assign(Object.assign({},o.active.region.map),{values:a&&u.previous?v(t,u.previous,u.radius):b(t,d,u)})})});else{const n=((e,t)=>function(t,n){let a=t.length;for(;a--;)if((i=t[a]).map.values[Math.round(e.y*i.map.dimensions.height)*i.map.dimensions.width+Math.round(e.x*i.map.dimensions.width)]===c)return a;var i;return-1}(t))(t,e.labels.masks);-1===n||a?o.active={editable:!0,region:{map:{dimensions:{width:l.width,height:l.height},values:b(t,d,u)},labels:{}}}:(o.active={editable:!1,region:e.labels.masks[n]},s=n)}return Object.assign(Object.assign({},e),{canvas:l,drawing:o,labels:Object.assign(Object.assign({},e.labels),{[o.mode]:e.labels[o.mode].filter(((e,t)=>t!==s))})})}if("polygons"===o.mode)return o.active?o.active=Object.assign(Object.assign({},o.active),{region:Object.assign(Object.assign({},o.active.region),{points:o.active.region.points.concat([C(t,o,{width:n.source.current.clientWidth*r,height:n.source.current.clientHeight*r})])})}):o.active=a||void 0===l?{region:{points:[t],labels:{}},editable:!0}:{region:e.labels.polygons[l],editable:!1},Object.assign(Object.assign({},e),{drawing:o,labels:Object.assign(Object.assign({},e.labels),{[o.mode]:e.labels[o.mode].filter(((e,t)=>t!==s))})});if("boxes"===o.mode){if(o.active){let e,n;o.active.region.pt2&&S(t,o.active.region.pt1)<S(t,o.active.region.pt2)?(e=t,n=o.active.region.pt2):(e=o.active.region.pt1,n=t),o.active=Object.assign(Object.assign({},o.active),{region:Object.assign(Object.assign({},o.active.region),{pt1:e,pt2:n})})}else o.active||a||void 0===l?o.active={region:{pt1:t,labels:{}},editable:!0}:o.active={region:e.labels.boxes[l],editable:!1};return Object.assign(Object.assign({},e),{drawing:o,labels:Object.assign(Object.assign({},e.labels),{[o.mode]:e.labels[o.mode].filter(((e,t)=>t!==s))})})}throw"Failed to handle media click operation."},z=(e,t,n)=>t&&t.indexOf(e)>-1?n?t.filter((t=>t!=e)):[]:n?(t||[]).concat([e]):[e],I=(e,t)=>{if(!t)throw Error("Requested mouse position without a ref.");const{x:n,y:a,width:i,height:l}=t.getBoundingClientRect();return{x:(e.x-window.scrollX-n)/i,y:(e.y-window.scrollY-a)/l}},T=()=>(0,l.useMediaQuery)((0,l.useTheme)().breakpoints.up("sm")),R=(e,t,n)=>i().useCallback(((n,...a)=>e(I({x:n.nativeEvent.pageX,y:n.nativeEvent.pageY},t.current),n,...a)),[...n||[],t,e]),B=(e,t)=>{const{hasFocus:n}=i().useContext(s),a=i().useCallback((t=>{var a,i;const l=!(!t.target||!t.target.closest(".react-image-labeler-input-target")),o=null===(a=t.target)||void 0===a?void 0:a.nodeName,s="true"===(null===(i=t.target)||void 0===i?void 0:i.contentEditable);n&&"TEXTAREA"!==o&&("INPUT"!==o||l&&n)&&!s&&e(t)}),(t||[]).concat([e,n]));i().useEffect((()=>(document.addEventListener("keydown",a,!1),()=>{document.removeEventListener("keydown",a,!1)})),[a])},N=(e,t)=>new Promise((n=>{if(!e)return;e.focus({preventScroll:!0}),e.classList.add("active");const{x:a,y:i}=e.getBoundingClientRect(),l=Object.assign({bubbles:!0,cancelable:!0},t?{clientX:a+t.x,clientY:i+t.y}:{});e.dispatchEvent(new MouseEvent("mousedown",l)),e.dispatchEvent(new MouseEvent("mouseup",l)),(100,new Promise((e=>setTimeout(e,100)))).then((()=>{e.dispatchEvent(new MouseEvent("click",l)),e.classList.remove("active"),e.blur(),n()}))})),A=()=>{},D=(e,t,n,a)=>{const l=i().useRef(A);i().useEffect((()=>{l.current=e})),i().useEffect((()=>{n&&null!==t&&!1!==t&&l.current()}),[n]),i().useEffect((()=>{if(null===t||!1===t)return;const e=setInterval((()=>l.current()),t);return()=>clearInterval(e)}),[t].concat(a||[]))},P=(e,t)=>{const{setToast:n}=i().useContext(s),[a,l]=i().useState({src:t,loadState:"loading",mediaState:void 0});return i().useEffect((()=>{t!==a.src&&l({src:t,loadState:t?"loading":"loaded",mediaState:a.mediaState})}),[t]),Object.assign(Object.assign({},a),{callbacks:{onError:i().useCallback((()=>{l(Object.assign(Object.assign({},a),{loadState:"error"})),n(`An error occurred loading ${a.src}.`)}),[a]),onLoad:i().useCallback((t=>{e(t).then((e=>l({mediaState:e,loadState:"loaded",src:a.src})),(e=>n(`An error occurred loading ${a.src}.`)))}),[e,a])}})},Z=(e,t,n)=>{const[a,l]=i().useState({labels:j(e||{}),dirty:!1,canvas:null,drawing:{mode:"boxes",radius:5,threshold:1,flood:!1}}),[o,s]=i().useState([]),r=i().useCallback(((e,t)=>{n&&n.length>0&&!t&&s([a].concat(o).slice(0,10)),l(e)}),[o,a]),[c,d]=i().useState(void 0),u=i().useCallback((t=>r(Object.assign(Object.assign({},a),{labels:j(e||{}),dirty:!1,canvas:null,drawing:Object.assign(Object.assign({},a.drawing),{active:void 0})}),t)),[e,a]),m=i().useCallback((()=>s([])),[]),g=i().useCallback((()=>{o.length>0&&(l(Object.assign(Object.assign({},o[0]),{dirty:!0})),s(o.slice(1)))}),[o]);return i().useEffect((()=>u(!0)),[e].concat(t||[])),i().useEffect(m,n||[]),{cursor:c,setCursor:d,draft:a,setDraft:r,resetDraft:u,undo:o.length>0?g:void 0}},F=(e,t,n,a,l,o)=>{const{setFocus:r,setToast:c}=i().useContext(s);return{onClick:i().useCallback(((n,i)=>{if(r(),l&&a.source.current&&(a.canvas.current||e.canvas))try{t($(e,I({x:n.nativeEvent.pageX,y:n.nativeEvent.pageY},a.source.current),a,n.altKey,o,i))}catch(e){c(e)}}),[a.source,e,t]),onMouseMove:R((t=>{if(l&&a.source.current)if("polygons"===e.drawing.mode){const i=parseFloat(getComputedStyle(a.source.current).getPropertyValue("--media-viewer-scale")||"1");n(C(t,e.drawing,{width:a.source.current.clientWidth*i,height:a.source.current.clientHeight*i}))}else n(t)}),a.source,[e])}},K=(e,t)=>e&&e.filter((e=>e.timestamp===t))[0]||{timestamp:t,end:void 0,labels:{image:{}}},U=()=>{const[e,t]=i().useState({contrast:1,brightness:1,saturation:1}),n=i().useMemo((()=>`contrast(${e.contrast}) brightness(${e.brightness}) saturate(${e.saturation})`),[e]);return{value:e,filter:n,set:t}},_=(e,t)=>i().useMemo((()=>{if(t.regions&&0!=t.regions.length)return"masks"===e.mode?"none":"crosshair"}),[e,t,devicePixelRatio]);var q=n(14933);const V=(0,l.styled)(l.Box)`
  & .minimap .mask-cursor {
    display: none;
  }

  & .minimap .region text {
    visibility: hidden;
  }

  & .viewport img,
  .viewport video {
    vertical-align: bottom;
  }

  & .viewport .loading-placeholder .region {
    visibility: hidden;
  }

  & img,
  & video {
    max-width: none;
    max-height: none;
    image-rendering: pixelated;
    -webkit-user-drag: none;
    -khtml-user-drag: none;
    -moz-user-drag: none;
    -o-user-drag: none;
    user-drag: none;
  }
`,W=({children:e,media:t,size:n,controls:a,loadState:c,cursor:d,onMouseLeave:u})=>{const{setFocus:m,maxViewHeight:g}=i().useContext(s),p={viewport:i().useRef(null),minimap:i().useRef(null),media:i().useRef(null)},[h,v]=i().useState({zoom:1,pos:{x:0,y:0},minimapSize:{width:128,height:128},zoomInitialized:!1}),[b,y]=i().useState(!1),[x,w]=i().useState(g);i().useEffect((()=>{if("loading"===c)v(Object.assign(Object.assign({},h),{pos:{x:0,y:0},zoomInitialized:!1}));else if("loaded"==c&&n&&!h.zoomInitialized&&x>0){const e=128/Math.max(n.width,n.height);v(Object.assign(Object.assign({},h),{zoomInitialized:!0,zoom:Math.min(x/n.width,g/n.height),minimapSize:{width:e*n.width,height:e*n.height}}))}}),[c,n,x]),D((()=>{!p.viewport.current||x&&p.viewport.current.clientWidth===x||w(p.viewport.current.clientWidth)}),100,!0,[x]);const j=i().useMemo((()=>{if(!n)return;const e={width:h.zoom*n.width,height:h.zoom*n.height},t={width:Math.min(x,e.width),height:Math.min(g,e.height)};return{raw:n,zoomed:e,viewport:t,margin:{width:t.width/e.width/2,height:t.height/e.height/2}}}),[n,x,g,h.zoom]),k=R((e=>{if(m(),!j)throw"Failed to process minimap position.";v(Object.assign(Object.assign({},h),{pos:{x:Math.max(e.x-j.margin.width,0),y:Math.max(e.y-j.margin.height,0)}}))}),p.minimap,[m,h,j]),E=i().useCallback((e=>{if(j){if(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.ctrlKey){const t=e.cursor||(e.pageX&&e.pageY?I({x:e.pageX,y:e.pageY},p.media.current):null),n=Math.max(h.zoom-e.deltaY/200,10/Math.min(j.raw.width,j.raw.height));let a;a=t?{x:Math.max(t.x-h.zoom*(t.x-h.pos.x)/n,0),y:Math.max(t.y-h.zoom*(t.y-h.pos.y)/n,0)}:h.pos,v(Object.assign(Object.assign({},h),{zoom:n,pos:a}))}else v(Object.assign(Object.assign({},h),{pos:{x:Math.max(h.pos.x+e.deltaX/j.zoomed.width,0),y:Math.max(h.pos.y+e.deltaY/j.zoomed.height,0)}}));return m(),!1}}),[h,j]),O=(0,q.useGesture)({onDrag:({delta:[e,t]})=>{0===e&&0===t||(E({deltaX:-e,deltaY:-t,ctrlKey:!1}),y(!0))},onDragEnd:()=>setTimeout((()=>y(!1)),250),onPinch:e=>{if(e.memo&&e.memo>0&&j){const t=I({x:e.origin[0]+window.scrollX,y:e.origin[1]+window.scrollY},p.media.current);E({deltaX:0,deltaY:e.memo-e.da[0],ctrlKey:!0,cursor:t})}return e.last?-1:e.da[0]}},{drag:{preventDefault:!0}});return i().useEffect((()=>{if(p.media.current)return p.media.current.addEventListener("wheel",E,{passive:!1}),()=>{p.media.current&&p.media.current.removeEventListener("wheel",E)}}),[p.media,E]),i().createElement(V,{className:"media-viewer"},i().createElement(l.Box,{sx:{mb:2}},i().createElement(l.Box,{className:"viewport",style:{position:"relative",overflow:"hidden",height:Math.min(g,(null==j?void 0:j.zoomed.height)||g)},ref:p.viewport},i().createElement(r,null),"loading"==c?i().createElement(l.CircularProgress,{style:{position:"absolute",left:"50%",right:"50%",top:"50%",bottom:"50%"}}):null,i().createElement(l.Box,Object.assign({className:"media",ref:p.media},O(),{onMouseLeave:"loaded"==c?u:void 0,style:"loaded"===c?{"--media-viewer-scale":h.zoom,transform:`scale(${h.zoom}) translate(${f(-h.pos.x)}, ${f(-h.pos.y)})`,"--media-viewer-dragging":b?1:0,transformOrigin:"0 0",position:"absolute",touchAction:"none",cursor:b?"grab":d}:{width:0,height:0,overflow:"hidden"}}),"loaded"===c?e:null,t.main))),i().createElement(l.Box,{className:"controls",style:{display:"grid",gridTemplateColumns:`${h.minimapSize.width}px 1fr`,gridTemplateRows:"auto",gridTemplateAreas:'"minimap zoom"',gridColumnGap:10,alignItems:"center"}},i().createElement(l.Paper,{className:"minimap",style:Object.assign(Object.assign({},h.minimapSize),{position:"relative"}),onClick:k},"loaded"===c&&n?i().createElement("div",{style:{width:"100%",height:"100%"}},i().createElement("div",{style:{transform:`scale(${h.minimapSize.width/n.width})`,transformOrigin:"0 0"}},t.mini),e,j?i().createElement("div",{style:{outline:"2px solid red",outlineOffset:"-1px",position:"absolute",left:f(h.pos.x),top:f(h.pos.y),width:f(Math.min(1-h.pos.x,j.viewport.width/j.zoomed.width)),height:f(Math.min(1-h.pos.y,j.viewport.height/j.zoomed.height))}}):null,i().createElement("div",{ref:p.minimap,className:"hover-target",style:Object.assign(Object.assign({position:"absolute",top:0},h.minimapSize),{display:"block"})})):null),i().createElement(l.Box,null,a||null,i().createElement(o,{name:"Zoom",className:"zoom",min:Math.min(1,Math.round(100*h.zoom)),max:Math.max(500,Math.round(100*h.zoom)),width:"100%",valueLabelDisplay:"auto",value:Math.round(100*h.zoom),onValueChange:e=>v(Object.assign(Object.assign({},h),{zoom:e/100}))}))))};var G=n(47359);const Y=(0,l.styled)(l.Box)`
  & label.label-panel-entry-option-label {
    margin-bottom: 0;
  }

  & legend.label-panel-entry-label {
    margin-bottom: 0;
    border-bottom: none;
  }
`,H=({config:e,selected:t,setSelected:n,disabled:a,editConfig:o})=>{const r=i().useMemo((()=>e.options||e.multiple?((e,t)=>t.concat(e?e.filter((e=>-1==(t||[]).findIndex((t=>t.name===e)))).map((e=>({name:e,shortcut:""}))):[]))(t||[],e.options||[]):void 0),[e.options,t]),c=i().useRef(null),{setFocus:d}=i().useContext(s),u=i().useMemo((()=>r?r.reduce(((e,t,n)=>t.shortcut?Object.assign(Object.assign({},e),{[t.shortcut]:n}):e),{}):{}),[r]),m=i().useCallback((a=>n(e.name,z(a,t,e.multiple))),[t,e,n]);B((e=>{if(e.ctrlKey||e.shiftKey||!u)return;const t=u[e.key];if(t>-1&&c.current){const n=c.current.querySelector(`.react-image-labeler-input-target[data-index='${t}'] input`);N(n),e.preventDefault(),e.stopPropagation(),d()}}),[u,c,d]);const[g,p]=i().useState({freeform:""});return i().useEffect((()=>p({freeform:r||e.multiple||!e.freeform||!t?"":t[0]||""})),[t]),i().createElement(Y,{display:"inline"},i().createElement(l.FormControl,{sx:{ml:3,mr:3,mt:0,mb:3},component:"fieldset",variant:"standard",className:"label-panel-entry",disabled:!!a,name:e.name},i().createElement(l.FormLabel,{component:"legend",className:"label-panel-entry-label",required:e.required},e.displayName||e.name," ",o?i().createElement(l.IconButton,{"aria-label":`edit ${e.name}`,className:"edit-label-entry",onClick:()=>o(e.name)},i().createElement(G.Edit,null)):null),i().createElement(l.FormGroup,{ref:c},(r||[]).map(((n,a)=>{const o={checked:!!(t&&t.indexOf(n.name)>-1),onChange:()=>m(n.name),name:n.name,className:"react-image-labeler-input-target"},s=`${n.displayName||n.name} ${n.shortcut?`(${n.shortcut})`:""}`;return i().createElement(l.FormControlLabel,{className:"label-panel-entry-option-label",key:a,control:e.multiple?i().createElement(l.Checkbox,Object.assign({},o,{"data-index":a})):i().createElement(l.Radio,Object.assign({},o,{"data-index":a,onClick:o.onChange})),color:"primary",label:s})}))),e.freeform?i().createElement(l.Input,{value:g.freeform,name:`${e.name}-freeform`,placeholder:e.multiple?"Add new option":void 0,onKeyPress:t=>{"Enter"===t.key&&(e.multiple||r?(m(g.freeform),p({freeform:""})):d(),t.preventDefault())},onChange:t=>{p(Object.assign(Object.assign({},g),{freeform:t.target.value})),e.multiple||r||m(t.target.value),t.preventDefault(),t.stopPropagation()}}):null))},X=({config:e,labels:t,setLabels:n,disabled:a,editConfig:o})=>{const s=i().useCallback(((e,a)=>n(Object.assign(Object.assign({},t),{[e]:a}))),[t]);return i().createElement(l.Box,{ml:-3,mr:-3},e.map(((e,n)=>i().createElement(H,{key:e.name,config:e,disabled:a,editConfig:o,selected:t[e.name],setSelected:s}))))},J=({open:e,existing:t,allowRegion:n=!0,onSave:a,onClose:o})=>{const s={properties:[],displayName:"",name:"",level:"image",options:[],mockSelected:[],required:!1},[r,c]=i().useState(s);i().useEffect((()=>{var e,n,a,i;t&&c(Object.assign(Object.assign({},s),{properties:[].concat((null===(e=null==t?void 0:t.config)||void 0===e?void 0:e.freeform)?["freeform"]:[]).concat((null===(n=null==t?void 0:t.config)||void 0===n?void 0:n.multiple)?["multiple"]:[]).concat((null===(a=null==t?void 0:t.config)||void 0===a?void 0:a.required)?["required"]:[]),displayName:t.config.displayName||"",name:t.config.name||"",level:t.level||"image",options:(null===(i=null==t?void 0:t.config.options)||void 0===i?void 0:i.map((e=>e.displayName||e.name)))||[]}))}),[t]);const d=i().useMemo((()=>r.name&&(r.properties.indexOf("freeform")>-1||r.options.length>0)),[r]),u=i().useMemo((()=>r.options.length>0?r.options.map((e=>Object.assign({name:e},(null==t?void 0:t.config.options)&&t.config.options.find((t=>(t.displayName||t.name)===e))||{}))):void 0),[r,t]);return i().createElement(l.Modal,{open:e,"aria-describedby":"add-or-update-new-label-entry-description"},i().createElement(l.Box,{sx:{p:2,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",color:"text.secondary",border:"2px solid #000",boxShadow:24}},i().createElement(l.Typography,{id:"add-or-update-new-label-entry-description",sx:{mb:1}},t?"Edit Label Configuration":"Add New Label Configuration"),i().createElement(l.Box,{ml:-3,mr:-3},i().createElement(H,{setSelected:(e,[t])=>c(Object.assign(Object.assign({},r),{name:t})),selected:[r.name],disabled:!!t,config:{multiple:!1,freeform:!0,name:"Name"}}),i().createElement(H,{setSelected:(e,[t])=>c(Object.assign(Object.assign({},r),{displayName:t})),selected:[r.displayName],disabled:!!t,config:{multiple:!1,freeform:!0,name:"Display Name"}}),i().createElement(l.Divider,{sx:{mb:2}}),i().createElement(H,{disabled:!!t,setSelected:(e,[t])=>c(Object.assign(Object.assign({},r),{level:t||r.level})),selected:[r.level],config:{options:n?[{name:"image",displayName:"Image"},{name:"regions",displayName:"Regions"}]:[{name:"image",displayName:"Image"}],multiple:!1,freeform:!1,name:"Level"}}),i().createElement(H,{setSelected:(e,t)=>c(Object.assign(Object.assign({},r),{properties:t})),selected:r.properties,config:{options:[{name:"freeform",displayName:"Freeform"},{name:"multiple",displayName:"Multiple"},{name:"required",displayName:"Required"}],multiple:!0,freeform:!1,name:"Type"}}),i().createElement(H,{setSelected:(e,t)=>c(Object.assign(Object.assign({},r),{options:t})),selected:r.options,config:{options:[],multiple:!0,freeform:!0,name:"Options"}})),i().createElement(l.ButtonGroup,{size:"small","aria-label":"label editing control menu"},i().createElement(l.Button,{disabled:!d,onClick:()=>{a({name:r.name,displayName:r.displayName,multiple:r.properties.indexOf("multiple")>-1,freeform:r.properties.indexOf("freeform")>-1,required:r.properties.indexOf("required")>-1,options:u},r.level),c(s)}},"Save"),i().createElement(l.Button,{onClick:()=>{o(),c(s)}},"Cancel")),d?i().createElement(l.Box,null,i().createElement(l.Divider,{sx:{mt:2,mb:2}}),i().createElement(l.Typography,null,"Your new label configuration will look like the following."),i().createElement(l.Box,{sx:{ml:-3,mr:-3,mt:1,mb:-3}},i().createElement(H,{selected:r.mockSelected,setSelected:(e,t)=>c(Object.assign(Object.assign({},r),{mockSelected:t})),config:{name:r.name,displayName:r.displayName,options:u,multiple:r.properties.indexOf("multiple")>-1,freeform:r.properties.indexOf("freeform")>-1,required:r.properties.indexOf("required")>-1}}))):null))},Q=({data:e})=>i().createElement(l.TableContainer,{tabIndex:0,component:l.Paper,sx:{mb:0,mt:0},className:"metadata"},i().createElement(l.Table,{"aria-label":"metadata table"},i().createElement(l.TableBody,null,Object.entries(e).map((([e,t],n)=>i().createElement(l.TableRow,{key:n,sx:{"&:last-child td, &:last-child th":{border:0}}},i().createElement(l.TableCell,{align:"right",component:"th",scope:"row"},i().createElement("b",null,e)),i().createElement(l.TableCell,null,t)))))));var ee=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n};const te=(0,l.styled)(l.Button)`
  &.Mui-disabled {
    pointer-events: auto;
  }
`,ne=i().forwardRef(((e,t)=>{var{tooltipText:n,disabled:a,onClick:o}=e,s=ee(e,["tooltipText","disabled","onClick"]);const r={disabled:a,component:a?"div":void 0,onClick:a?void 0:o};return i().createElement(l.Tooltip,{title:n||""},i().createElement(te,Object.assign({ref:t},s,r)))})),ae=e=>{var t,{draft:n,disabled:a,callbacks:c,showNavigation:d,setDraft:u,allowRegion:m=!0}=e,g=ee(e,["draft","disabled","callbacks","showNavigation","setDraft","allowRegion"]);const p=(0,l.useTheme)(),h=Object.fromEntries(["next","prev","save","finishRegion","clearRegion","delete","ignore","selectAll","selectNone","undoRegion","undo"].map((e=>[e,i().useRef(null)]))),v=T(),b=i().useMemo((()=>{var e,t;const i=n.drawing.active?"regions":"image",l={image:O((null===(e=g.config)||void 0===e?void 0:e.image)||[]),regions:O((null===(t=g.config)||void 0===t?void 0:t.regions)||[])},o=l[i]||[];return{level:i,activeConfig:o,config:l,direction:v?g.direction:"column",allowRegionSelection:(null==l?void 0:l.regions)&&l.regions.length>0&&m,disableLabelPanel:a||void 0!==n.drawing.active&&!0===n.drawing.active.region.readonly,labels:n.drawing.active?n.drawing.active.region.labels:n.labels.image,editConfig:(null==c?void 0:c.onSaveConfig)?e=>y({configEditorOpen:!0,index:o.findIndex((t=>t.name==e))}):void 0}}),[g.config,n.labels,n.drawing.active,m,a]),[f,y]=i().useState({configEditorOpen:!1,index:null}),{setFocus:x,hasFocus:w,setToast:j}=i().useContext(s),k=i().useMemo((()=>n.drawing.active?b.activeConfig.every((e=>!e.required||(n.drawing.active.region.labels[e.name]||[]).length>0)):b.activeConfig.every((e=>!e.required||(n.labels.image[e.name]||[]).length>0))),[n,b]),E=i().useCallback((e=>{if(!n.drawing.active)throw"Called to finish region but no region is selected.";u(Object.assign(Object.assign({},n),{dirty:!0,labels:Object.assign(Object.assign({},n.labels),{[n.drawing.mode]:(e?[n.drawing.active.region]:[]).concat(n.labels[n.drawing.mode])}),drawing:Object.assign(Object.assign({},n.drawing),{active:void 0})}))}),[n,b,j,u]);B((e=>{let t;if((null==c?void 0:c.onKeyboardEvent)&&c.onKeyboardEvent(e),!e.altKey){switch(e.key){case"A":t=e.ctrlKey&&e.shiftKey?"selectNone":null;break;case"a":t=e.ctrlKey&&!e.shiftKey?"selectAll":null;break;case"z":t=e.metaKey!==e.ctrlKey?n.drawing.active?"undoRegion":"undo":null;break;case"ArrowRight":t=e.ctrlKey||e.shiftKey?null:"next",n.dirty&&null!==t&&(j("Please save or reset your changes before advancing to next item."),t=null);break;case"ArrowLeft":t="prev",n.dirty&&null!==t&&(j("Please save or reset your changes before returning to previous item."),t=null);break;case"Enter":t=e.ctrlKey||e.shiftKey?null:n.drawing.active?"finishRegion":"save";break;case"Backspace":case"Delete":t=e.ctrlKey||e.shiftKey?null:n.drawing.active?"clearRegion":"delete";break;default:return}"finishRegion"!=t&&"save"!=t||k?t&&h[t].current&&(N(h[t].current).then(x),e.preventDefault(),e.stopPropagation()):j("Please fill in all required fields.")}}),[c,f,n,h,x,j,k]);const S=i().useCallback((e=>{u(Object.assign(Object.assign({},n),{dirty:!0,labels:n.drawing.active?n.labels:Object.assign(Object.assign({},n.labels),{image:e}),drawing:n.drawing.active?Object.assign(Object.assign({},n.drawing),{active:Object.assign(Object.assign({},n.drawing.active),{region:Object.assign(Object.assign({},n.drawing.active.region),{labels:e})})}):n.drawing}))}),[n,u]);return i().createElement(l.Box,null,i().createElement(r,null),i().createElement(X,{config:b.activeConfig,disabled:b.disableLabelPanel,labels:b.labels,editConfig:b.editConfig,setLabels:S}),n.drawing&&(null===(t=n.drawing.active)||void 0===t?void 0:t.region.metadata)?i().createElement(l.Box,{sx:{position:"relative",zIndex:1}},i().createElement(Q,{data:n.drawing.active.region.metadata})):null,Object.keys((n.drawing.active?b.config.regions:b.config.image)||[]).length>0?i().createElement(l.Divider,{sx:{mb:3}}):null,b.allowRegionSelection?i().createElement(l.Box,null,i().createElement(l.Stack,{alignContent:"center",direction:b.direction,spacing:2},i().createElement(l.Box,{sx:{borderRight:"masks"===n.drawing.mode?`solid 1px ${p.palette.divider}`:void 0}},i().createElement(l.FormControl,null,i().createElement(l.FormLabel,null,"Drawing Mode"),i().createElement(l.RadioGroup,{row:!0,className:"drawing-mode-select",onChange:e=>u(Object.assign(Object.assign({},n),{drawing:Object.assign(Object.assign({},n.drawing),{mode:e.target.value,active:void 0})})),value:n.drawing.mode},[["boxes","Box"],["polygons","Polygon"],["masks","Mask"]].map((([e,t],o)=>i().createElement(l.FormControlLabel,{key:o,value:e,control:i().createElement(l.Radio,{className:"drawing-mode-option react-image-labeler-input-target",size:"small"}),label:t,disabled:!!n.drawing.active||a})))))),"masks"===n.drawing.mode?i().createElement(l.Box,{style:{display:"grid",gridTemplateColumns:"row"==b.direction?"100px 200px 200px":"100px 200px",gridTemplateAreas:"row"==b.direction?'"toggle threshold size"':'"toggle threshold" "size size"',gridTemplateRows:"auto",columnGap:25}},i().createElement(l.FormControlLabel,{style:{gridArea:"toggle"},control:i().createElement(l.Checkbox,{checked:n.drawing.flood,onChange:(e,t)=>u(Object.assign(Object.assign({},n),{drawing:"masks"===n.drawing.mode?Object.assign(Object.assign({},n.drawing),{flood:t}):n.drawing}))}),label:"Flood"}),i().createElement(l.Box,{style:{gridArea:"threshold",display:"inline-flex"}},i().createElement(o,{name:"Flood Threshold",value:n.drawing.threshold,min:0,disabled:!n.drawing.flood,max:20,width:"100%","aria-label":"segmentation mask flood threshold",onValueChange:e=>u(Object.assign(Object.assign({},n),{drawing:Object.assign(Object.assign({},n.drawing),{threshold:e})}))})),i().createElement(l.Box,{style:{gridArea:"size",display:"inline-flex"}},i().createElement(o,{name:"Cursor Size",value:n.drawing.radius,min:1,max:50,width:"100%","aria-label":"segmentation mask labeling radius",onValueChange:e=>u(Object.assign(Object.assign({},n),{drawing:Object.assign(Object.assign({},n.drawing),{radius:e})}))}))):null),i().createElement(l.Divider,{sx:{mb:2,mt:2}})):null,i().createElement(l.Stack,{direction:b.direction,spacing:2},n.drawing.active?i().createElement(l.ButtonGroup,{fullWidth:!0,size:"small","aria-label":"region control menu"},i().createElement(ne,{ref:h.finishRegion,onClick:()=>E(!0),startIcon:"⏎",disabled:!k,className:"finish-region",tooltipText:k?void 0:"Please fill all required fields."},n.drawing.active.region.readonly?"Deselect":"Finish"),i().createElement(l.Button,{startIcon:"⌫",disabled:n.drawing.active.region.readonly,onClick:()=>E(!1),ref:h.clearRegion},"Delete"),(null==c?void 0:c.onUndo)?i().createElement(l.Button,{disabled:a,onClick:c.onUndo,startIcon:"⌃Z",ref:h.undoRegion},"Undo"):null):i().createElement(l.Stack,{direction:b.direction,spacing:2,style:{width:"100%"}},(null==c?void 0:c.onSelectAll)||(null==c?void 0:c.onSelectNone)?i().createElement(l.ButtonGroup,{fullWidth:!0,size:"small","aria-label":"selection control menu",className:"selection-control"},(null==c?void 0:c.onSelectAll)?i().createElement(l.Button,{disabled:!(null==c?void 0:c.onSelectAll)||a,onClick:null==c?void 0:c.onSelectAll,startIcon:"⌃A",ref:h.selectAll,className:"select-all"},"Select All"):null,(null==c?void 0:c.onSelectNone)?i().createElement(l.Button,{disabled:!(null==c?void 0:c.onSelectNone)||a,onClick:null==c?void 0:c.onSelectNone,startIcon:"⌃⇧A",ref:h.selectNone,className:"select-none"},"Select None"):null):null,i().createElement(l.ButtonGroup,{fullWidth:!0,size:"small","aria-label":"label control menu"},i().createElement(ne,{ref:h.save,disabled:!(null==c?void 0:c.onSave)||a||!k,onClick:null==c?void 0:c.onSave,startIcon:"⏎",className:"save",tooltipText:k?void 0:"Please fill all required fields."},"Save"),(null==c?void 0:c.onIgnore)||(null==c?void 0:c.onUnignore)?i().createElement(l.Button,{ref:h.ignore,disabled:a,onClick:(null==c?void 0:c.onIgnore)||(null==c?void 0:c.onUnignore)},(null==c?void 0:c.onIgnore)?"Ignore":"Unignore"):null,(null==c?void 0:c.onDelete)?i().createElement(l.Button,{startIcon:"⌫",ref:h.delete,disabled:a,onClick:c.onDelete},"Delete"):null,(null==c?void 0:c.onReset)&&n.dirty?i().createElement(l.Button,{disabled:a,onClick:c.onReset},"Reset"):null,(null==c?void 0:c.onUndo)?i().createElement(l.Button,{disabled:a,onClick:c.onUndo,ref:h.undo,startIcon:"⌃Z"},"Undo"):null,c.onDownload?i().createElement(l.Button,{onClick:c.onDownload},"Download"):null),(null==c?void 0:c.onPrev)||(null==c?void 0:c.onNext)||d?i().createElement(l.ButtonGroup,{size:"small",fullWidth:!0,"aria-label":"navigation control menu"},i().createElement(l.Button,{startIcon:i().createElement(G.KeyboardArrowLeft,null),ref:h.prev,disabled:!(null==c?void 0:c.onPrev)||n.dirty,onClick:c.onPrev},"Previous"),i().createElement(l.Button,{startIcon:i().createElement(G.KeyboardArrowRight,null),ref:h.next,disabled:!(null==c?void 0:c.onNext)||n.dirty,onClick:c.onNext},"Next")):null,(null==c?void 0:c.onSaveConfig)||(null==c?void 0:c.onShowIndex)?i().createElement(l.ButtonGroup,{size:"small","aria-label":"add new configuration menu",fullWidth:!0},(null==c?void 0:c.onSaveConfig)?i().createElement(l.Button,{startIcon:i().createElement(G.Add,null),className:"add-new-label",onClick:()=>y({index:null,configEditorOpen:!0})},"Add Type"):null,(null==c?void 0:c.onShowIndex)?i().createElement(l.Button,{startIcon:i().createElement(G.List,null),className:"show-data-index",disabled:a,onClick:c.onShowIndex},"View Index"):null):null),i().createElement(l.Box,{title:w?"Listening for keyboard shortcuts.":"Keyboard shortcuts disabled. Click inside the widget to enable.",onClick:x,style:{zIndex:1}},i().createElement(G.Keyboard,{color:w?"primary":"warning",fontSize:"large"}))),c&&c.onSaveConfig&&f.configEditorOpen?i().createElement(J,{allowRegion:m,open:f.configEditorOpen,onClose:()=>y(Object.assign(Object.assign({},f),{configEditorOpen:!1})),existing:null!==f.index?{config:b.activeConfig[f.index],level:b.level}:void 0,onSave:(e,t)=>{if(null===f.index&&(b.config[t]||[]).find((t=>t.name===e.name)))throw"User attempted to add a config with the name of an existing config.";const n=b.config[t],a=null===f.index?n.length:f.index;c.onSaveConfig(Object.assign(Object.assign({},b.config),{[t]:n.slice(0,a).concat([e]).concat(n.slice(a+1))})),y({index:null,configEditorOpen:!1})}}):null)},ie=({images:e})=>{const[t,n]=i().useState(0);return i().useEffect((()=>n(0)),[e]),i().createElement("div",{style:{width:0,height:0,overflow:"hidden"}},e.map(((e,a)=>a<=t?i().createElement("img",{src:e,key:a,onLoad:()=>n(a+1)}):null)))};var le=n(21379),oe=n(42341);function se(e){let t,n,a,i,l,o,s,r,c,d,u=e[1].labels+"";return{c(){t=(0,le.bi5)("svg"),n=(0,le.bi5)("text"),a=(0,le.fLW)(u),l=(0,le.bi5)("rect"),(0,le.Ljt)(n,"fill",e[0]),(0,le.Ljt)(n,"z",i=0),(0,le.Ljt)(n,"dominant-baseline","hanging"),(0,le.Ljt)(l,"fill","none"),(0,le.Ljt)(l,"x","0"),(0,le.Ljt)(l,"y","0"),(0,le.Ljt)(l,"width","100%"),(0,le.Ljt)(l,"height","100%"),(0,le.Ljt)(l,"stroke",e[0]),(0,le.Ljt)(l,"z",o=1),(0,le.Ljt)(t,"class","region box"),(0,le.Ljt)(t,"width",s=e[1].width),(0,le.Ljt)(t,"height",r=e[1].height),(0,le.czc)(t,"left",e[1].left),(0,le.czc)(t,"top",e[1].top),(0,le.czc)(t,"height",e[1].height)},m(i,o){(0,le.$Tr)(i,t,o),(0,le.R3I)(t,n),(0,le.R3I)(n,a),(0,le.R3I)(t,l),c||(d=[(0,le.oLt)(t,"click",e[10]),(0,le.oLt)(t,"mousemove",e[11])],c=!0)},p(e,[i]){2&i&&u!==(u=e[1].labels+"")&&(0,le.rTO)(a,u),1&i&&(0,le.Ljt)(n,"fill",e[0]),1&i&&(0,le.Ljt)(l,"stroke",e[0]),2&i&&s!==(s=e[1].width)&&(0,le.Ljt)(t,"width",s),2&i&&r!==(r=e[1].height)&&(0,le.Ljt)(t,"height",r),2&i&&(0,le.czc)(t,"left",e[1].left),2&i&&(0,le.czc)(t,"top",e[1].top),2&i&&(0,le.czc)(t,"height",e[1].height)},i:le.ZTd,o:le.ZTd,d(e){e&&(0,le.ogt)(t),c=!1,(0,le.j7q)(d)}}}function re(e,t,n){let a,i,l,o,s,r,c,{box:d,color:u,candidate:m}=t;return e.$$set=e=>{"box"in e&&n(2,d=e.box),"color"in e&&n(0,u=e.color),"candidate"in e&&n(3,m=e.candidate)},e.$$.update=()=>{4&e.$$.dirty&&n(8,a=d.pt1),12&e.$$.dirty&&n(9,i=d.pt2||m),768&e.$$.dirty&&n(4,[l,o,s,r]=void 0!==a&&void 0!==i?[Math.min,Math.max].map((e=>["x","y"].map((t=>e.apply(Math,[a,i].map((e=>e[t]))))))).flat():[a.x,a.y,a.x+w,a.y+w],l,(n(6,o),n(8,a),n(9,i),n(2,d),n(3,m)),(n(5,s),n(8,a),n(9,i),n(2,d),n(3,m)),(n(7,r),n(8,a),n(9,i),n(2,d),n(3,m))),244&e.$$.dirty&&n(1,c={left:f(l),top:f(o),height:f(Math.max(r-o,w)),width:f(Math.max(s-l,w)),labels:x(d.labels)})},[u,c,d,m,l,s,o,r,a,i,function(t){le.cKT.call(this,e,t)},function(t){le.cKT.call(this,e,t)}]}class ce extends le.f_C{constructor(e){super(),(0,le.S1n)(this,e,re,se,le.N8,{box:2,color:0,candidate:3})}}const de=ce;function ue(e){(0,le.qOq)(e,"svelte-1a5p5x9","canvas.svelte-1a5p5x9{image-rendering:pixelated;width:100%;height:100%;top:0}")}function me(e){let t;return{c(){t=(0,le.bGB)("canvas"),(0,le.Ljt)(t,"class","region mask svelte-1a5p5x9")},m(n,a){(0,le.$Tr)(n,t,a),e[3](t)},p:le.ZTd,i:le.ZTd,o:le.ZTd,d(n){n&&(0,le.ogt)(t),e[3](null)}}}function ge(e,t,n){let a,{bitmap:i,color:l}=t;return e.$$set=e=>{"bitmap"in e&&n(1,i=e.bitmap),"color"in e&&n(2,l=e.color)},e.$$.update=()=>{7&e.$$.dirty&&((e,t,n)=>{if(!t)return!1;let a=t.getContext("2d");if(a&&e){t.width=e.dimensions.width,t.height=e.dimensions.height;const i=a.createImageData(e.dimensions.width,e.dimensions.height),l="red"===n?[255,0,0,127]:"blue"===n?[0,0,255,127]:[255,255,0,127];Uint8ClampedArray.from(Array.from(e.values).map((e=>255===e?l:[0,0,0,0])).flat()).forEach(((e,t)=>i.data[t]=e)),a.putImageData(i,0,0)}})(i,a,l)},[a,i,l,function(e){le.VnY[e?"unshift":"push"]((()=>{a=e,n(0,a)}))}]}class pe extends le.f_C{constructor(e){super(),(0,le.S1n)(this,e,ge,me,le.AqN,{bitmap:1,color:2},ue)}}const he=pe;function ve(e,t,n){const a=e.slice();return a[13]=t[n],a}function be(e){let t,n,a,i,l;return{c(){t=(0,le.bi5)("line"),(0,le.Ljt)(t,"stroke",e[0]),(0,le.Ljt)(t,"x1",n=e[13].x1),(0,le.Ljt)(t,"y1",a=e[13].y1),(0,le.Ljt)(t,"x2",i=e[13].x2),(0,le.Ljt)(t,"y2",l=e[13].y2)},m(e,n){(0,le.$Tr)(e,t,n)},p(e,o){1&o&&(0,le.Ljt)(t,"stroke",e[0]),2&o&&n!==(n=e[13].x1)&&(0,le.Ljt)(t,"x1",n),2&o&&a!==(a=e[13].y1)&&(0,le.Ljt)(t,"y1",a),2&o&&i!==(i=e[13].x2)&&(0,le.Ljt)(t,"x2",i),2&o&&l!==(l=e[13].y2)&&(0,le.Ljt)(t,"y2",l)},d(e){e&&(0,le.ogt)(t)}}}function fe(e){let t,n,a,i,l,o,s,r=e[1].labels+"",c=e[1].lines,d=[];for(let t=0;t<c.length;t+=1)d[t]=be(ve(e,c,t));return{c(){t=(0,le.bi5)("svg"),n=(0,le.bi5)("text"),a=(0,le.fLW)(r);for(let e=0;e<d.length;e+=1)d[e].c();(0,le.Ljt)(n,"fill",e[0]),(0,le.Ljt)(n,"alignment-baseline","hanging"),(0,le.Ljt)(t,"class","region polygon"),(0,le.Ljt)(t,"width",i=e[1].width),(0,le.Ljt)(t,"height",l=e[1].height),(0,le.czc)(t,"left",e[1].left),(0,le.czc)(t,"top",e[1].top)},m(i,l){(0,le.$Tr)(i,t,l),(0,le.R3I)(t,n),(0,le.R3I)(n,a);for(let e=0;e<d.length;e+=1)d[e].m(t,null);o||(s=[(0,le.oLt)(t,"click",e[11]),(0,le.oLt)(t,"mousemove",e[12])],o=!0)},p(e,[o]){if(2&o&&r!==(r=e[1].labels+"")&&(0,le.rTO)(a,r),1&o&&(0,le.Ljt)(n,"fill",e[0]),3&o){let n;for(c=e[1].lines,n=0;n<c.length;n+=1){const a=ve(e,c,n);d[n]?d[n].p(a,o):(d[n]=be(a),d[n].c(),d[n].m(t,null))}for(;n<d.length;n+=1)d[n].d(1);d.length=c.length}2&o&&i!==(i=e[1].width)&&(0,le.Ljt)(t,"width",i),2&o&&l!==(l=e[1].height)&&(0,le.Ljt)(t,"height",l),2&o&&(0,le.czc)(t,"left",e[1].left),2&o&&(0,le.czc)(t,"top",e[1].top)},i:le.ZTd,o:le.ZTd,d(e){e&&(0,le.ogt)(t),(0,le.RMB)(d,e),o=!1,(0,le.j7q)(s)}}}function ye(e,t,n){let a,i,l,o,s,r,c,d,{polygon:u,color:m,candidate:g}=t;return e.$$set=e=>{"polygon"in e&&n(2,u=e.polygon),"color"in e&&n(0,m=e.color),"candidate"in e&&n(3,g=e.candidate)},e.$$.update=()=>{12&e.$$.dirty&&n(6,({points:a,xmin:i,ymin:l,xmax:o,ymax:s}=((e,t)=>{const n=t?e.concat([t]):e,[a,i,l,o]=[Math.min,Math.max].map((e=>["x","y"].map((t=>e.apply(Math,n.map((e=>e[t]))))))).flat();return{points:n,xmin:a,ymin:i,xmax:l,ymax:o}})(u.points,g)),a,(n(8,i),n(2,u),n(3,g)),(n(5,l),n(2,u),n(3,g)),(n(10,o),n(2,u),n(3,g)),(n(9,s),n(2,u),n(3,g))),1280&e.$$.dirty&&n(7,r=Math.max(o-i,w)),544&e.$$.dirty&&n(4,c=Math.max(s-l,w)),500&e.$$.dirty&&n(1,d={left:f(i),top:f(l),width:f(r),height:f(c),labels:x(u.labels),lines:Array.from(Array(a.length-1).keys()).map((e=>({x1:f((a[e].x-i)/r),y1:f((a[e].y-l)/c),x2:f((a[e+1].x-i)/r),y2:f((a[e+1].y-l)/c)})))})},[m,d,u,g,c,l,a,r,i,s,o,function(t){le.cKT.call(this,e,t)},function(t){le.cKT.call(this,e,t)}]}class xe extends le.f_C{constructor(e){super(),(0,le.S1n)(this,e,ye,fe,le.N8,{polygon:2,color:0,candidate:3})}}const we=xe;function je(e){(0,le.qOq)(e,"svelte-ug8mf6","div.svelte-ug8mf6{position:absolute;box-sizing:content-box;cursor:none;overflow:visible;pointer-events:none;z-index:1}")}function ke(e){let t;return{c(){t=(0,le.bGB)("div"),(0,le.Ljt)(t,"class","mask-cursor svelte-ug8mf6"),(0,le.czc)(t,"height",2*e[2]+"px"),(0,le.czc)(t,"width",2*e[2]+"px"),(0,le.czc)(t,"border",Ee+"px solid red"),(0,le.czc)(t,"transform","translate("+(-e[2]-Ee)+"px, "+(-e[2]-Ee)+"px) scale(calc(1/var(--media-viewer-scale, 1)))"),(0,le.czc)(t,"left",f(e[0])),(0,le.czc)(t,"top",f(e[1]))},m(e,n){(0,le.$Tr)(e,t,n)},p(e,[n]){4&n&&(0,le.czc)(t,"height",2*e[2]+"px"),4&n&&(0,le.czc)(t,"width",2*e[2]+"px"),4&n&&(0,le.czc)(t,"transform","translate("+(-e[2]-Ee)+"px, "+(-e[2]-Ee)+"px) scale(calc(1/var(--media-viewer-scale, 1)))"),1&n&&(0,le.czc)(t,"left",f(e[0])),2&n&&(0,le.czc)(t,"top",f(e[1]))},i:le.ZTd,o:le.ZTd,d(e){e&&(0,le.ogt)(t)}}}const Ee=2;function Oe(e,t,n){let{x:a,y:i,radius:l}=t;return e.$$set=e=>{"x"in e&&n(0,a=e.x),"y"in e&&n(1,i=e.y),"radius"in e&&n(2,l=e.radius)},[a,i,l]}class Se extends le.f_C{constructor(e){super(),(0,le.S1n)(this,e,Oe,ke,le.N8,{x:0,y:1,radius:2},je)}}const Ce=Se;function Le(e){(0,le.qOq)(e,"svelte-1tocwr2",".region{position:absolute;overflow:visible;z-index:1}.region rect,.region line{stroke-width:calc(2px / var(--media-viewer-scale, 1))}.region text{font-size:calc(10pt / var(--media-viewer-scale, 1));font-family:Roboto, Helvetica, Arial, sans-serif;transform:translate(\n      calc(10px / var(--media-viewer-scale, 1)),\n      calc(10px / var(--media-viewer-scale, 1))\n    )}.active-region.svelte-1tocwr2 .region,.inactive-regions.boxes-mode.svelte-1tocwr2 .polygon,.inactive-regions.masks-mode.svelte-1tocwr2 .polygon,.inactive-regions.polygons-mode.svelte-1tocwr2 .box,.inactive-regions.masks-mode.svelte-1tocwr2 .box,.region.mask,.inactive-regions.drawing-active.svelte-1tocwr2 .region{pointer-events:none}")}function Me(e,t,n){const a=e.slice();return a[5]=t[n],a[7]=n,a}function $e(e,t,n){const a=e.slice();return a[5]=t[n],a[7]=n,a}function ze(e,t,n){const a=e.slice();return a[5]=t[n],a}function Ie(e){let t,n;return t=new he({props:{color:e[5].readonly?"yellow":"blue",bitmap:e[5].map}}),{c(){(0,le.YCL)(t.$$.fragment)},m(e,a){(0,le.yef)(t,e,a),n=!0},p(e,n){const a={};1&n&&(a.color=e[5].readonly?"yellow":"blue"),1&n&&(a.bitmap=e[5].map),t.$set(a)},i(e){n||((0,le.Ui)(t.$$.fragment,e),n=!0)},o(e){(0,le.etI)(t.$$.fragment,e),n=!1},d(e){(0,le.vpE)(t,e)}}}function Te(e){let t,n;return t=new we({props:{color:e[5].readonly?"yellow":"blue",polygon:e[5]}}),t.$on("click",e[3](e[7])),t.$on("mousemove",e[2]),{c(){(0,le.YCL)(t.$$.fragment)},m(e,a){(0,le.yef)(t,e,a),n=!0},p(e,n){const a={};1&n&&(a.color=e[5].readonly?"yellow":"blue"),1&n&&(a.polygon=e[5]),t.$set(a)},i(e){n||((0,le.Ui)(t.$$.fragment,e),n=!0)},o(e){(0,le.etI)(t.$$.fragment,e),n=!1},d(e){(0,le.vpE)(t,e)}}}function Re(e){let t,n;return t=new de({props:{color:e[5].readonly?"yellow":"blue",box:e[5]}}),t.$on("click",e[3](e[7])),t.$on("mousemove",e[2]),{c(){(0,le.YCL)(t.$$.fragment)},m(e,a){(0,le.yef)(t,e,a),n=!0},p(e,n){const a={};1&n&&(a.color=e[5].readonly?"yellow":"blue"),1&n&&(a.box=e[5]),t.$set(a)},i(e){n||((0,le.Ui)(t.$$.fragment,e),n=!0)},o(e){(0,le.etI)(t.$$.fragment,e),n=!1},d(e){(0,le.vpE)(t,e)}}}function Be(e){let t,n;return t=new he({props:{color:"red",bitmap:e[0].drawing.active.region.map}}),{c(){(0,le.YCL)(t.$$.fragment)},m(e,a){(0,le.yef)(t,e,a),n=!0},p(e,n){const a={};1&n&&(a.bitmap=e[0].drawing.active.region.map),t.$set(a)},i(e){n||((0,le.Ui)(t.$$.fragment,e),n=!0)},o(e){(0,le.etI)(t.$$.fragment,e),n=!1},d(e){(0,le.vpE)(t,e)}}}function Ne(e){let t,n;return t=new de({props:{color:"red",box:e[0].drawing.active.region,candidate:e[0].drawing.active.editable?e[1]:void 0}}),{c(){(0,le.YCL)(t.$$.fragment)},m(e,a){(0,le.yef)(t,e,a),n=!0},p(e,n){const a={};1&n&&(a.box=e[0].drawing.active.region),3&n&&(a.candidate=e[0].drawing.active.editable?e[1]:void 0),t.$set(a)},i(e){n||((0,le.Ui)(t.$$.fragment,e),n=!0)},o(e){(0,le.etI)(t.$$.fragment,e),n=!1},d(e){(0,le.vpE)(t,e)}}}function Ae(e){let t,n;return t=new we({props:{color:"red",polygon:e[0].drawing.active.region,candidate:e[0].drawing.active.editable?e[1]:void 0}}),{c(){(0,le.YCL)(t.$$.fragment)},m(e,a){(0,le.yef)(t,e,a),n=!0},p(e,n){const a={};1&n&&(a.polygon=e[0].drawing.active.region),3&n&&(a.candidate=e[0].drawing.active.editable?e[1]:void 0),t.$set(a)},i(e){n||((0,le.Ui)(t.$$.fragment,e),n=!0)},o(e){(0,le.etI)(t.$$.fragment,e),n=!1},d(e){(0,le.vpE)(t,e)}}}function De(e){let t;return{c(){t=(0,le.bGB)("div")},m(e,n){(0,le.$Tr)(e,t,n)},p:le.ZTd,i:le.ZTd,o:le.ZTd,d(e){e&&(0,le.ogt)(t)}}}function Pe(e){let t,n;return t=new Ce({props:{radius:e[0].drawing.radius,x:e[1].x,y:e[1].y}}),{c(){(0,le.YCL)(t.$$.fragment)},m(e,a){(0,le.yef)(t,e,a),n=!0},p(e,n){const a={};1&n&&(a.radius=e[0].drawing.radius),2&n&&(a.x=e[1].x),2&n&&(a.y=e[1].y),t.$set(a)},i(e){n||((0,le.Ui)(t.$$.fragment,e),n=!0)},o(e){(0,le.etI)(t.$$.fragment,e),n=!1},d(e){(0,le.vpE)(t,e)}}}function Ze(e){let t,n,a,i,l,o,s,r,c,d,u,m=e[0].labels.masks,g=[];for(let t=0;t<m.length;t+=1)g[t]=Ie(ze(e,m,t));const p=e=>(0,le.etI)(g[e],1,1,(()=>{g[e]=null}));let h=e[0].labels.polygons,v=[];for(let t=0;t<h.length;t+=1)v[t]=Te($e(e,h,t));const b=e=>(0,le.etI)(v[e],1,1,(()=>{v[e]=null}));let f=e[0].labels.boxes,y=[];for(let t=0;t<f.length;t+=1)y[t]=Re(Me(e,f,t));const x=e=>(0,le.etI)(y[e],1,1,(()=>{y[e]=null})),w=[De,Ae,Ne,Be],j=[];function k(e,t){return e[0].drawing.active?"polygons"===e[0].drawing.mode?1:"boxes"===e[0].drawing.mode?2:"masks"===e[0].drawing.mode?3:-1:0}~(s=k(e))&&(r=j[s]=w[s](e));let E="masks"===e[0].drawing.mode&&e[1]&&Pe(e);return{c(){t=(0,le.bGB)("div");for(let e=0;e<g.length;e+=1)g[e].c();n=(0,le.DhX)();for(let e=0;e<v.length;e+=1)v[e].c();a=(0,le.DhX)();for(let e=0;e<y.length;e+=1)y[e].c();l=(0,le.DhX)(),o=(0,le.bGB)("div"),r&&r.c(),c=(0,le.DhX)(),E&&E.c(),d=(0,le.cSb)(),(0,le.Ljt)(t,"class",i="inactive-regions "+e[0].drawing.mode+"-mode "+(e[0].drawing.active?"drawing-active":"")+" svelte-1tocwr2"),(0,le.Ljt)(o,"class","active-region svelte-1tocwr2")},m(e,i){(0,le.$Tr)(e,t,i);for(let e=0;e<g.length;e+=1)g[e].m(t,null);(0,le.R3I)(t,n);for(let e=0;e<v.length;e+=1)v[e].m(t,null);(0,le.R3I)(t,a);for(let e=0;e<y.length;e+=1)y[e].m(t,null);(0,le.$Tr)(e,l,i),(0,le.$Tr)(e,o,i),~s&&j[s].m(o,null),(0,le.$Tr)(e,c,i),E&&E.m(e,i),(0,le.$Tr)(e,d,i),u=!0},p(e,[l]){if(1&l){let a;for(m=e[0].labels.masks,a=0;a<m.length;a+=1){const i=ze(e,m,a);g[a]?(g[a].p(i,l),(0,le.Ui)(g[a],1)):(g[a]=Ie(i),g[a].c(),(0,le.Ui)(g[a],1),g[a].m(t,n))}for((0,le.dvw)(),a=m.length;a<g.length;a+=1)p(a);(0,le.gbL)()}if(13&l){let n;for(h=e[0].labels.polygons,n=0;n<h.length;n+=1){const i=$e(e,h,n);v[n]?(v[n].p(i,l),(0,le.Ui)(v[n],1)):(v[n]=Te(i),v[n].c(),(0,le.Ui)(v[n],1),v[n].m(t,a))}for((0,le.dvw)(),n=h.length;n<v.length;n+=1)b(n);(0,le.gbL)()}if(13&l){let n;for(f=e[0].labels.boxes,n=0;n<f.length;n+=1){const a=Me(e,f,n);y[n]?(y[n].p(a,l),(0,le.Ui)(y[n],1)):(y[n]=Re(a),y[n].c(),(0,le.Ui)(y[n],1),y[n].m(t,null))}for((0,le.dvw)(),n=f.length;n<y.length;n+=1)x(n);(0,le.gbL)()}(!u||1&l&&i!==(i="inactive-regions "+e[0].drawing.mode+"-mode "+(e[0].drawing.active?"drawing-active":"")+" svelte-1tocwr2"))&&(0,le.Ljt)(t,"class",i);let c=s;s=k(e),s===c?~s&&j[s].p(e,l):(r&&((0,le.dvw)(),(0,le.etI)(j[c],1,1,(()=>{j[c]=null})),(0,le.gbL)()),~s?(r=j[s],r?r.p(e,l):(r=j[s]=w[s](e),r.c()),(0,le.Ui)(r,1),r.m(o,null)):r=null),"masks"===e[0].drawing.mode&&e[1]?E?(E.p(e,l),3&l&&(0,le.Ui)(E,1)):(E=Pe(e),E.c(),(0,le.Ui)(E,1),E.m(d.parentNode,d)):E&&((0,le.dvw)(),(0,le.etI)(E,1,1,(()=>{E=null})),(0,le.gbL)())},i(e){if(!u){for(let e=0;e<m.length;e+=1)(0,le.Ui)(g[e]);for(let e=0;e<h.length;e+=1)(0,le.Ui)(v[e]);for(let e=0;e<f.length;e+=1)(0,le.Ui)(y[e]);(0,le.Ui)(r),(0,le.Ui)(E),u=!0}},o(e){g=g.filter(Boolean);for(let e=0;e<g.length;e+=1)(0,le.etI)(g[e]);v=v.filter(Boolean);for(let e=0;e<v.length;e+=1)(0,le.etI)(v[e]);y=y.filter(Boolean);for(let e=0;e<y.length;e+=1)(0,le.etI)(y[e]);(0,le.etI)(r),(0,le.etI)(E),u=!1},d(e){e&&(0,le.ogt)(t),(0,le.RMB)(g,e),(0,le.RMB)(v,e),(0,le.RMB)(y,e),e&&(0,le.ogt)(l),e&&(0,le.ogt)(o),~s&&j[s].d(),e&&(0,le.ogt)(c),E&&E.d(e),e&&(0,le.ogt)(d)}}}function Fe(e,t,n){let{draft:a,cursor:i}=t;const l=(0,oe.createEventDispatcher)();return e.$$set=e=>{"draft"in e&&n(0,a=e.draft),"cursor"in e&&n(1,i=e.cursor)},[a,i,e=>l("mouseMove",{event:e}),e=>t=>{l("click",{event:t,index:e})}]}class Ke extends le.f_C{constructor(e){super(),(0,le.S1n)(this,e,Fe,Ze,le.N8,{draft:0,cursor:1},Le)}}const Ue=/on([A-Z]{1,}[a-zA-Z]*)/;function _e(e){return t=>{const n=(0,a.useRef)(null),l=(0,a.useRef)(null),[o,s]=(0,a.useState)(!1),r=i().useMemo((()=>{let e={};for(const n in t){const a=n.match(Ue);a&&"function"==typeof t[n]&&(e[`${a[1][0].toLowerCase()}${a[1].slice(1)}`]={callback:t[n],name:n})}return e}),[t]);return(0,a.useEffect)((()=>{if(!l.current)return;const e=[];for(const t in r)e.push(l.current.$on(t,r[t].callback));return()=>{e.forEach((e=>e()))}}),[r]),(0,a.useEffect)((()=>(l.current=new e({target:n.current,props:t}),()=>{l.current.$destroy()})),[]),(0,a.useEffect)((()=>{o?l.current.$set(t):s(!0)}),[t]),i().createElement("div",{ref:n,style:{}})}}const qe=_e(Ke),Ve=e=>i().useCallback((t=>e({nativeEvent:t.detail.event},t.detail.index)),[e]),We=({draft:e,callbacks:t,cursor:n})=>{const a=Ve(t.onMouseMove),l=Ve(t.onClick);return i().createElement(qe,{draft:e,cursor:n,onMouseMove:a,onClick:l})},Ge=({enhancements:e,setEnhancements:t})=>{const n=T();return i().createElement(l.Box,{sx:{display:"grid",gridTemplateColumns:n?"1fr 1fr 1fr 100px":"1fr",columnGap:2}},[{key:"saturation",name:"Saturation"},{key:"brightness",name:"Brightness"},{key:"contrast",name:"Contrast"}].map((n=>i().createElement(o,{min:0,max:10,step:.1,name:n.name,key:n.key,marks:[{value:1}],valueLabelDisplay:"auto",value:e[n.key],onValueChange:a=>t(Object.assign(Object.assign({},e),{[n.key]:a}))}))))},Ye=e=>i().createElement(l.Box,{sx:{display:"flex",alignItems:"center"}},i().createElement(l.Box,{sx:{width:"100%",mr:1}},i().createElement(l.LinearProgress,{variant:"determinate",value:e.progress})),i().createElement(l.Box,{sx:{minWidth:20,textAlign:"right"}},i().createElement(l.Typography,{variant:"body2",color:"text.secondary"},`${Math.round(e.progress)}%`))),He=({layout:e="horizontal",control:t,content:n,metadata:a,progress:o})=>{const s=T();return i().createElement(l.Box,null,void 0!==o&&o>=0?i().createElement(l.Box,{sx:{mb:1}},i().createElement(Ye,{progress:o})):null,i().createElement(l.Box,{style:{display:"grid",gridTemplateColumns:(n||a)&&"horizontal"===e&&s?"315px 1fr":"1fr",gridTemplateRows:"auto",gridTemplateAreas:n||a?"horizontal"===e&&s?'"control-panel image-target"':'"image-target" "control-panel"':'"control-panel"',gridColumnGap:n||a?20:0,rowGap:n||a?20:0,position:"relative"}},i().createElement(l.Box,{style:{position:"relative",gridArea:"control-panel"}},i().createElement(r,null),t),i().createElement(l.Box,{style:{position:"relative",gridArea:"image-target"}},i().createElement(r,null),i().createElement(l.Stack,{rowGap:1},n,a?i().createElement(l.Box,{sx:{position:"relative",zIndex:1}},i().createElement(Q,{data:a})):null))))},Xe=({target:e,labels:t={image:{}},options:n,callbacks:a,metadata:o,preload:s,config:r={image:[],regions:[]}})=>{var c,d,u;const{draft:m,setDraft:g,resetDraft:p,cursor:h,setCursor:v,undo:b}=Z(t,[e],[e]),f={viewer:i().useRef(null),source:i().useRef(null),canvas:i().useRef(null)},y=U(),x=P(i().useCallback((e=>new Promise(((e,t)=>{if(f.source.current){const t={width:f.source.current.naturalWidth,height:f.source.current.naturalHeight};e({size:t,layout:t.height>t.width?"horizontal":"vertical"})}else t("Did not find source ref.")}))),[f.source,e]),e),w=i().useCallback((()=>{var e;return(null==a?void 0:a.onSave)?a.onSave(Object.assign(Object.assign({},E(m.labels)),{dimensions:null===(e=x.mediaState)||void 0===e?void 0:e.size})):void 0}),[m,x.mediaState,null==a?void 0:a.onSave]),j=F(m,g,v,f,!!(r.regions&&r.regions.length>0),null==n?void 0:n.maxCanvasSize),k=_(m.drawing,r);return i().createElement(He,{metadata:o,progress:null==n?void 0:n.progress,layout:(null===(c=x.mediaState)||void 0===c?void 0:c.layout)||"horizontal",control:i().createElement(ae,{config:r,disabled:"loading"===x.loadState,direction:"horizontal"===((null===(d=x.mediaState)||void 0===d?void 0:d.layout)||"horizontal")?"column":"row",draft:m,showNavigation:null==n?void 0:n.showNavigation,setDraft:g,callbacks:Object.assign(Object.assign({},a),{onSave:(null==a?void 0:a.onSave)?w:void 0,onReset:p,onUndo:b})}),content:i().createElement(l.Box,null,i().createElement(l.Box,null,i().createElement(W,{size:null===(u=x.mediaState)||void 0===u?void 0:u.size,cursor:k,controls:i().createElement(Ge,{enhancements:y.value,setEnhancements:e=>{y.set(e),g(Object.assign(Object.assign({},m),{canvas:null}))}}),media:{main:e?i().createElement("img",Object.assign({},j,{ref:f.source,onLoad:x.callbacks.onLoad,onError:x.callbacks.onError,draggable:!1,src:x.src,style:{filter:y.filter}})):null,mini:e?i().createElement("img",{src:x.src,style:{filter:y.filter}}):null},loadState:x.loadState,onMouseLeave:()=>v(void 0)},i().createElement(We,{cursor:h,config:r,draft:m,callbacks:j}))),"loading"!==x.loadState&&null===m.canvas?i().createElement("canvas",{style:{display:"none"},ref:f.canvas}):null,"loading"!==x.loadState&&s?i().createElement(ie,{images:s}):null)})},Je=e=>void 0===e||isNaN(e)?"00:00":`${Math.floor(e/60).toString().padStart(2,"0")}:${Math.round(e%60).toString().padStart(2,"0")}`,Qe=({timestamp:e,secondary:t,duration:n,marks:a,setTimestamp:o,setSecondary:s,secondaryThumbnail:r})=>i().createElement(l.Box,{sx:{width:"100%"},className:"playbar"},i().createElement(l.Stack,{direction:"row",alignItems:"center",spacing:2},i().createElement(l.Typography,{fontSize:"small"},Je(e),"/",Je(n)),i().createElement(l.Box,{style:{width:"100%",display:"inherit",position:"relative"}},void 0!==t&&void 0!==n?i().createElement(l.Box,{style:{position:"absolute",maxWidth:100,maxHeight:100,left:f(t/n),bottom:"60%"}},r):null,i().createElement(l.Slider,{size:"small",min:0,step:.01,classes:{thumb:"slider-thumb"},componentsProps:{markLabel:{onClick:e=>{const t=e.currentTarget.getAttribute("data-index");t&&o(a[parseInt(t)])}}},max:n||10,valueLabelDisplay:"auto",marks:a.map((e=>({value:e,label:e}))),value:[e].concat(void 0!==t?[t]:[]),onChange:(e,t,n)=>{const a=t,i=e.altKey;i&&(1==a.length||a[n]>=a[1-n])?s(a[n]):i||o(a[n])}})))),et=({target:e,config:t={image:[],regions:[]},labels:n,metadata:a,options:o,callbacks:r})=>{var c,d,u,m;const g={mini:i().useRef(null),main:i().useRef(null),secondaryThumbnail:i().useRef(null),viewer:i().useRef(null),canvas:i().useRef(null),playpause:i().useRef(null),fastforward:i().useRef(null),mute:i().useRef(null)},{setFocus:p,setToast:h}=i().useContext(s),v=U(),b=i().useMemo((()=>n||[]),[n]),{playbackState:f,setPlaybackState:y,toggleMute:x}=((e,t)=>{const{setFocus:n}=i().useContext(s),[a,l]=i().useState({paused:!0,playbackRate:0,muted:!1,timestamp:0,labels:{image:{}},end:void 0});i().useEffect((()=>{e.main.current&&l(Object.assign(Object.assign({},a),K(t,e.main.current.currentTime)))}),[t,e.main]),D((()=>{!e.main.current||e.main.current.paused===a.paused&&e.main.current.currentTime===a.timestamp&&e.main.current.playbackRate===a.playbackRate||l(Object.assign(Object.assign(Object.assign(Object.assign({},a),{paused:e.main.current.paused,playbackRate:e.main.current.playbackRate}),e.main.current.paused?K(t,e.main.current.currentTime):{end:void 0,labels:{}}),{timestamp:e.main.current.currentTime})),e.secondaryThumbnail.current&&a.end&&e.secondaryThumbnail.current.currentTime!==a.end&&(e.secondaryThumbnail.current.currentTime=a.end),["main","mini"].map((t=>{const n=e[t].current;n&&n&&n.muted!==a.muted&&(n.muted=a.muted)}))}),10,!0);const o=i().useCallback((()=>l(Object.assign(Object.assign({},a),{muted:!a.muted}))),[a]),r=i().useCallback(((t,i,o)=>{if(e.main.current&&e.mini.current){if(0==t)e.main.current.pause(),e.mini.current.pause();else if(t>0)e.main.current.playbackRate=t,e.mini.current.playbackRate=t,e.main.current.paused&&(e.main.current.play(),e.mini.current.play());else if(t<0)throw"Rewinding is not supported.";void 0!==i&&(e.main.current.currentTime=i,e.mini.current.currentTime=i),void 0!==o&&l(Object.assign(Object.assign({},a),{end:o})),n()}}),[e,a,n]);return{playbackState:a,setPlaybackState:r,toggleMute:o}})(g,b),{draft:w,setDraft:j,resetDraft:k,cursor:O,setCursor:S,undo:C}=Z(f.labels,[f.timestamp,e],[f.timestamp,e]);B((e=>{let t;switch(e.key){case"Spacebar":case" ":t=w.dirty?null:"playpause",t||h("Save or reset your labels to continue playback.");break;case"ArrowRight":t=e.altKey&&!w.dirty?"fastforward":null,!t&&e.altKey&&h("Save or reset your labels to continue playback.");break;case"m":t=e.altKey?"mute":null;default:return}t&&g[t].current&&(N(g[t].current).then(p),e.preventDefault(),e.stopPropagation())}),[g]);const L=P((e=>new Promise(((e,t)=>{if(g.main.current){const t={width:g.main.current.videoWidth,height:g.main.current.videoHeight};e({duration:g.main.current.duration,layout:t.height>t.width?"horizontal":"vertical",size:t})}else t("Could not handle loading because video element was missing.")}))),e),M=F(w,j,S,{source:g.main,canvas:g.canvas},!!(t.regions&&t.regions.length>0),null==o?void 0:o.maxCanvasSize),$=i().useMemo((()=>f.paused?M:{onClick:()=>y(0),onMouseMove:void 0}),[f.paused,y]),z=[{icon:f.paused?G.PlayArrow:G.Pause,label:f.paused?"play (spacebar)":"pause (spacebar)",className:"playpause",disabled:f.paused&&w.dirty,ref:g.playpause,callbacks:{onClick:()=>y(f.paused?1:0)}},{icon:G.FastForward,label:"forward (alt→)",className:"fastforward",ref:g.fastforward,disabled:f.paused&&w.dirty,callbacks:{onClick:()=>y(f.playbackRate+1)}},{icon:f.muted?G.VolumeMute:G.VolumeUp,label:"mute/unmute forward (alt+m)",className:"mute",ref:g.mute,disabled:!f.paused,callbacks:{onClick:x}}],I=_(w.drawing,t);return i().createElement(He,{metadata:a,layout:(null===(c=L.mediaState)||void 0===c?void 0:c.layout)||"horizontal",progress:null==o?void 0:o.progress,control:i().createElement(ae,{config:t,disabled:"loading"===L.loadState||!f.paused,direction:"horizontal"===((null===(d=L.mediaState)||void 0===d?void 0:d.layout)||"horizontal")?"column":"row",draft:w,showNavigation:null==o?void 0:o.showNavigation,setDraft:j,callbacks:Object.assign(Object.assign({},r),{onSave:()=>{return(null==r?void 0:r.onSave)?r.onSave((e={labels:E(w.labels),timestamp:f.timestamp,end:f.end},(a=t=n||[],i=e,l=t.findIndex((t=>t.timestamp===e.timestamp)),!0,[i].concat(a.slice(0,l>-1?l:void 0).concat(l>-1?a.slice(l+1):[]))).sort(((e,t)=>e.timestamp>t.timestamp?1:-1)))):void 0;var e,t,a,i,l},onReset:k,onUndo:C})}),content:i().createElement(l.Box,null,i().createElement(W,{size:null===(u=L.mediaState)||void 0===u?void 0:u.size,loadState:L.loadState,cursor:f.paused?I:void 0,onMouseLeave:()=>S(void 0),media:{main:i().createElement("video",Object.assign({disablePictureInPicture:!0,onLoadedMetadata:L.callbacks.onLoad,onError:L.callbacks.onError},$,{ref:g.main,src:L.src,style:{filter:v.filter}})),mini:i().createElement("video",{src:e,ref:g.mini,style:{filter:v.filter}})},controls:i().createElement(l.Box,null,i().createElement(l.Stack,{direction:"row",alignItems:"center",spacing:2},i().createElement(l.Stack,{direction:"row",alignItems:"center",spacing:0},z.map((e=>i().createElement(l.IconButton,Object.assign({},e.callbacks,{disabled:e.disabled,className:e.className,ref:e.ref,key:e.label,"aria-label":e.label,title:e.label,size:"small"}),i().createElement(e.icon,{fontSize:"small"}))))),i().createElement(Qe,{marks:(n||[]).map((e=>e.timestamp)),timestamp:f.timestamp,duration:null===(m=L.mediaState)||void 0===m?void 0:m.duration,secondary:f.end,secondaryThumbnail:i().createElement("video",{src:e,ref:g.secondaryThumbnail,style:{maxWidth:"100%",maxHeight:"100%",filter:v.filter}}),setSecondary:e=>y(0,void 0,e),setTimestamp:e=>w.dirty?void 0:y(0,e)})),i().createElement(Ge,{enhancements:v.value,setEnhancements:e=>{v.set(e),j(Object.assign(Object.assign({},w),{canvas:null}))}}))},i().createElement(We,{config:t,cursor:O,draft:w,callbacks:M})),"loading"!==L.loadState&&null===w.canvas?i().createElement("canvas",{style:{display:"none"},ref:g.canvas}):null)})},tt=(0,l.styled)(l.ImageList)`
  & .MuiImageListItem-root {
    width: 100%;

    & img {
      transition: opacity 1s;
      z-index: 0;
      opacity: 1;
    }

    &.active,
    &:active img {
      transition: opacity 1s;
      opacity: 0.25;
    }
  }
  & .MuiImageListItemBar-titleWrap {
    padding: 8px;
  }
  & .MuiImageListItemBar-root {
    z-index: 1;
    background: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0.7) 0%,
      rgba(0, 0, 0, 0.3) 70%,
      rgba(0, 0, 0, 0) 100%
    );
  }
`,nt=({target:e=[],labels:t,options:n,callbacks:a,setStates:o,states:c,config:d={image:[],regions:[]},columns:u=3})=>{const m=T(),g=U(),p=i().useCallback((e=>o(c.slice(0,e).concat([Object.assign(Object.assign({},c[e]),{selected:!c[e].selected})]).concat(c.slice(e+1)))),[o,c]),{setToast:h}=i().useContext(s),{draft:v,setDraft:b,resetDraft:f}=Z(t,[e]),y=i().useCallback((()=>(null==a?void 0:a.onSave)?a.onSave(Object.assign({},E(v.labels))):void 0),[v,null==a?void 0:a.onSave]);return i().useEffect((()=>{c&&c.some((e=>["boxes","masks","polygons"].some((t=>e.labels&&e.labels[t||"masks"]&&e.labels[t||"masks"].length>0))))&&h("Warning: One of these items has region labels that will be overwritten upon saving.")}),[c]),i().createElement(He,{layout:m?"horizontal":"vertical",progress:null==n?void 0:n.progress,control:i().createElement(ae,{disabled:!1,direction:"column",showNavigation:null==n?void 0:n.showNavigation,config:{image:null==d?void 0:d.image,regions:void 0},draft:v,setDraft:b,callbacks:Object.assign(Object.assign({},a),{onSave:(null==a?void 0:a.onSave)?y:void 0,onReset:f,onSelectAll:c.some((e=>e.visible&&!e.selected))?()=>o(c.map((e=>Object.assign(Object.assign({},e),{selected:e.visible})))):void 0,onSelectNone:c.some((e=>e.visible&&e.selected))?()=>o(c.map((e=>Object.assign(Object.assign({},e),{selected:!1})))):void 0})}),content:i().createElement(l.Box,null,i().createElement(r,null),i().createElement(tt,{cols:u,sx:{mt:0},variant:"masonry"},c.map(((t,n)=>{var a;return t.visible?i().createElement(l.ImageListItem,{key:n,"data-index":n,onClick:()=>p(n),tabIndex:0,className:"batch-image-list-item"},i().createElement(l.ImageListItemBar,{position:"top",title:i().createElement(l.Box,{sx:{height:25}},t.ignored?i().createElement(l.Box,{title:"ignored",flexDirection:"row-reverse",alignItems:"center",display:"flex"},i().createElement(G.VisibilityOff,null)):t.labeled?i().createElement(l.Box,{title:"labeled",flexDirection:"row-reverse",alignItems:"center",display:"flex"},i().createElement(G.TurnedIn,null)):null),actionIcon:i().createElement(l.IconButton,{sx:{color:"white"},"aria-label":`selected ${n}`},t.selected?i().createElement(G.CheckCircle,null):i().createElement(G.Circle,null)),actionPosition:"left"}),e[n]?i().createElement("img",{src:e[n],style:{filter:g.filter}}):i().createElement(l.Box,{sx:{mb:5}}),t.metadata?i().createElement(Q,{data:Object.fromEntries(Object.entries(t.metadata||{}).concat((null===(a=t.labels)||void 0===a?void 0:a.image)?(d.image||[]).map((e=>[e.displayName||e.name,t.labels.image[e.name]?e.multiple?t.labels.image[e.name].join(", "):t.labels.image[e.name][0]:void 0])).filter((([e,t])=>void 0!==t)):[]))}):null):null}))),i().createElement(Ge,{enhancements:g.value,setEnhancements:g.set}))})},at=i().forwardRef(((e,t)=>i().createElement("div",{style:{width:0,height:0,overflow:"hidden"}},i().createElement("div",{ref:t,className:"react-image-labeler-input-target",tabIndex:-1}))));var it=n(62976);const lt=e=>{var{maxViewHeight:t=512,children:n}=e,a=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["maxViewHeight","children"]);const o={hidden:i().useRef(null),container:i().useRef(null)},[r,c]=i().useState(""),[d,u]=i().useState(!1),m=i().useCallback((()=>{o.hidden.current&&o.hidden.current.focus({preventScroll:!0})}),[o.hidden]);D((()=>{const e=!(!o.container.current||!o.container.current.contains(document.activeElement));e!==d&&u(e)}),100,!0,[o,d]);const g=i().useCallback((()=>{c(""),m()}),[c,m]);return i().createElement(s.Provider,{value:{container:o.container,setToast:c,setFocus:m,hasFocus:d,maxViewHeight:t}},i().createElement(l.Box,{className:"react-image-labeler",ref:o.container,style:{position:"relative"}},i().createElement(l.Box,Object.assign({},a),n,i().createElement(at,{ref:o.hidden}),i().createElement(l.Snackbar,{sx:{position:"absolute",height:"100%",left:"50%"},anchorOrigin:{horizontal:"center",vertical:"top"},open:""!==r,autoHideDuration:3e3,action:i().createElement(i().Fragment,null,i().createElement(l.IconButton,{size:"small","aria-label":"close",color:"inherit",onClick:g},i().createElement(it.Z,{fontSize:"small"}))),onClose:g,message:r}))))};var ot=n(5228);const st=(0,l.styled)(ot.DataGrid)`
  & .MuiDataGrid-cell:focus {
    outline: none;
  }
`,rt=({idx:e,indexState:t,setIndexState:n,label:a,visible:o=!0,rowKey:r})=>{const c=i().useRef(null),{setFocus:d,maxViewHeight:u}=i().useContext(s);return B((e=>{if(!c.current||!o)return;let t;switch(e.key){case"ArrowRight":t=".MuiTablePagination-actions button:nth-of-type(2)";break;case"ArrowLeft":t=".MuiTablePagination-actions button:nth-of-type(1)";break;default:return}if(!t)return;const n=c.current.querySelector(t);n&&(N(n),d())}),[c,o]),i().createElement(l.Box,{onClick:d},i().createElement(l.Box,{style:{height:u,width:"100%"},ref:c},i().createElement(st,{disableColumnFilter:!0,rows:t.rows,rowCount:t.rowCount,columns:t.columns,paginationMode:"server",autoHeight:!0,pageSize:t.rowsPerPage,rowsPerPageOptions:[t.rowsPerPage],disableSelectionOnClick:!0,onRowClick:e=>a(e.id),selectionModel:[e],page:t.page,onPageChange:e=>n(Object.assign(Object.assign({},t),{page:e})),sortModel:t.sortModel,onSortModelChange:e=>n(Object.assign(Object.assign({},t),{sortModel:e})),hideFooterSelectedRowCount:!0,getRowId:e=>e[r]})),i().createElement(l.ButtonGroup,{sx:{mt:2},fullWidth:!0,size:"small","aria-label":"index control menu"},i().createElement(l.Button,{onClick:()=>a(e),startIcon:i().createElement(G.ArrowBack,null)},"Back to Labeling")))};var ct=n(75243),dt=n.n(ct),ut=n(48931);const mt=(0,l.styled)(l.Box)`
  & .recharts-reference-area-rect {
    fill-opacity: 0.25;
  }
  & .recharts-reference-area.active .recharts-reference-area-rect:hover,
  .recharts-reference-area-rect:hover {
    fill: red;
  }
  & .recharts-reference-area.active .recharts-reference-area-rect {
    fill: blue;
  }

  & .recharts-dot {
    fill: white;
    stroke: var(--line-color);
  }

  & .recharts-dot.hoverable:hover,
  .recharts-dot.active {
    fill: var(--line-color);
  }

  & .recharts-dot.active:hover {
    fill: red;
    stroke: red;
  }

  & .recharts-text.recharts-label {
    text-anchor: middle;
  }
`,gt=({target:e,toggle:t,labels:n})=>{const{setFocus:a}=i().useContext(s),l=i().useMemo((()=>e.plots.map((e=>e.x.values.map(((t,n)=>Object.assign(Object.assign({},Object.fromEntries(e.y.lines.map((e=>[e.name,e.values[n]])))),{[e.x.name]:t})))))),[e]);return i().createElement(mt,{onClick:a},e.plots.map(((e,o)=>{var s,r,c,d,u,m,g,p,h,v,b,f;return i().createElement(ut.LineChart,{key:o,width:(null===(s=e.size)||void 0===s?void 0:s.width)||512,height:(null===(r=e.size)||void 0===r?void 0:r.height)||256,data:l[o]},i().createElement(ut.XAxis,{height:e.x.height||60,dataKey:e.x.name,type:e.x.type||"number",label:e.x.name}),i().createElement(ut.YAxis,{type:(null===(c=e.y.types)||void 0===c?void 0:c.left)||"number",domain:null===(d=e.y.limits)||void 0===d?void 0:d.left,allowDataOverflow:!0,label:(null===(u=e.y.labels)||void 0===u?void 0:u.left)?{value:null===(m=e.y.labels)||void 0===m?void 0:m.left,angle:-90,position:"insideLeft"}:void 0,width:(null===(g=e.y.widths)||void 0===g?void 0:g.left)||60,yAxisId:"left",orientation:"left"}),i().createElement(ut.YAxis,{type:(null===(p=e.y.types)||void 0===p?void 0:p.right)||"number",allowDataOverflow:!0,domain:null===(h=e.y.limits)||void 0===h?void 0:h.right,label:(null===(v=e.y.labels)||void 0===v?void 0:v.right)?{value:null===(b=e.y.labels)||void 0===b?void 0:b.right,angle:-90,position:"insideRight"}:void 0,width:(null===(f=e.y.widths)||void 0===f?void 0:f.right)||60,yAxisId:"right",orientation:"right"}),i().createElement(ut.Legend,null),i().createElement(ut.CartesianGrid,null),(e.areas||[]).map(((e,l)=>i().createElement(ut.ReferenceArea,{yAxisId:"left",label:e.label,key:l,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2,stroke:e.stroke||"black",strokeDasharray:e.strokeDashArray||"4",className:(n.image&&n.image[e.labelKey]?n.image[e.labelKey]:[]).indexOf(e.labelVal)>-1?"active":void 0,onClick:()=>{t&&t(e.labelKey,e.labelVal),a()}}))),e.y.lines.map(((a,l)=>i().createElement(ut.Line,{key:l,animationDuration:e.y.animation||1500,yAxisId:a.axis||"left",type:a.type||"monotone",dataKey:a.name,stroke:a.color,dot:!!a.dot&&(l=>{var o,s;const r=l.payload[e.x.name],c=n.image&&!!(null===(o=a.dot)||void 0===o?void 0:o.labelKey),d=!(!c||!n.image[a.dot.labelKey])&&(n.image[a.dot.labelKey]||[]).indexOf(r.toString())>-1,u={key:l.key,r:l.r,cx:l.cx,cy:l.cy,strokeWidth:l.strokeWidth,style:{"--line-color":l.stroke},className:d?"active":c?"hoverable":void 0,onClick:(null===(s=a.dot)||void 0===s?void 0:s.labelKey)&&t?()=>t(a.dot.labelKey,r.toString()):void 0};return i().createElement(ut.Dot,Object.assign({},u))})}))))})))};function pt(e){(0,le.qOq)(e,"svelte-t937il","line.svelte-t937il.svelte-t937il,polyline.svelte-t937il.svelte-t937il{stroke-width:calc(1px / var(--media-viewer-scale, 1));stroke:black}.axis.x.svelte-t937il text.svelte-t937il{text-anchor:middle}.axis.y.left.svelte-t937il.svelte-t937il{text-anchor:end}.axis.y.right.svelte-t937il.svelte-t937il{text-anchor:start}")}function ht(e,t,n){const a=e.slice();return a[8]=t[n].a,a[9]=t[n].lines,a[11]=n,a}function vt(e,t,n){const a=e.slice();return a[12]=t[n],a}function bt(e,t,n){const a=e.slice();return a[15]=t[n],a}function ft(e,t,n){const a=e.slice();return a[18]=t[n],a}function yt(e,t,n){const a=e.slice();return a[18]=t[n],a}function xt(e){let t,n,a,i,l,o,s,r,c,d,u=parseFloat(e[18].val.toFixed(1)).toString()+"";return{c(){t=(0,le.bi5)("line"),o=(0,le.bi5)("text"),s=(0,le.fLW)(u),(0,le.Ljt)(t,"y1",n=e[8].extents.y.max-e[4].tickSize),(0,le.Ljt)(t,"y2",a=e[8].extents.y.max+e[4].tickSize),(0,le.Ljt)(t,"x1",i=e[18].pos),(0,le.Ljt)(t,"x2",l=e[18].pos),(0,le.Ljt)(t,"class","svelte-t937il"),(0,le.Ljt)(o,"x",r=e[18].pos),(0,le.Ljt)(o,"y",c=e[8].extents.y.max+e[4].tickSize+e[4].fontSize),(0,le.Ljt)(o,"font-size",d=e[4].fontSize),(0,le.Ljt)(o,"class","svelte-t937il")},m(e,n){(0,le.$Tr)(e,t,n),(0,le.$Tr)(e,o,n),(0,le.R3I)(o,s)},p(e,d){7&d&&n!==(n=e[8].extents.y.max-e[4].tickSize)&&(0,le.Ljt)(t,"y1",n),7&d&&a!==(a=e[8].extents.y.max+e[4].tickSize)&&(0,le.Ljt)(t,"y2",a),7&d&&i!==(i=e[18].pos)&&(0,le.Ljt)(t,"x1",i),7&d&&l!==(l=e[18].pos)&&(0,le.Ljt)(t,"x2",l),7&d&&u!==(u=parseFloat(e[18].val.toFixed(1)).toString()+"")&&(0,le.rTO)(s,u),7&d&&r!==(r=e[18].pos)&&(0,le.Ljt)(o,"x",r),7&d&&c!==(c=e[8].extents.y.max+e[4].tickSize+e[4].fontSize)&&(0,le.Ljt)(o,"y",c)},d(e){e&&(0,le.ogt)(t),e&&(0,le.ogt)(o)}}}function wt(e){let t,n,a,i,l,o,s,r=e[15].ticks,c=[];for(let t=0;t<r.length;t+=1)c[t]=jt(ft(e,r,t));return{c(){t=(0,le.bi5)("g"),n=(0,le.bi5)("line");for(let e=0;e<c.length;e+=1)c[e].c();(0,le.Ljt)(n,"x1",a=e[15].x),(0,le.Ljt)(n,"x2",i=e[15].x),(0,le.Ljt)(n,"y1",l=e[8].extents.y.min),(0,le.Ljt)(n,"y2",o=e[8].extents.y.max),(0,le.Ljt)(n,"class","svelte-t937il"),(0,le.Ljt)(t,"class",s="axis y "+e[15].name+" svelte-t937il")},m(e,a){(0,le.$Tr)(e,t,a),(0,le.R3I)(t,n);for(let e=0;e<c.length;e+=1)c[e].m(t,null)},p(e,d){if(7&d&&a!==(a=e[15].x)&&(0,le.Ljt)(n,"x1",a),7&d&&i!==(i=e[15].x)&&(0,le.Ljt)(n,"x2",i),7&d&&l!==(l=e[8].extents.y.min)&&(0,le.Ljt)(n,"y1",l),7&d&&o!==(o=e[8].extents.y.max)&&(0,le.Ljt)(n,"y2",o),23&d){let n;for(r=e[15].ticks,n=0;n<r.length;n+=1){const a=ft(e,r,n);c[n]?c[n].p(a,d):(c[n]=jt(a),c[n].c(),c[n].m(t,null))}for(;n<c.length;n+=1)c[n].d(1);c.length=r.length}7&d&&s!==(s="axis y "+e[15].name+" svelte-t937il")&&(0,le.Ljt)(t,"class",s)},d(e){e&&(0,le.ogt)(t),(0,le.RMB)(c,e)}}}function jt(e){let t,n,a,i,l,o,s,r,c,d,u=parseFloat(e[18].val.toFixed(1)).toString()+"";return{c(){t=(0,le.bi5)("line"),o=(0,le.bi5)("text"),s=(0,le.fLW)(u),(0,le.Ljt)(t,"x1",n=e[15].x-e[4].tickSize),(0,le.Ljt)(t,"x2",a=e[15].x+e[4].tickSize),(0,le.Ljt)(t,"y1",i=e[8].extents.y.max-e[18].pos),(0,le.Ljt)(t,"y2",l=e[8].extents.y.max-e[18].pos),(0,le.Ljt)(t,"class","svelte-t937il"),(0,le.Ljt)(o,"x",r=e[15].x+("left"==e[15].name?-1:1)*(1.25*e[4].tickSize)),(0,le.Ljt)(o,"y",c=e[8].extents.y.max-e[18].pos+e[4].fontSize/3),(0,le.Ljt)(o,"font-size",d=e[4].fontSize),(0,le.Ljt)(o,"class","svelte-t937il")},m(e,n){(0,le.$Tr)(e,t,n),(0,le.$Tr)(e,o,n),(0,le.R3I)(o,s)},p(e,d){7&d&&n!==(n=e[15].x-e[4].tickSize)&&(0,le.Ljt)(t,"x1",n),7&d&&a!==(a=e[15].x+e[4].tickSize)&&(0,le.Ljt)(t,"x2",a),7&d&&i!==(i=e[8].extents.y.max-e[18].pos)&&(0,le.Ljt)(t,"y1",i),7&d&&l!==(l=e[8].extents.y.max-e[18].pos)&&(0,le.Ljt)(t,"y2",l),7&d&&u!==(u=parseFloat(e[18].val.toFixed(1)).toString()+"")&&(0,le.rTO)(s,u),7&d&&r!==(r=e[15].x+("left"==e[15].name?-1:1)*(1.25*e[4].tickSize))&&(0,le.Ljt)(o,"x",r),7&d&&c!==(c=e[8].extents.y.max-e[18].pos+e[4].fontSize/3)&&(0,le.Ljt)(o,"y",c)},d(e){e&&(0,le.ogt)(t),e&&(0,le.ogt)(o)}}}function kt(e){let t,n=(0!=e[15].limits.max||0!=e[15].limits.min)&&wt(e);return{c(){n&&n.c(),t=(0,le.cSb)()},m(e,a){n&&n.m(e,a),(0,le.$Tr)(e,t,a)},p(e,a){0!=e[15].limits.max||0!=e[15].limits.min?n?n.p(e,a):(n=wt(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&(0,le.ogt)(t)}}}function Et(e){let t,n,a;return{c(){t=(0,le.bi5)("polyline"),(0,le.Ljt)(t,"points",n=e[12].points.map(Ct).join(" ")),(0,le.Ljt)(t,"stroke",a=e[12].color),(0,le.czc)(t,"stroke",e[12].color),(0,le.Ljt)(t,"class","svelte-t937il")},m(e,n){(0,le.$Tr)(e,t,n)},p(e,i){7&i&&n!==(n=e[12].points.map(Ct).join(" "))&&(0,le.Ljt)(t,"points",n),7&i&&a!==(a=e[12].color)&&(0,le.Ljt)(t,"stroke",a),7&i&&(0,le.czc)(t,"stroke",e[12].color)},d(e){e&&(0,le.ogt)(t)}}}function Ot(e){let t,n,a,i,l,o,s,r,c,d=e[8].x.ticks,u=[];for(let t=0;t<d.length;t+=1)u[t]=xt(yt(e,d,t));function m(...t){return e[6](e[8],...t)}let g=["left","right"].map(m),p=[];for(let t=0;t<g.length;t+=1)p[t]=kt(bt(e,g,t));let h=e[9],v=[];for(let t=0;t<h.length;t+=1)v[t]=Et(vt(e,h,t));return{c(){t=(0,le.bi5)("svg"),n=(0,le.bi5)("svg"),a=(0,le.bi5)("g"),i=(0,le.bi5)("line");for(let e=0;e<u.length;e+=1)u[e].c();for(let e=0;e<p.length;e+=1)p[e].c();c=(0,le.cSb)();for(let e=0;e<v.length;e+=1)v[e].c();(0,le.Ljt)(i,"x1",l=e[8].extents.x.min),(0,le.Ljt)(i,"x2",o=e[8].extents.x.max),(0,le.Ljt)(i,"y1",s=e[8].extents.y.max),(0,le.Ljt)(i,"y2",r=e[8].extents.y.max),(0,le.Ljt)(i,"class","svelte-t937il"),(0,le.Ljt)(a,"class","axis x svelte-t937il"),(0,le.Ljt)(n,"class","chart-area"),(0,le.Ljt)(t,"class","plot")},m(e,l){(0,le.$Tr)(e,t,l),(0,le.R3I)(t,n),(0,le.R3I)(n,a),(0,le.R3I)(a,i);for(let e=0;e<u.length;e+=1)u[e].m(a,null);for(let e=0;e<p.length;e+=1)p[e].m(n,null);(0,le.R3I)(n,c);for(let e=0;e<v.length;e+=1)v[e].m(n,null)},p(t,b){if(e=t,7&b&&l!==(l=e[8].extents.x.min)&&(0,le.Ljt)(i,"x1",l),7&b&&o!==(o=e[8].extents.x.max)&&(0,le.Ljt)(i,"x2",o),7&b&&s!==(s=e[8].extents.y.max)&&(0,le.Ljt)(i,"y1",s),7&b&&r!==(r=e[8].extents.y.max)&&(0,le.Ljt)(i,"y2",r),23&b){let t;for(d=e[8].x.ticks,t=0;t<d.length;t+=1){const n=yt(e,d,t);u[t]?u[t].p(n,b):(u[t]=xt(n),u[t].c(),u[t].m(a,null))}for(;t<u.length;t+=1)u[t].d(1);u.length=d.length}if(23&b){let t;for(g=["left","right"].map(m),t=0;t<g.length;t+=1){const a=bt(e,g,t);p[t]?p[t].p(a,b):(p[t]=kt(a),p[t].c(),p[t].m(n,c))}for(;t<p.length;t+=1)p[t].d(1);p.length=g.length}if(7&b){let t;for(h=e[9],t=0;t<h.length;t+=1){const a=vt(e,h,t);v[t]?v[t].p(a,b):(v[t]=Et(a),v[t].c(),v[t].m(n,null))}for(;t<v.length;t+=1)v[t].d(1);v.length=h.length}},d(e){e&&(0,le.ogt)(t),(0,le.RMB)(u,e),(0,le.RMB)(p,e),(0,le.RMB)(v,e)}}}function St(e){let t,n,a,i=e[0].plots.map(e[5]),l=[];for(let t=0;t<i.length;t+=1)l[t]=Ot(ht(e,i,t));return{c(){t=(0,le.bi5)("svg");for(let e=0;e<l.length;e+=1)l[e].c();(0,le.Ljt)(t,"width",n=e[3].width),(0,le.Ljt)(t,"height",a=e[3].height),(0,le.Ljt)(t,"class","chart")},m(e,n){(0,le.$Tr)(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,[o]){if(23&o){let n;for(i=e[0].plots.map(e[5]),n=0;n<i.length;n+=1){const a=ht(e,i,n);l[n]?l[n].p(a,o):(l[n]=Ot(a),l[n].c(),l[n].m(t,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=i.length}8&o&&n!==(n=e[3].width)&&(0,le.Ljt)(t,"width",n),8&o&&a!==(a=e[3].height)&&(0,le.Ljt)(t,"height",a)},i:le.ZTd,o:le.ZTd,d(e){e&&(0,le.ogt)(t),(0,le.RMB)(l,e)}}}const Ct=e=>`${e.x} ${e.y}`;function Lt(e,t,n){let a,i,l,{target:o}=t;const s={width:512,height:256,tickCount:10,tickSize:8,fontSize:18},r=(e,t)=>{const{dataMin:n,dataMax:a}=e.reduce(((e,t)=>t.values.reduce(((e,t)=>({dataMin:Math.min(e.dataMin||t,t),dataMax:Math.max(e.dataMax||t,t)})),e)),{dataMin:void 0,dataMax:void 0});return{min:t&&"dataMin"!==t[0]?t[0]:n||0,max:t&&"dataMax"!==t[1]?t[1]:a||0}};return e.$$set=e=>{"target"in e&&n(0,o=e.target)},e.$$.update=()=>{1&e.$$.dirty&&n(1,a=o.plots.map((e=>{var t,n,a,i;const l={x:{min:Math.min(...e.x.values),max:Math.max(...e.x.values)},y:{left:r(e.y.lines.filter((e=>"left"==e.axis)),null===(t=e.y.limits)||void 0===t?void 0:t.left),right:r(e.y.lines.filter((e=>"right"==e.axis)),null===(n=e.y.limits)||void 0===n?void 0:n.right)}},o={width:(null===(a=e.size)||void 0===a?void 0:a.width)||s.width,height:(null===(i=e.size)||void 0===i?void 0:i.height)||s.height},c={x:{min:75,max:o.width-75,span:o.width-150},y:{min:0,max:o.height-100,span:o.height-100}},d=(c.x.max-c.x.min)/s.tickCount,u=(c.y.max-c.y.min)/s.tickCount,m={left:(l.y.left.max-l.y.left.min)/s.tickCount,right:(l.y.right.max-l.y.right.min)/s.tickCount},g=(l.x.max-l.x.min)/s.tickCount,p={y:{left:Array.from(Array(s.tickCount).keys()).map((e=>({pos:e*u+c.y.min,val:e*m.left+l.y.left.min}))),right:Array.from(Array(s.tickCount).keys()).map((e=>({pos:e*u+c.y.min,val:e*m.right+l.y.right.min})))},x:Array.from(Array(s.tickCount).keys()).map((e=>({pos:e*d+c.x.min,val:e*g+l.x.min})))};return{size:o,extents:c,x:{limits:l.x,ticks:p.x},y:{limits:l.y,ticks:p.y}}}))),2&e.$$.dirty&&n(3,i=a.reduce(((e,t)=>({width:Math.max(t.size.width,e.width),height:t.size.height+e.height})),{width:0,height:0})),3&e.$$.dirty&&n(2,l=o.plots.map(((e,t)=>({p:e,a:a[t]}))).map((({p:e,a:t})=>e.y.lines.map((n=>{const a=t.x.limits,i=t.y.limits[n.axis||"left"],l=a.max-a.min,o=i.max-i.min;return{color:n.color,points:n.values.map(((n,s)=>{const r=n;return{x:(e.x.values[s]-a.min)/l*t.extents.x.span+t.extents.x.min,y:t.extents.y.max-(r-i.min)/o*t.extents.y.span}}))}})))))},[o,a,l,i,s,(e,t)=>({p:e,a:a[t],lines:l[t]}),(e,t)=>({limits:e.y.limits[t],x:"left"===t?e.extents.x.min:e.extents.x.max,ticks:e.y.ticks[t],name:t})]}class Mt extends le.f_C{constructor(e){super(),(0,le.S1n)(this,e,Lt,St,le.N8,{target:0},pt)}}const $t=Mt;var zt=n(83601),It=n.n(zt);_e($t);const Tt=(0,l.styled)(l.Box)`
  & .metadata table {
    border: 1px solid;
  }
  & .metadata {
    margin-top: 5px;
    box-shadow: none;
    border-radius: 0;
  }
`,Rt=({target:e,labels:t,config:n={image:[]},options:a,callbacks:o,metadata:r})=>{const c={container:i().useRef(null),downloadable:i().useRef(null)},{setToast:d}=i().useContext(s),{draft:u,setDraft:m,resetDraft:g,undo:p}=Z(t,[e],[e]),h=i().useCallback((()=>(null==o?void 0:o.onSave)?o.onSave(Object.assign({},E(u.labels))):void 0),[u,null==o?void 0:o.onSave]),v=i().useCallback(((e,t)=>{var a;return m(Object.assign(Object.assign({},u),{dirty:!0,labels:Object.assign(Object.assign({},u.labels),{image:Object.assign(Object.assign({},u.labels.image),{[e]:z(t,u.labels.image[e]||[],!!n.image&&(null===(a=n.image.filter((t=>t.name===e))[0])||void 0===a?void 0:a.multiple))})})}))}),[u.labels,n,m]),b=i().useMemo((()=>e?e.plots.reduce(((e,t)=>{var n,a;return{width:e.width+((null===(n=t.size)||void 0===n?void 0:n.width)||512),height:e.height+((null===(a=t.size)||void 0===a?void 0:a.height)||256)}}),{width:0,height:0}):void 0),[e]),f=i().useCallback((()=>{return t=void 0,n=void 0,i=function*(){yield It()(c.downloadable.current,{logging:!1}).then((t=>{if(!(null==e?void 0:e.filename))return;const n=t.toDataURL("image/png",1);n?dt().saveAs(n,e.filename.toLowerCase().endsWith(".png")?e.filename:e.filename+".png"):d("Failed to render figure.")}))},new((a=void 0)||(a=Promise))((function(e,l){function o(e){try{r(i.next(e))}catch(e){l(e)}}function s(e){try{r(i.throw(e))}catch(e){l(e)}}function r(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,s)}r((i=i.apply(t,n||[])).next())}));var t,n,a,i}),[e,t,c.downloadable,d]);return i().createElement(l.Box,null,i().createElement(He,{metadata:r,progress:null==a?void 0:a.progress,layout:"vertical",control:i().createElement(ae,{config:{image:n.image||[]},allowRegion:!1,disabled:!1,direction:"row",draft:u,showNavigation:null==a?void 0:a.showNavigation,setDraft:m,callbacks:Object.assign(Object.assign({},o),{onSave:(null==o?void 0:o.onSave)?h:void 0,onReset:g,onDownload:(null==e?void 0:e.filename)?f:void 0,onUndo:p})}),content:i().createElement(W,{media:{main:e?i().createElement(l.Box,{ref:c.container},i().createElement(gt,{target:e,labels:u.labels,toggle:v})):void 0,mini:e?i().createElement(gt,{target:e,labels:u.labels}):void 0},size:b,loadState:"loaded"})}),e&&b?i().createElement(l.Box,{style:{overflow:"scroll",height:0}},i().createElement(Tt,{ref:c.downloadable,style:{display:"inline-block",padding:20}},i().createElement(gt,{target:e,labels:u.labels}),r?i().createElement(Q,{data:r}):null)):void 0)},Bt={states:[],urls:[],type:"image",message:"",config:{image:[],regions:[]},labels:{image:{},polygons:[],masks:[],boxes:[]},action:"",preload:[],maxCanvasSize:512,maxViewHeight:512,idx:0,viewState:"labeling",indexState:{rows:[],columns:[],rowsPerPage:5,rowCount:0,sortModel:[],page:1},buttons:{next:!0,prev:!0,save:!0,config:!0,delete:!0,ignore:!0,unignore:!0},base:{serverRoot:"",url:""},progress:-1,mode:"light"},Nt=({extract:e})=>{var t,n;const{setToast:a}=i().useContext(s),o=e("config"),r=e("states"),c=e("urls"),d=e("type"),u=e("labels"),m=e("action"),g=e("progress"),p=e("mode"),h=e("buttons"),v=e("preload"),b=e("maxCanvasSize"),f=e("viewState"),y=e("indexState"),x=e("idx"),w=e("message");i().useEffect((()=>{""!==w.value&&(a(w.value),w.set(""))}),[w.value,a]);const j={config:{image:(null===(t=o.value)||void 0===t?void 0:t.image)||[],regions:(null===(n=o.value)||void 0===n?void 0:n.regions)||[]},preload:v.value,options:{progress:g.value,maxCanvasSize:b.value,showNavigation:!0},callbacks:{onSave:h.value.save?e=>{u.set(e),m.set("save")}:void 0,onSaveConfig:h.value.config?o.set:void 0,onNext:h.value.next?()=>m.set("next"):void 0,onPrev:h.value.prev?()=>m.set("prev"):void 0,onDelete:h.value.delete?()=>m.set("delete"):void 0,onIgnore:h.value.ignore?()=>m.set("ignore"):void 0,onUnignore:h.value.unignore?()=>m.set("unignore"):void 0,onShowIndex:()=>m.set("index")}};return i().createElement(l.ThemeProvider,{theme:(0,l.createTheme)({palette:{mode:p.value||"light"}})},i().createElement(l.ScopedCssBaseline,null,i().createElement(l.Box,{style:{padding:16}},i().createElement(l.Box,{hidden:"index"!==f.value},i().createElement(rt,{indexState:y.value,setIndexState:e=>{y.set(e),m.set("index")},visible:"index"===f.value,rowKey:"qslId",idx:x.value,label:e=>{x.set(e),m.set("label")}})),0===r.value.length||"index"===f.value?null:1==r.value.length?"image"===d.value?i().createElement(Xe,Object.assign({},j,{labels:u.value||{},target:"transitioning"===f.value?void 0:c.value[0],metadata:"transitioning"===f.value?{}:r.value[0].metadata})):"video"===d.value?i().createElement(et,Object.assign({},j,{labels:Array.isArray(u.value)?u.value:[],target:c.value[0],metadata:"transitioning"===f.value?{}:r.value[0].metadata})):"time-series"==d.value?i().createElement(Rt,Object.assign({},j,{labels:u.value||{},target:"transitioning"===f.value?void 0:c.value[0],metadata:"transitioning"===f.value?{}:r.value[0].metadata})):null:i().createElement(nt,Object.assign({},j,{labels:u.value||{},target:c.value,states:"transitioning"===f.value?[]:r.value,setStates:e=>r.set(e)})))))},At=e=>i().createElement(lt,{maxViewHeight:e.extract("maxViewHeight").value},i().createElement(Nt,Object.assign({},e)))},59087:(e,t,n)=>{"use strict";n.d(t,{p:()=>g,N:()=>p});var a=n(56271),i=n.n(a),l=n(14456),o=n.n(l),s=n(97697),r=n(82565);const c=(e,t,n,a)=>{i().useEffect((()=>{const a=t=>e&&n(e,t);return null==e||e.on(t,a),()=>{null==e||e.unbind(t,a)}}),(a||[]).concat([e]))};var d=n(81609),u=n(31255);const m=({model:e})=>{const t=(e=>t=>((e,t)=>{const[n,a]=i().useState(null==t?void 0:t.get(e));return c(t,`change:${e}`,(t=>{a(t.get(e))}),[e]),{value:n,set:function(n,a){null==t||t.set(e,n,a),null==t||t.save_changes()}}})(t,e))(e),n=t("base");return i().useEffect((()=>{n.set({serverRoot:s.PageConfig.getOption("serverRoot"),url:s.PageConfig.getBaseUrl()})})),i().createElement(d.f,{extract:t})};class g extends r.DOMWidgetModel{defaults(){return Object.assign(Object.assign(Object.assign({},super.defaults()),{_model_name:g.model_name,_model_module:g.model_module,_model_module_version:g.model_module_version,_view_name:g.view_name,_view_module:g.view_module,_view_module_version:g.view_module_version}),d.U)}}g.serializers=Object.assign({},r.DOMWidgetModel.serializers),g.model_name="MediaLabelerModel",g.model_module=u.o,g.model_module_version=u.Y,g.view_name="MediaLabelerView",g.view_module=u.o,g.view_module_version=u.Y;class p extends r.DOMWidgetView{render(){this.el.classList.add("qsl-image-labeler-widget");const e=i().createElement(m,{model:this.model});o().render(e,this.el)}}},31255:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i,o:()=>l});const a=n(4147),i=a.version,l=a.name},9736:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},62976:(e,t,n)=>{"use strict";var a=n(9736);t.Z=void 0;var i=a(n(36128)),l=n(67557),o=(0,i.default)((0,l.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");t.Z=o},36128:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.createSvgIcon}});var a=n(6393)},56377:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=n(32733).Z},22949:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=n(25788).Z},6393:(e,t,n)=>{"use strict";n.r(t),n.d(t,{capitalize:()=>i.Z,createChainedFunction:()=>l.Z,createSvgIcon:()=>o.Z,debounce:()=>s.Z,deprecatedPropType:()=>r,isMuiElement:()=>c.Z,ownerDocument:()=>d.Z,ownerWindow:()=>u.Z,requirePropFactory:()=>m,setRef:()=>g,unstable_ClassNameGenerator:()=>w,unstable_useEnhancedEffect:()=>p.Z,unstable_useId:()=>h.Z,unsupportedProp:()=>v,useControlled:()=>b.Z,useEventCallback:()=>f.Z,useForkRef:()=>y.Z,useIsFocusVisible:()=>x.Z});var a=n(33602),i=n(88623),l=n(56377),o=n(85233),s=n(22949);const r=function(e,t){return()=>null};var c=n(66824),d=n(72022),u=n(58132);n(61416);const m=function(e,t){return()=>null},g=n(72536).Z;var p=n(63830),h=n(80641);const v=function(e,t,n,a,i){return null};var b=n(50770),f=n(85923),y=n(89428),x=n(69790);const w={configure:e=>{console.warn(["MUI: `ClassNameGenerator` import from `@mui/material/utils` is outdated and might cause unexpected issues.","","You should use `import { unstable_ClassNameGenerator } from '@mui/material/className'` instead","","The detail of the issue: https://github.com/mui/material-ui/issues/30011#issuecomment-1024993401","","The updated documentation: https://mui.com/guides/classname-generator/"].join("\n")),a.Z.configure(e)}}},66824:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var a=n(56271);const i=function(e,t){return a.isValidElement(e)&&-1!==t.indexOf(e.type.muiName)}},72022:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=n(25156).Z},58132:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=n(69923).Z},50770:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=n(90904).Z},63830:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=n(36341).Z},85923:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=n(58426).Z},89428:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=n(61199).Z},80641:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=n(53068).Z},69790:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=n(49665).Z},32733:(e,t,n)=>{"use strict";function a(...e){return e.reduce(((e,t)=>null==t?e:function(...n){e.apply(this,n),t.apply(this,n)}),(()=>{}))}n.d(t,{Z:()=>a})},25788:(e,t,n)=>{"use strict";function a(e,t=166){let n;function a(...a){clearTimeout(n),n=setTimeout((()=>{e.apply(this,a)}),t)}return a.clear=()=>{clearTimeout(n)},a}n.d(t,{Z:()=>a})},25156:(e,t,n)=>{"use strict";function a(e){return e&&e.ownerDocument||document}n.d(t,{Z:()=>a})},69923:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var a=n(25156);function i(e){return(0,a.Z)(e).defaultView||window}},72536:(e,t,n)=>{"use strict";function a(e,t){"function"==typeof e?e(t):e&&(e.current=t)}n.d(t,{Z:()=>a})},90904:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var a=n(56271);function i({controlled:e,default:t,name:n,state:i="value"}){const{current:l}=a.useRef(void 0!==e),[o,s]=a.useState(t);return[l?e:o,a.useCallback((e=>{l||s(e)}),[])]}},36341:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var a=n(56271);const i="undefined"!=typeof window?a.useLayoutEffect:a.useEffect},58426:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var a=n(56271),i=n(36341);function l(e){const t=a.useRef(e);return(0,i.Z)((()=>{t.current=e})),a.useCallback(((...e)=>(0,t.current)(...e)),[])}},61199:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var a=n(56271),i=n(72536);function l(e,t){return a.useMemo((()=>null==e&&null==t?null:n=>{(0,i.Z)(e,n),(0,i.Z)(t,n)}),[e,t])}},53068:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var a=n(56271);let i=0;const l=a.useId;function o(e){if(void 0!==l){const t=l();return null!=e?e:t}return function(e){const[t,n]=a.useState(e),l=e||t;return a.useEffect((()=>{null==t&&(i+=1,n(`mui-${i}`))}),[t]),l}(e)}},49665:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var a=n(56271);let i,l=!0,o=!1;const s={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function r(e){e.metaKey||e.altKey||e.ctrlKey||(l=!0)}function c(){l=!1}function d(){"hidden"===this.visibilityState&&o&&(l=!0)}function u(){const e=a.useCallback((e=>{var t;null!=e&&((t=e.ownerDocument).addEventListener("keydown",r,!0),t.addEventListener("mousedown",c,!0),t.addEventListener("pointerdown",c,!0),t.addEventListener("touchstart",c,!0),t.addEventListener("visibilitychange",d,!0))}),[]),t=a.useRef(!1);return{isFocusVisibleRef:t,onFocus:function(e){return!!function(e){const{target:t}=e;try{return t.matches(":focus-visible")}catch(e){}return l||function(e){const{type:t,tagName:n}=e;return!("INPUT"!==n||!s[t]||e.readOnly)||"TEXTAREA"===n&&!e.readOnly||!!e.isContentEditable}(t)}(e)&&(t.current=!0,!0)},onBlur:function(){return!!t.current&&(o=!0,window.clearTimeout(i),i=window.setTimeout((()=>{o=!1}),100),t.current=!1,!0)},ref:e}}},4147:e=>{"use strict";e.exports=JSON.parse('{"name":"qslwidgets","version":"0.0.42","description":"Widgets for the QSL image labeling package.","keywords":["jupyter","jupyterlab","jupyterlab-extension","widgets"],"files":["lib/**/*.js","dist/*.js","css/*.css"],"homepage":"https://github.com/faustomorales/qsl","bugs":{"url":"https://github.com/faustomorales/qsl/issues"},"license":"MIT","author":{"name":"Fausto Morales","email":"fausto@robinbay.com"},"main":"lib/index.js","types":"./lib/index.d.ts","repository":{"type":"git","url":"https://github.com/faustomorales/qsl"},"scripts":{"build":"tsc && yarn copy && webpack --env production","watch":"npm-run-all -p watch:*","copy":"copyfiles --up 1 src/**/*.{css,svelte} lib","watch:copy":"nodemon -e css,svelte --watch src --exec \'yarn copy\'","watch:tscw":"tsc -w","watch:pack":"webpack --watch","clean":"rimraf ../qsl/ui/eelapp ../qsl/ui/nbextension/index.js* ../qsl/ui/labextension dist lib","format":"prettier --write src","test":"jest","storybook":"start-storybook -p 6006"},"dependencies":{"@emotion/react":"^11.8.1","@emotion/styled":"^11.8.1","@jupyter-widgets/base":"^1.1.10 || ^2.0.0 || ^3.0.0 || ^4.0.0","@mui/icons-material":"^5.6.1","@mui/material":"^5.6.1","@mui/x-data-grid":"^5.11.0","@use-gesture/react":"^10.2.15","file-saver":"^2.0.5","html2canvas":"^1.4.1","lodash.clonedeep":"^4.5.0","react":"^17.0.2","react-dom":"^17.0.2","react-highlight":"^0.14.0","recharts":"^2.1.10","svelte":"^3.48.0"},"devDependencies":{"@babel/core":"^7.14.5","@babel/preset-env":"^7.14.5","@babel/preset-react":"^7.14.5","@babel/preset-typescript":"^7.14.5","@jupyterlab/builder":"^3.0.0","@phosphor/application":"^1.6.0","@phosphor/widgets":"^1.6.0","@storybook/addon-actions":"^6.5.9","@storybook/addon-essentials":"^6.5.9","@storybook/addon-interactions":"^6.5.9","@storybook/addon-links":"^6.5.9","@storybook/builder-webpack5":"^6.5.9","@storybook/manager-webpack5":"^6.5.9","@storybook/react":"^6.5.9","@storybook/testing-library":"^0.0.13","@types/file-saver":"^2.0.5","@types/jest":"^26.0.0","@types/lodash.clonedeep":"^4.5.7","@types/lodash.debounce":"^4.0.7","@types/react":"^17.0.11","@types/react-dom":"^17.0.8","@types/react-highlight":"^0.12.5","@types/webpack-env":"^1.13.6","@typescript-eslint/eslint-plugin":"^3.6.0","@typescript-eslint/parser":"^3.6.0","acorn":"^7.2.0","babel-loader":"^8.2.2","copyfiles":"^2.4.1","css-loader":"^6.7.1","eslint":"^7.4.0","eslint-config-prettier":"^6.11.0","eslint-plugin-prettier":"^3.1.4","fs-extra":"^7.0.0","html-webpack-plugin":"^5.5.0","identity-obj-proxy":"^3.0.0","jest":"^26.0.0","mkdirp":"^0.5.1","nodemon":"^2.0.16","npm-run-all":"^4.1.3","prettier":"^2.0.5","rimraf":"^2.6.2","source-map-loader":"^1.1.3","svelte-loader":"^3.1.3","svelte-preprocess":"^4.10.7","ts-jest":"^26.0.0","ts-loader":"^8.0.0","typescript":"~4.1.3","webpack":"^5.0.0","webpack-cli":"^4.0.0"},"babel":{"presets":["@babel/preset-env","@babel/preset-react","@babel/preset-typescript"]},"jupyterlab":{"extension":"lib/plugin","outputDir":"../qsl/ui/labextension/","sharedPackages":{"@jupyter-widgets/base":{"bundled":false,"singleton":true}}}}')}}]);