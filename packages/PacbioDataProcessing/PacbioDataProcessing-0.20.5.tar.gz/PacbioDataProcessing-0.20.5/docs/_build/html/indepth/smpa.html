
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Single Molecule Analysis &#8212; PacBio Data Processing 0.20.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Description of data in the Methylation Reports" href="methylation_reports.html" />
    <link rel="prev" title="What is the PacBio sequencing technology?" href="sm-analysisdoc.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="single-molecule-analysis">
<span id="id1"></span><h1>Single Molecule Analysis<a class="headerlink" href="#single-molecule-analysis" title="Permalink to this headline">¶</a></h1>
<div class="admonition-wip admonition">
<p class="admonition-title">WIP</p>
<p>This section is Work In Progress. It is a central piece of
documentation that must help the interested reader understand
the fundamentals of this project.</p>
</div>
<p><strong>SMPA</strong> (Single Molecule Position Analysis) is a tool that allows to
analyse PacBio sequencing data and generate tables with different
formats that allow us to explore the properties on each pacbio molecule
and on each methylated position. <strong>SMPA</strong> uses others important tools
like <strong>blasr</strong> to align our sequence with the reference sequence,
<strong>pbccs</strong> to generate circular consensus sequences, <strong>ipdSummary</strong> to
predict methylations on positions through an <em>in-silico</em> model (this
allows the user to use this tool without a control sample), and other
tools dedicated for instance to read and write files compatible with the
different pacbio tools. All of those tools are executed in a ordered
steps to produce different data frames.</p>
<blockquote>
<div><p>You can find more information about the pacbio tools <a class="reference internal" href="pacbio_tools.html#pacbio-tools"><span class="std std-ref">PacBio tools</span></a></p>
<p>If you are interested in the <em>in-silico</em> model, click
<a class="reference external" href="https://github.com/PacificBiosciences/kineticsTools/blob/master/doc/manual.rst">here</a></p>
</div></blockquote>
<section id="how-it-works">
<h2>How it works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h2>
<p>The following figure is a flow chart of the <code class="docutils literal notranslate"><span class="pre">sm-analysis</span></code> pipeline.</p>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="../_images/flow_chart_sm_analysis.png"><img alt="sm-analysis" src="../_images/flow_chart_sm_analysis.png" style="width: 1446.5px; height: 1431.5px;" /></a>
<figcaption>
<p><span class="caption-text">Flow chart of the <code class="docutils literal notranslate"><span class="pre">sm-analysis</span></code> program.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="output">
<h2>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>Different tables are produced:</p>
<section id="the-ipdsummary-table">
<h3>The <code class="docutils literal notranslate"><span class="pre">ipdSummary</span></code> table<a class="headerlink" href="#the-ipdsummary-table" title="Permalink to this headline">¶</a></h3>
<p>It has 9 columns with the following description:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 38%" />
<col style="width: 31%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Column number</strong></p></th>
<th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>molecule ID</p></td>
<td><p>ID number for the
analysed molecule</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>modification</p></td>
<td><p>This is related to
the type of
modification chosen
to be detected</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>position</p></td>
<td><p>Base position where
the methylation was
detected</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>score</p></td>
<td><p>Phred-transformed
pvalue that a
kinetic deviation
exists at this
position</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>strand</p></td>
<td><p>DNA strand (forward
or reverse)</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>coverage</p></td>
<td><p>Valid IPDs at this
position and
probably related to
the numbers of
subreads used for
the detection</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>sequence</p></td>
<td><p>Sequence context of
the detection, this
have 41 bases
length and the
modified base in
the center</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>IPDratio</p></td>
<td><p>This in the IPD
ratio of the
methylated base
calculated using
the <em>in-silico</em>
model</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>idQV</p></td>
<td><p>This is related
with the quality
value of the
identification</p></td>
</tr>
</tbody>
</table>
<p>For a more detailed description click
<a class="reference external" href="https://github.com/PacificBiosciences/kineticsTools/blob/master/doc/manual.rst">here</a></p>
</section>
<section id="the-molecule-table">
<h3>The molecule table<a class="headerlink" href="#the-molecule-table" title="Permalink to this headline">¶</a></h3>
<p>It has 8 columns with the following description:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 38%" />
<col style="width: 31%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Column number</strong></p></th>
<th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p><strong>molecule_ID</strong></p></td>
<td><p>ID number for the
analysed molecule</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p><strong>pos_u</strong></p></td>
<td><p>List of sorted
methylated
positions in the
molecule</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p><strong>metypes_u</strong></p></td>
<td><p>Methylated types
related to the
positions in
<em>pos_u</em> column</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p><strong>hemi_fwd</strong></p></td>
<td><p>Number of
detections only in
the forward strand
(hemi-methylation
+)</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p><strong>hemi_rv</strong></p></td>
<td><p>Number of
detections only in
the reverse strand
(hemi-methylation
-)</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p><strong>full</strong></p></td>
<td><p>Number of full
methylation
detections
(full-methylation)</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p><strong>gatc_cov</strong></p></td>
<td><p>Number of GATC
positions in the
molecule</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p><strong>pos_diff</strong></p></td>
<td><p>Difference in bases
between every
position in the
<em>pos_u</em> column</p></td>
</tr>
</tbody>
</table>
</section>
<section id="the-position-table">
<h3>The position table<a class="headerlink" href="#the-position-table" title="Permalink to this headline">¶</a></h3>
<p>It has 6 columns with the following description:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 38%" />
<col style="width: 31%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Column number</strong></p></th>
<th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p><strong>positions</strong></p></td>
<td><p>Methylation
position</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p><strong>met_types</strong></p></td>
<td><p>List of methylation
types detected for
the position in
different molecules</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p><strong>mol_cov</strong></p></td>
<td><p>Number of molecules
on which the
position appear</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p><strong>hemi_fwd</strong></p></td>
<td><p>Number of
detections only in
the forward strand
(hemi-methylation
+)</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p><strong>hemi_rv</strong></p></td>
<td><p>Number of
detections only in
the reverse strand
(hemi-methylation
-)</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p><strong>full</strong></p></td>
<td><p>Number of full
methylation
detections
(full-methylation)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="the-methylation-report-table">
<h3>The Methylation report table<a class="headerlink" href="#the-methylation-report-table" title="Permalink to this headline">¶</a></h3>
<p>The methylation report table integrate the information from ipdSummary
together with CCS (Circular Consensus Sequence) and the reference. Each
line on this table contains information about each molecule. The
description of this format can be found in
<a class="reference internal" href="methylation_reports.html#methylation-report-format"><span class="std std-ref">Description of data in the Methylation Reports</span></a>.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">PacBio Data Processing</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart for the impatient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart_9steps.html">Quickstart on a cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/index.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devel/index.html">Developer’s documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">pacbio_data_processing</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Guides</a><ul>
      <li>Previous: <a href="sm-analysisdoc.html" title="previous chapter">What is the PacBio sequencing technology?</a></li>
      <li>Next: <a href="methylation_reports.html" title="next chapter">Description of data in the Methylation Reports</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021-2022, David Palao and David Velázquez.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/indepth/smpa.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>