[tool.poetry]
name = "dilivia-data-client"
version = "0.1.5"
description = ""
authors = ["dilivia.enovea <contact@dilivia.net>"]
maintainers = ["martin.nivon <martin.nivon@enovea.net>"]
homepage = "https://www.dilivia.net/"
documentation = "https://www.dilivia.net/posts/" # mettre article "utilisation librairie" quand il sera vraiment déployé

[tool.poetry.dependencies]
python = ">=3.8,<4.0"
pydruid = "^0.6.2"
requests = "^2.27.1"
numpy = "^1.22.1"
pytz = "^2021.3"
python-dateutil = "^2.8.2"
pandas = "1.4.0"
pylint = "^2.12.2"

[tool.taskipy.tasks]
configure-repo="poetry config repositories.gitlab 'https://gitlab.enovea.lan/api/v4/projects/48644646/packages/pypi'"
lib-build="poetry build"
pusblish-repo="poetry publish --repository gitlab"
publish-lib="task lib-build && task pusblish-repo && echo 'Do not forget to create a git tag and push it to remote repository'"
coverage="poetry run coverage run -m pytest && poetry run coverage report -m"

[tool.poetry.dev-dependencies]
pytest = "^6.2.5"
coverage = "^6.3"
taskipy = "^1.9.0"
isort = "^5.10.1"
pre-commit = "^2.17.0"

[tool.pytest.ini_options]
testpaths = ["tests"]

[tool.poetry-dynamic-versioning]
enable = false
vcs = "git"
pattern  = "^(?P<base>\\d+\\.\\d+\\.\\d+)(-?((?P<stage>[a-zA-Z]+)\\.?(?P<revision>\\d+)?))?"
format-jinja = """
    {%- if distance == 0 -%}
        {{- base -}}
    {%- else -%}
        {{- base }}.dev{{ distance }}+d{{ datetime.now().strftime('%Y%m%d%H%M%S') -}}
    {%- endif -%}
"""
format-jinja-imports = [{ module = "datetime", item = "datetime" }]

[build-system]
requires = ["poetry>=0.12", "poetry-dynamic-versioning"]
build-backend = "poetry.masonry.api"
