#!/usr/bin/env python

import argparse
import logging

from domacc.accountingManager import AccountingManager

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="DomAcc")
    parser.add_argument(
        "-v", "--verbose", help="Show info of the process", action="count", default=0
    )
    parser.add_argument("-i", "--initialdate", help="Select accounting from YYYY-MM-DD")
    parser.add_argument("-f", "--finaldate", help="Select accounting until YYYY-MM-DD")
    parser.add_argument("configFile", help="Load accounting from json")

    args = parser.parse_args()

    if args.verbose == 0:
        logging.getLogger().setLevel(logging.WARNING)
    elif args.verbose == 1:
        logging.getLogger().setLevel(logging.INFO)
    else:
        logging.getLogger().setLevel(logging.DEBUG)

    acc = AccountingManager.LoadFromJsonFile(args.configFile)
    accounting = acc.getAccounting(args.initialdate, args.finaldate)
    logging.info("Account loaded\n{0}".format(accounting))
