(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_project_sampling_index_tsx"],{"./app/components/actions/menuItemActionLink.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=n("./app/components/actions/actionLink.tsx"),a=n("./app/components/menuItem.tsx"),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function r(e){let{className:t,...n}=e;return(0,o.tZ)(a.Z,{noAnchor:!0,withBorder:!0,disabled:n.disabled,className:t,children:(0,o.tZ)(l,{...n})})}r.displayName="MenuItemActionLink";const l=(0,s.Z)(i.Z,{target:"e18s0uh10"})("color:",(e=>e.theme.textColor),";",(e=>e.theme.overflowEllipsis)," &:hover{color:",(e=>e.theme.textColor),";}.dropdown-menu>li>&,.dropdown-menu>span>li>&{&.disabled:hover{background:",(e=>e.theme.background),";}}"),d=r},"./app/components/links/listLink.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),o=n("../node_modules/react-router/es/index.js"),r=n("../node_modules/classnames/index.js"),l=n.n(r),d=n("../node_modules/lodash/omit.js"),c=n.n(d),u=n("../node_modules/query-string/index.js"),p=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class g extends a.Component{constructor(){super(...arguments),(0,s.Z)(this,"getClassName",(()=>{const e={},{className:t,activeClassName:n}=this.props;return t&&(e[t]=!0),this.isActive()&&n&&(e[n]=!0),l()(e)}))}isActive(){const{isActive:e,to:t,query:n,index:s,router:i}=this.props,a=n?u.parse(n):void 0,o="string"==typeof t?{pathname:t,query:a}:t;return"function"==typeof e?e(o,s):i.isActive(o,s)}render(){const{index:e,children:t,to:n,disabled:s,...i}=this.props,a=c()(i,"activeClassName","css","isActive","index","router","location");return(0,p.tZ)(h,{className:this.getClassName(),disabled:s,children:(0,p.tZ)(o.Link,{...a,onlyActiveOnIndex:e,to:s?"":n,children:t})})}}g.displayName="ListLink",(0,s.Z)(g,"displayName","ListLink"),(0,s.Z)(g,"defaultProps",{activeClassName:"active",index:!1,disabled:!1});const m=(0,o.withRouter)(g),h=(0,i.Z)("li",{shouldForwardProp:e=>"disabled"!==e,target:"er8tqc10"})((e=>e.disabled&&`\n   a {\n    color:${e.theme.disabled} !important;\n    pointer-events: none;\n    :hover {\n      color: ${e.theme.disabled}  !important;\n    }\n   }\n`),";")},"./app/utils/recreateRoute.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n("../node_modules/lodash/findLastIndex.js"),i=n.n(s),a=n("./app/utils/replaceRouterParams.tsx");function o(e,t){var n,s;const{routes:o,params:r,location:l,stepBack:d}=t,c=o.map((e=>{let{path:t}=e;return t||""}));let u,p;"string"!=typeof e?(p=o.indexOf(e)+1,u=i()(c.slice(0,p),(e=>"/"===e[0]))):u=i()(c,(e=>"/"===e[0]));let g=c.slice(u,p);void 0!==d&&(g=g.slice(0,d));const m=null!==(n=null==l?void 0:l.search)&&void 0!==n?n:"",h=null!==(s=null==l?void 0:l.hash)&&void 0!==s?s:"",E=`${g.join("")}${"string"!=typeof e?"":e}${m}${h}`;return(0,a.Z)(E,r)}},"./app/utils/useLocation.tsx":(e,t,n)=>{"use strict";n.d(t,{T:()=>i});var s=n("./app/utils/useRouteContext.tsx");function i(){return(0,s.s)().location}},"./app/utils/useParams.tsx":(e,t,n)=>{"use strict";n.d(t,{U:()=>i});var s=n("./app/utils/useRouteContext.tsx");function i(){return(0,s.s)().params}},"./app/views/asyncView.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n("./app/components/asyncComponent.tsx"),i=n("./app/components/sentryDocumentTitle.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class o extends s.Z{getTitle(){return""}render(){return(0,a.tZ)(i.Z,{title:this.getTitle(),children:this.renderComponent()})}}o.displayName="AsyncView"},"./app/views/settings/organization/permissionAlert.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var s=n("./app/components/acl/access.tsx"),i=n("./app/components/alert.tsx"),a=n("./app/locale.tsx"),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const r=e=>{let{access:t=["org:write"],...n}=e;return(0,o.tZ)(s.Z,{access:t,children:e=>{let{hasAccess:t}=e;return!t&&(0,o.tZ)(i.Z,{type:"warning",showIcon:!0,...n,children:(0,a.t)("These settings can only be edited by users with the organization owner or manager role.")})}})};r.displayName="PermissionAlert";const l=r},"./app/views/settings/project/sampling/index.tsx":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Qt});var s=n("./app/components/acl/access.tsx"),i=n("./app/components/acl/feature.tsx"),a=n("./app/components/acl/featureDisabled.tsx"),o=n("./app/components/panels/index.tsx"),r=n("./app/locale.tsx"),l=n("./app/utils/useOrganization.tsx"),d=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),u=n("../node_modules/lodash/partition.js"),p=n.n(u),g=n("./app/actionCreators/indicator.tsx"),m=n("./app/actionCreators/modal.tsx"),h=n("./app/components/badge.tsx"),E=n("./app/components/links/externalLink.tsx"),_=n("./app/components/links/link.tsx"),T=n("./app/components/links/listLink.tsx"),y=n("./app/components/navTabs.tsx"),I=n("./app/types/sampling.tsx"),R=n("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),N=n("./app/utils/recreateRoute.tsx"),b=n("./app/views/asyncView.tsx"),Z=n("./app/views/settings/components/settingsPageHeader.tsx"),f=n("./app/views/settings/organization/permissionAlert.tsx"),x=n("./app/views/settings/components/text/textBlock.tsx"),S=(n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js")),A=n("./app/utils/theme.tsx");n("../node_modules/core-js/modules/es.string.replace.js");const v="https://docs.sentry.io/product/data-management-settings/filtering/",C={[I.BT.IE_PRE_9]:{icon:"internet-explorer",title:(0,r.t)("Internet Explorer version 8 and lower")},[I.BT.IE9]:{icon:"internet-explorer",title:(0,r.t)("Internet Explorer version 9")},[I.BT.IE10]:{icon:"internet-explorer",title:(0,r.t)("Internet Explorer version 10")},[I.BT.IE11]:{icon:"internet-explorer",title:(0,r.t)("Internet Explorer version 11")},[I.BT.SAFARI_PRE_6]:{icon:"safari",title:(0,r.t)("Safari version 5 and lower")},[I.BT.OPERA_PRE_15]:{icon:"opera",title:(0,r.t)("Opera version 14 and lower")},[I.BT.OPERA_MINI_PRE_8]:{icon:"opera",title:(0,r.t)("Opera Mini version 8 and lower")},[I.BT.ANDROID_PRE_4]:{icon:"android",title:(0,r.t)("Android version 3 and lower")}};function w(e){switch(e){case I.gI.TRACE_ENVIRONMENT:case I.gI.EVENT_ENVIRONMENT:return(0,r.t)("Environment");case I.gI.TRACE_RELEASE:case I.gI.EVENT_RELEASE:return(0,r.t)("Release");case I.gI.EVENT_USER_ID:case I.gI.TRACE_USER_ID:return(0,r.t)("User Id");case I.gI.EVENT_USER_SEGMENT:case I.gI.TRACE_USER_SEGMENT:return(0,r.t)("User Segment");case I.gI.EVENT_BROWSER_EXTENSIONS:return(0,r.t)("Browser Extensions");case I.gI.EVENT_LOCALHOST:return(0,r.t)("Localhost");case I.gI.EVENT_WEB_CRAWLERS:return(0,r.t)("Web Crawlers");case I.gI.EVENT_LEGACY_BROWSER:return(0,r.t)("Legacy Browser");case I.gI.EVENT_TRANSACTION:case I.gI.TRACE_TRANSACTION:return(0,r.t)("Transaction");case I.gI.EVENT_ERROR_MESSAGES:return(0,r.t)("Error Message");case I.gI.EVENT_CSP:return(0,r.t)("Content Security Policy");case I.gI.EVENT_IP_ADDRESSES:return(0,r.t)("IP Address");case I.gI.EVENT_OS_NAME:return(0,r.t)("OS Name");case I.gI.EVENT_OS_VERSION:return(0,r.t)("OS Version");case I.gI.EVENT_DEVICE_FAMILY:return(0,r.t)("Device Family");case I.gI.EVENT_DEVICE_NAME:return(0,r.t)("Device Name");case I.gI.EVENT_CUSTOM_TAG:return(0,r.t)("Add Custom Tag");default:return`${j(e)} - ${(0,r.t)("Custom")}`}}const O="event.tags.";function V(e){return e===I.gI.EVENT_CUSTOM_TAG||e.startsWith(O)}function j(e){return e.startsWith(O)?e.replace(O,""):e}var k=n("./app/components/truncate.tsx"),M=n("./app/utils/useMedia.tsx"),D=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function B(e){let{value:t}=e;const n=(0,M.Z)(`(max-width: ${A.ZP.breakpoints.small})`);return(0,D.tZ)(k.Z,{value:t,maxLength:n?30:40,expandable:!1})}B.displayName="TruncatedLabel";const L=(0,S.iv)("[role='document']{overflow:initial;}@media (min-width: ",A.ZP.breakpoints.small,"){width:100%;max-width:700px;}","");let U;function P(e){switch(e){case I.gI.EVENT_LEGACY_BROWSER:return(0,r.t)("Match all selected legacy browsers below");case I.gI.EVENT_BROWSER_EXTENSIONS:return(0,r.t)("Match all browser extensions");case I.gI.EVENT_LOCALHOST:return(0,r.t)("Match all localhosts");case I.gI.EVENT_WEB_CRAWLERS:return(0,r.t)("Match all web crawlers");case I.gI.EVENT_USER_ID:case I.gI.TRACE_USER_ID:return(0,r.t)("ex. 4711 (Multiline)");case I.gI.EVENT_USER_SEGMENT:case I.gI.TRACE_USER_SEGMENT:return(0,r.t)("ex. paid, common (Multiline)");case I.gI.TRACE_ENVIRONMENT:case I.gI.EVENT_ENVIRONMENT:return(0,r.t)("ex. prod, dev");case I.gI.TRACE_RELEASE:case I.gI.EVENT_RELEASE:return(0,r.t)("ex. 1*, [I3].[0-9].*");case I.gI.EVENT_IP_ADDRESSES:return(0,r.t)("ex. 127.0.0.1 or 10.0.0.0/8 (Multiline)");case I.gI.EVENT_CSP:return(0,r.t)("ex. file://*, example.com (Multiline)");case I.gI.EVENT_ERROR_MESSAGES:return(0,r.t)("ex. TypeError* (Multiline)");case I.gI.TRACE_TRANSACTION:case I.gI.EVENT_TRANSACTION:return(0,r.t)("ex. page-load");case I.gI.EVENT_OS_NAME:return(0,r.t)("ex. Mac OS X, Windows");case I.gI.EVENT_OS_VERSION:return(0,r.t)("ex. 11, 9* (Multiline)");case I.gI.EVENT_DEVICE_FAMILY:case I.gI.EVENT_DEVICE_NAME:return(0,r.t)("ex. Mac, Pixel*");default:return(0,r.t)("tag values")}}function z(e){var t,n;if(e.category===I.gI.EVENT_BROWSER_EXTENSIONS||e.category===I.gI.EVENT_WEB_CRAWLERS||e.category===I.gI.EVENT_LOCALHOST)return{op:I.er.EQUAL,name:e.category,value:!0};if(e.category===I.gI.EVENT_LEGACY_BROWSER)return{op:I.er.CUSTOM,name:e.category,value:null!==(n=e.legacyBrowsers)&&void 0!==n?n:[]};const s=(null!==(t=e.match)&&void 0!==t?t:"").split("\n").filter((e=>!!e.trim())).map((e=>e.trim()));return e.category===I.gI.EVENT_IP_ADDRESSES||e.category===I.gI.EVENT_ERROR_MESSAGES||e.category===I.gI.EVENT_CSP?{op:I.er.CUSTOM,name:e.category,value:s}:e.category===I.gI.EVENT_RELEASE||e.category===I.gI.TRACE_RELEASE||e.category===I.gI.EVENT_TRANSACTION||e.category===I.gI.TRACE_TRANSACTION||e.category===I.gI.EVENT_OS_NAME||e.category===I.gI.EVENT_OS_VERSION||e.category===I.gI.EVENT_DEVICE_FAMILY||e.category===I.gI.EVENT_DEVICE_NAME||V(e.category)?{op:I.er.GLOB_MATCH,name:e.category,value:s}:e.category===I.gI.TRACE_USER_ID||e.category===I.gI.EVENT_USER_ID?{op:I.er.EQUAL,name:e.category,value:s,options:{ignoreCase:!1}}:{op:I.er.EQUAL,name:e.category,value:s,options:{ignoreCase:!0}}}!function(e){e.ALL="all",e.MATCH_CONDITIONS="match-conditions"}(U||(U={}));const X=(0,r.t)("An internal error occurred while saving sampling rule");function F(e){switch(e.category){case I.gI.TRACE_RELEASE:case I.gI.EVENT_RELEASE:return"release";case I.gI.TRACE_ENVIRONMENT:case I.gI.EVENT_ENVIRONMENT:return"environment";case I.gI.TRACE_TRANSACTION:case I.gI.EVENT_TRANSACTION:return"transaction";case I.gI.EVENT_OS_NAME:return"os.name";case I.gI.EVENT_OS_VERSION:return"os.version";case I.gI.EVENT_DEVICE_FAMILY:return"device.family";case I.gI.EVENT_DEVICE_NAME:return"device.name";case I.gI.EVENT_CUSTOM_TAG:return"";default:return j(e.category)}}const $=[I.gI.TRACE_RELEASE,I.gI.TRACE_ENVIRONMENT,I.gI.TRACE_USER_ID,I.gI.TRACE_USER_SEGMENT,I.gI.TRACE_TRANSACTION],G=[I.gI.EVENT_RELEASE,I.gI.EVENT_ENVIRONMENT,I.gI.EVENT_USER_ID,I.gI.EVENT_USER_SEGMENT,I.gI.EVENT_BROWSER_EXTENSIONS,I.gI.EVENT_LOCALHOST,I.gI.EVENT_LEGACY_BROWSER,I.gI.EVENT_WEB_CRAWLERS,I.gI.EVENT_IP_ADDRESSES,I.gI.EVENT_CSP,I.gI.EVENT_ERROR_MESSAGES,I.gI.EVENT_TRANSACTION,I.gI.EVENT_OS_NAME,I.gI.EVENT_OS_VERSION,I.gI.EVENT_DEVICE_FAMILY,I.gI.EVENT_DEVICE_NAME,I.gI.EVENT_CUSTOM_TAG];function W(e){return(0,r._N)('Add "[newLabel]"',{newLabel:(0,D.tZ)(B,{value:e})})}var q=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),Y=n("../node_modules/react-select/dist/Select-9fdb8cd0.browser.esm.js"),H=n("../node_modules/react-select/dist/index-4322c0ed.browser.esm.js"),K=n("../node_modules/lodash/isEqual.js"),Q=n.n(K),J=n("./app/components/button.tsx"),ee=n("./app/components/buttonBar.tsx"),te=n("./app/components/forms/compactSelect.tsx"),ne=n("./app/components/forms/numberField.tsx"),se=n("./app/components/forms/selectOption.tsx"),ie=n("./app/icons/index.tsx"),ae=n("./app/icons/iconSearch.tsx"),oe=n("./app/styles/space.tsx"),re=n("./app/utils.tsx"),le=n("./app/utils/useApi.tsx"),de=n("./app/utils/useLocation.tsx"),ce=n("./app/utils/useParams.tsx"),ue=n("./app/utils/useRouteContext.tsx"),pe=n("./app/views/settings/components/emptyMessage.tsx"),ge=n("./app/components/forms/field/fieldRequiredBadge.tsx"),me=n("./app/components/forms/textareaField.tsx"),he=n("./app/icons/iconDelete.tsx"),Ee=n("../node_modules/lodash/intersection.js"),_e=n.n(Ee),Te=n("../node_modules/lodash/uniq.js"),ye=n.n(Te),Ie=n("../node_modules/lodash/xor.js"),Re=n.n(Ie);function Ne(e){let{selectedRowsCount:t,columnsCount:n,isPageSelected:s,isAllSelected:i,onSelectAllRows:a,onUnselectAllRows:o,bulkLimit:l,allRowsCount:d,className:u}=e;if(d&&d<=t||!s)return null;const{noticeText:p,actionText:g}=function(e,t){return(0,re.ri)(e)?t&&e>t?{noticeText:(0,r._N)("Selected up to the first [count] items.",{count:t}),actionText:(0,r._N)("Select the first [count] items.",{count:t})}:{noticeText:(0,r._N)("Selected all [count] items.",{count:e}),actionText:(0,r._N)("Select all [count] items.",{count:e})}:{noticeText:(0,r.t)("Selected all items across all pages."),actionText:(0,r.t)("Select all items across all pages.")}}(d,l);return(0,D.tZ)(be,{columnsCount:n,className:u,children:i?(0,D.BX)(c.Fragment,{children:[p," ",(0,D.tZ)(Ze,{priority:"link",onClick:o,children:(0,r.t)("Cancel selection.")})]}):(0,D.BX)(c.Fragment,{children:[(0,r.tn)("%s item on this page selected.","%s items on this page selected.",t)," ",(0,D.tZ)(Ze,{priority:"link",onClick:a,children:g})]})})}Ne.displayName="BulkNotice";const be=(0,q.Z)((e=>{let{columnsCount:t,...n}=e;return(0,D.tZ)(o.aU,{...n})}),{target:"e1cwk49q1"})("grid-column:span ",(e=>e.columnsCount),";text-align:center;"),Ze=(0,q.Z)(J.ZP,{target:"e1cwk49q0"})("&,&:hover,&:active,&:focus{color:",(e=>e.theme.textColor),";border:none;border-radius:0;border-bottom:1px dotted ",(e=>e.theme.textColor),";padding-bottom:1px;font-size:15px;}"),fe=Ne;class xe extends c.Component{constructor(){super(...arguments),(0,d.Z)(this,"state",this.getInitialState()),(0,d.Z)(this,"handleRowToggle",(e=>{this.setState((t=>({selectedIds:Re()(t.selectedIds,[e]),isAllSelected:!1})))})),(0,d.Z)(this,"handleAllRowsToggle",(e=>{const{pageIds:t}=this.props;this.setState({selectedIds:e?[...t]:[],isAllSelected:e})})),(0,d.Z)(this,"handlePageRowsToggle",(e=>{const{pageIds:t}=this.props;this.setState((n=>({selectedIds:e?ye()([...n.selectedIds,...t]):n.selectedIds.filter((e=>!t.includes(e))),isAllSelected:!1})))}))}getInitialState(){const{defaultSelectedIds:e,pageIds:t}=this.props;return{selectedIds:_e()(null!=e?e:[],t),isAllSelected:!1}}static getDerivedStateFromProps(e,t){return{...t,selectedIds:_e()(t.selectedIds,e.pageIds)}}componentDidUpdate(e,t){var n,s;Q()(t,this.state)||null===(n=(s=this.props).onChange)||void 0===n||n.call(s,this.state)}render(){const{pageIds:e,children:t,columnsCount:n,allRowsCount:s,bulkLimit:i}=this.props,{selectedIds:a,isAllSelected:o}=this.state,r=e.length>0&&e.every((e=>a.includes(e)));return t({selectedIds:a,isAllSelected:o,isPageSelected:r,onRowToggle:this.handleRowToggle,onAllRowsToggle:this.handleAllRowsToggle,onPageRowsToggle:this.handlePageRowsToggle,renderBulkNotice:()=>(0,D.tZ)(fe,{allRowsCount:s,selectedRowsCount:a.length,onUnselectAllRows:()=>this.handleAllRowsToggle(!1),onSelectAllRows:()=>this.handleAllRowsToggle(!0),columnsCount:n,isPageSelected:r,isAllSelected:o,bulkLimit:i})})}}xe.displayName="BulkController";const Se=xe;var Ae=n("./app/components/switchButton.tsx");const ve=Object.values(I.BT);function Ce(e){let{onChange:t,selectedLegacyBrowsers:n=[]}=e;return(0,D.tZ)(Se,{pageIds:ve,defaultSelectedIds:n,allRowsCount:ve.length,onChange:function(e){let{selectedIds:n}=e;t(n)},columnsCount:0,children:e=>{let{selectedIds:t,onRowToggle:n,onPageRowsToggle:s,isPageSelected:i}=e;return(0,D.BX)(Oe,{children:[(0,r.t)("All browsers"),(0,D.tZ)(Ae.Z,{size:"lg",isActive:i,toggle:()=>{s(!i)}},"switch"),ve.map((e=>{const{icon:s,title:i}=C[e];return(0,D.BX)(c.Fragment,{children:[(0,D.BX)(Ve,{children:[(0,D.tZ)(je,{className:`icon-${s}`,"data-test-id":`icon-${s}`}),i]}),(0,D.tZ)(Ae.Z,{size:"lg",isActive:t.includes(e),toggle:()=>n(e)})]},e)}))]})}})}Ce.displayName="LegacyBrowsers";const we=Ce,Oe=(0,q.Z)("div",{target:"e1sw7fxt2"})("grid-column:1/-1;display:grid;grid-template-columns:1fr max-content;gap:",(0,oe.Z)(2),";font-size:",(e=>e.theme.fontSizeLarge),";color:",(e=>e.theme.gray400),";padding-top:",(0,oe.Z)(2),";padding-bottom:",(0,oe.Z)(1),";"),Ve=(0,q.Z)("div",{target:"e1sw7fxt1"})("display:grid;grid-template-columns:max-content 1fr;grid-column-gap:",(0,oe.Z)(1),";color:",(e=>e.theme.gray500),";"),je=(0,q.Z)("div",{target:"e1sw7fxt0"})({name:"1bjfr92",styles:"width:24px;height:24px;background-repeat:no-repeat;background-position:center;background-size:24px 24px;flex-shrink:0"});var ke=n("./app/components/forms/selectField.tsx");function Me(e){let{tags:t,onChange:n,value:s,disabledOptions:i}=e;const a=t.map((e=>{let{key:t}=e;return{value:t,label:(0,D.tZ)(B,{value:t})}}));return s&&s!==I.gI.EVENT_CUSTOM_TAG&&!t.some((e=>{let{key:t}=e;return t===s}))&&a.push({value:s,label:(0,D.tZ)(B,{value:s})}),(0,D.tZ)(De,{children:(0,D.tZ)(ke.Z,{"aria-label":(0,r.t)("Search or add a tag"),name:"customTagKey",options:a,isOptionDisabled:e=>i.includes(e.value),inline:!1,stacked:!0,hideControlState:!0,required:!0,creatable:!0,placeholder:(0,r.t)("tag"),onChange:n,value:s,formatCreateLabel:W})})}Me.displayName="TagKeyAutocomplete";const De=(0,q.Z)("div",{target:"eog8qme0"})({name:"1d3w5wq",styles:"width:100%"});var Be=n("./app/actionCreators/tags.tsx");function Le(e){let{orgSlug:t,projectId:n,category:s,onChange:i,value:a,tagKey:o}=e;const l=(0,le.Z)(),[d,u]=(0,c.useState)([]),p=(0,c.useCallback)((async()=>{if(o)try{const e=await(0,Be.Fo)(l,t,o,null,[n]);u(e)}catch{}}),[o,l,t,n]);(0,c.useEffect)((()=>{p()}),[p]);const g=a?a.split("\n").filter((e=>!d.some((t=>t.value===e)))).map((e=>({value:e}))):[];return(0,D.tZ)(Ue,{name:"match","aria-label":function(){switch(s){case I.gI.TRACE_RELEASE:case I.gI.EVENT_RELEASE:return(0,r.t)("Search or add a release");case I.gI.TRACE_ENVIRONMENT:case I.gI.EVENT_ENVIRONMENT:return(0,r.t)("Search or add an environment");case I.gI.TRACE_TRANSACTION:case I.gI.EVENT_TRANSACTION:return(0,r.t)("Search or add a transaction");case I.gI.EVENT_OS_NAME:return(0,r.t)("Search or add an os name");case I.gI.EVENT_OS_VERSION:return(0,r.t)("Search or add an os version");case I.gI.EVENT_DEVICE_FAMILY:return(0,r.t)("Search or add a device family");case I.gI.EVENT_DEVICE_NAME:return(0,r.t)("Search or add a device name");default:return(0,r.t)("Search or add tag values")}}(),options:[...g,...d].map((e=>({value:e.value,label:(0,D.tZ)(B,{value:e.value})}))),value:null==a?void 0:a.split("\n"),onChange:e=>{i(null==e?void 0:e.join("\n"))},components:{MultiValue:e=>(0,D.tZ)(H.y.MultiValue,{...e,innerProps:{...e.innerProps,"data-test-id":"multivalue"}})},formatCreateLabel:W,placeholder:P(s),inline:!1,multiple:!0,hideControlState:!0,flexibleControlStateSize:!0,required:!0,stacked:!0,creatable:!0,allowClear:!0})}Le.displayName="TagValueAutocomplete";const Ue=(0,q.Z)(ke.Z,{target:"exfns3x0"})({name:"1d3w5wq",styles:"width:100%"});function Pe(e){let{conditions:t,orgSlug:n,projectId:s,projectSlug:i,onDelete:a,onChange:o}=e;const l=(0,le.Z)(),[d,u]=(0,c.useState)([]);return(0,c.useEffect)((()=>{!async function(){try{const e=await l.requestPromise(`/projects/${n}/${i}/tags/`,{query:{onlySamplingTags:1}});u(e)}catch{}}()}),[l,n,i]),(0,D.tZ)(c.Fragment,{children:t.map(((e,i)=>{const{category:l,match:c,legacyBrowsers:u}=e,p=l===I.gI.EVENT_LEGACY_BROWSER,g=V(l),m=l===I.gI.EVENT_BROWSER_EXTENSIONS||l===I.gI.EVENT_LOCALHOST||l===I.gI.EVENT_WEB_CRAWLERS,h=l===I.gI.EVENT_ENVIRONMENT||l===I.gI.EVENT_RELEASE||l===I.gI.EVENT_TRANSACTION||l===I.gI.EVENT_OS_NAME||l===I.gI.EVENT_DEVICE_FAMILY||l===I.gI.EVENT_DEVICE_NAME||l===I.gI.TRACE_ENVIRONMENT||l===I.gI.TRACE_RELEASE||l===I.gI.TRACE_TRANSACTION||g;return(0,D.BX)(Xe,{children:[(0,D.tZ)($e,{children:g?(0,D.tZ)(Me,{tags:d,onChange:e=>{return o(i,"category",(t=e).startsWith(O)?t:`event.tags.${t}`);var t},value:j(l),disabledOptions:t.filter((e=>V(e.category)&&e.category!==l)).map((e=>j(e.category)))}):(0,D.BX)("span",{children:[w(l),(0,D.tZ)(ge.Z,{})]})}),(0,D.tZ)(Ge,{children:!m&&(h?(0,D.tZ)(Le,{category:l,tagKey:F(e),orgSlug:n,projectId:s,value:c,onChange:e=>o(i,"match",e)}):(0,D.tZ)(qe,{name:"match",value:c,onChange:e=>o(i,"match",e),placeholder:P(l),inline:!1,rows:1,autosize:!0,hideControlState:!0,flexibleControlStateSize:!0,required:!0,stacked:!0}))}),(0,D.tZ)(We,{children:(0,D.tZ)(J.ZP,{onClick:()=>a(i),icon:(0,D.tZ)(he.F,{}),"aria-label":(0,r.t)("Delete Condition")})}),p&&(0,D.tZ)(we,{selectedLegacyBrowsers:u,onChange:e=>{o(i,"legacyBrowsers",e)}})]},i)}))})}Pe.displayName="Conditions";const ze=Pe,Xe=(0,q.Z)("div",{target:"esyyyht5"})("display:grid;grid-template-columns:minmax(0, 1fr) minmax(0, 1fr);align-items:flex-start;padding:",(0,oe.Z)(1)," ",(0,oe.Z)(2),";:not(:last-child){border-bottom:1px solid ",(e=>e.theme.gray100),";}@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:minmax(0, 0.6fr) minmax(0, 1fr) max-content;}"),Fe=(0,q.Z)("div",{target:"esyyyht4"})({name:"38ghps",styles:"min-height:40px;display:inline-flex;align-items:center"}),$e=(0,q.Z)(Fe,{target:"esyyyht3"})("padding-right:",(0,oe.Z)(1),";line-height:16px;"),Ge=(0,q.Z)(Fe,{target:"esyyyht2"})("padding-top:",(0,oe.Z)(1),";grid-column:1/-1;grid-row:2/2;",(e=>!e.children&&"display: none"),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-column:auto;grid-row:auto;padding-top:0;}"),We=(0,q.Z)(Fe,{target:"esyyyht1"})("justify-content:flex-end;padding-left:",(0,oe.Z)(1),";"),qe=(0,q.Z)(me.Z,{target:"esyyyht0"})({name:"1fz47qv",styles:"padding-bottom:0;width:100%"}),Ye=(0,r.t)("This condition has already been added");function He(e){let{Header:t,Body:n,Footer:s,closeModal:i,project:a,onSubmitSuccess:l,rule:d,rules:u,disabled:m,type:h,organization:E}=e;const T=(0,le.Z)(),y=(0,ce.U)(),b=(0,de.T)(),Z=(0,ue.s)().routes,[f,x]=(0,c.useState)(function(){if(d){const{condition:e,sampleRate:t}=d,{inner:n}=e;return{conditions:n.map((e=>{const{name:t,value:n}=e;return Array.isArray(n)?n.every((e=>!!C[e]))?{category:t,legacyBrowsers:n}:{category:t,match:n.join("\n")}:{category:t}})),sampleRate:100*t,errors:{}}}return{conditions:[],sampleRate:null,errors:{}}}()),[S,A]=(0,c.useState)(!1),v=function(e){const t=e.includes(I.gI.EVENT_CUSTOM_TAG),n=e.filter((e=>e!==I.gI.EVENT_CUSTOM_TAG)).sort(((e,t)=>w(e).localeCompare(w(t))));return t&&n.push(I.gI.EVENT_CUSTOM_TAG),n.map((e=>[e,w(e)]))}(h===I.C7.TRACE?$:G);(0,c.useEffect)((()=>{x((e=>e.errors.sampleRate?{...e,errors:{...e.errors,sampleRate:void 0}}:e))}),[f.sampleRate]);const{errors:O,conditions:j,sampleRate:M}=f;async function B(){if(!(0,re.ri)(M))return;const e={id:0,type:h,condition:{op:I.fz.AND,inner:j.length?j.map(z):[]},sampleRate:M/100},t=d?u.map((t=>Q()(t,d)?e:t)):[...u,e],[n,s]=p()(t,(e=>e.type===I.C7.TRACE)),o=[...n,...s],c=o.findIndex((t=>t===e));A(!0);try{const e=await T.requestPromise(`/projects/${E.slug}/${a.slug}/`,{method:"PUT",data:{dynamicSampling:{rules:o}}});l(e,d?(0,r.t)("Successfully edited sampling rule"):(0,r.t)("Successfully added sampling rule")),i()}catch(e){!function(e){"string"!=typeof e?"sampleRate"===e.type?x({...f,errors:{...O,sampleRate:e.message}}):(0,g.Iw)(e.message):(0,g.Iw)(e)}(function(e,t){var n,s,i;const a=null===(n=e.responseJSON)||void 0===n?void 0:n.detail;if(a)return a[0];const o=e.responseJSON;if(!o)return X;const l=null!==(s=null===(i=o.dynamicSampling)||void 0===i?void 0:i.rules[t])&&void 0!==s?s:{},[d,c]=Object.entries(l)[0];return"sampleRate"===d?{type:"sampleRate",message:(0,r.t)("Ensure this value is a floating number between 0 and 100")}:X}(e,c))}A(!1);const m=j.map((e=>e.category)),_=m.sort().join(", ");(0,R.Z)("sampling.settings.rule.save",{organization:E,project_id:a.id,sampling_rate:M,conditions:m,conditions_stringified:_}),(0,re.ri)(d)?(0,R.Z)("sampling.settings.rule.update",{organization:E,project_id:a.id,sampling_rate:M,conditions:m,conditions_stringified:_,old_conditions:d.condition.inner.map((e=>{let{name:t}=e;return t})),old_conditions_stringified:d.condition.inner.map((e=>{let{name:t}=e;return t})).sort().join(", "),old_sampling_rate:100*d.sampleRate}):(0,R.Z)("sampling.settings.rule.create",{organization:E,project_id:a.id,sampling_rate:M,conditions:m,conditions_stringified:_})}const L=u.filter((e=>e.type===h&&!Q()(e,d))).some((e=>!e.condition.inner.length)),U=!(0,re.ri)(M)||L&&!j.length||!(null==j||!j.find((e=>{var t;return e.category===I.gI.EVENT_LEGACY_BROWSER?!(null!==(t=e.legacyBrowsers)&&void 0!==t?t:[]).length:e.category!==I.gI.EVENT_LOCALHOST&&e.category!==I.gI.EVENT_BROWSER_EXTENSIONS&&e.category!==I.gI.EVENT_WEB_CRAWLERS&&(""===e.category||e.category===I.gI.EVENT_CUSTOM_TAG||!e.match)}))),P=j.filter((e=>V(e.category)&&e.category!==I.gI.EVENT_CUSTOM_TAG)).map((e=>{let{category:t}=e;return{value:t,label:(0,D.tZ)(k.Z,{value:w(t),expandable:!1,maxLength:40}),disabled:!0,tooltip:Ye}})),F=v.map((e=>{let[t,n]=e;const s=t!==I.gI.EVENT_CUSTOM_TAG&&j.some((e=>e.category===t));return{value:t,label:n,disabled:s,tooltip:m?Ye:void 0}})),{title:W,description:q}=h===I.C7.TRACE?{title:d?(0,r.t)("Edit Distributed Trace Rule"):(0,r.t)("Add Distributed Trace Rule"),description:(0,r._N)("Using a Trace ID, select all Transactions distributed across multiple projects/services which match your conditions. However, if you only want to select Transactions from within this project, we recommend you add a [link] rule instead.",{link:(0,D.tZ)(_.Z,{to:(0,N.Z)(`${I.C7.TRANSACTION}/`,{routes:Z,location:b,params:y,stepBack:-1}),children:(0,r.t)("Individual Transaction")})})}:{title:d?(0,r.t)("Edit Individual Transaction Rule"):(0,r.t)("Add Individual Transaction Rule"),description:(0,r._N)("Select Transactions only within this project which match your conditions. However, If you want to select all Transactions distributed across multiple projects/services, we recommend you add a [link] rule instead.",{link:(0,D.tZ)(_.Z,{to:(0,N.Z)(`${I.C7.TRACE}/`,{routes:Z,location:b,params:y,stepBack:-1}),children:(0,r.t)("Distributed Trace")})})};return(0,D.BX)(c.Fragment,{children:[(0,D.tZ)(t,{closeButton:!0,children:(0,D.tZ)("h4",{children:W})}),(0,D.tZ)(n,{children:(0,D.BX)(Ke,{children:[(0,D.tZ)(st,{children:q}),(0,D.BX)(et,{children:[(0,D.BX)(Je,{hasButtons:!0,children:[(0,r.t)("Conditions"),(0,D.tZ)(Qe,{placement:"bottom right",triggerLabel:(0,D.BX)(nt,{children:[(0,D.tZ)(ie.N_,{isCircled:!0}),(0,r.t)("Add Condition")]}),placeholder:(0,r.t)("Filter conditions"),isOptionDisabled:e=>e.disabled,options:[...P,...F],value:j.filter((e=>{let{category:t}=e;return t!==I.gI.EVENT_CUSTOM_TAG})).map((e=>{let{category:t}=e;return t})),onChange:function(e){const t=j.map((e=>{let{category:t}=e;return t})),n=e.filter((e=>{let{value:n}=e;return n===I.gI.EVENT_CUSTOM_TAG||!t.includes(n)})).map((e=>{let{value:t}=e;return t}));(0,R.Z)("sampling.settings.condition.add",{organization:E,project_id:a.id,conditions:n}),x({...f,conditions:[...j,...n.map((e=>({category:e,match:""})))]})},isSearchable:!0,multiple:!0,filterOption:(e,t)=>e.value===I.gI.EVENT_CUSTOM_TAG||(0,Y.c)(null)(e,t),components:{Option:e=>e.value===I.gI.EVENT_CUSTOM_TAG?(0,D.tZ)(H.y.Option,{className:"select-option",...e,children:(0,D.BX)(tt,{isFocused:e.isFocused,children:[(0,D.tZ)(ie.N_,{isCircled:!0})," ",(0,r.t)("Add Custom Tag")]})}):(0,D.tZ)(se.Z,{...e})}})]}),(0,D.tZ)(o.N,{children:j.length?(0,D.tZ)(ze,{conditions:j,onDelete:function(e){const t=[...j];t.splice(e,1),x({...f,conditions:t})},onChange:function(e,t,n){const s=[...j];s[e][t]=n,"category"===t&&(s[e].match="",(0,R.Z)("sampling.settings.condition.add",{organization:E,project_id:a.id,conditions:[n]})),x({...f,conditions:s})},orgSlug:E.slug,projectId:a.id,projectSlug:a.slug}):(0,D.tZ)(pe.Z,{icon:(0,D.tZ)(ae.j,{size:"xl"}),title:(0,r.t)("No conditions added"),description:L?(0,r._N)("A rule without conditions already exists. [lineBreak]Add (+) a condition for creating a new rule",{lineBreak:(0,D.tZ)("br",{})}):(0,r._N)("if you don't want to add (+) a condition, [lineBreak]simply, add a sample rate below",{lineBreak:(0,D.tZ)("br",{})})})})]}),(0,D.tZ)(ne.Z,{label:`${(0,r.t)("Sample Rate")} %`,name:"sampleRate",onChange:e=>{x({...f,sampleRate:e?Number(e):null})},onKeyDown:(e,t)=>{"Enter"===t.key&&B()},placeholder:"%",value:M,inline:!1,hideControlState:!O.sampleRate,error:O.sampleRate,showHelpInTooltip:!0,stacked:!0,required:!0})]})}),(0,D.tZ)(s,{children:(0,D.BX)(ee.ZP,{gap:1,children:[(0,D.tZ)(J.ZP,{onClick:i,children:(0,r.t)("Cancel")}),(0,D.tZ)(J.ZP,{priority:"primary",onClick:B,title:m?(0,r.t)("You do not have permission to add sampling rules."):U?(0,r.t)("Required fields must be filled out"):void 0,disabled:m||S||U,children:(0,r.t)("Save Rule")})]})})]})}He.displayName="SamplingRuleModal";const Ke=(0,q.Z)("div",{target:"e13luzfr6"})("display:grid;gap:",(0,oe.Z)(2),";"),Qe=(0,q.Z)(te.Z,{target:"e13luzfr5"})({name:"1ffbk74",styles:"font-weight:400;text-transform:none"}),Je=(0,q.Z)(o.V9,{target:"e13luzfr4"})("padding-right:",(0,oe.Z)(2),";"),et=(0,q.Z)(o.s_,{target:"e13luzfr3"})({name:"1ykowef",styles:"margin-bottom:0"}),tt=(0,q.Z)("div",{target:"e13luzfr2"})("display:flex;align-items:center;padding:",(0,oe.Z)(1)," ",(0,oe.Z)(1)," ",(0,oe.Z)(1)," ",(0,oe.Z)(1.5),";gap:",(0,oe.Z)(1),";line-height:1.4;border-radius:",(e=>e.theme.borderRadius),";",(e=>e.isFocused&&`background: ${e.theme.hover};`),";"),nt=(0,q.Z)("div",{target:"e13luzfr1"})("display:grid;grid-template-columns:repeat(2, max-content);align-items:center;gap:",(0,oe.Z)(1),";"),st=(0,q.Z)(x.Z,{target:"e13luzfr0"})({name:"ti75j2",styles:"margin:0"});var it=n("./app/components/alert.tsx"),at=n("../node_modules/react-dom/profiling.js"),ot=n("../node_modules/@dnd-kit/core/dist/core.esm.js"),rt=n("../node_modules/@dnd-kit/sortable/dist/sortable.esm.js");function lt(e){let{value:t,dragging:n,index:s,transform:i,listeners:a,sorting:o,transition:r,forwardRef:l,attributes:d,renderItem:c,wrapperStyle:u}=e;return(0,D.tZ)(ut,{"data-test-id":"sampling-rule",ref:l,style:{...u,transition:r,"--translate-x":i?`${Math.round(i.x)}px`:void 0,"--translate-y":i?`${Math.round(i.y)}px`:void 0,"--scale-x":null!=i&&i.scaleX?`${i.scaleX}`:void 0,"--scale-y":null!=i&&i.scaleY?`${i.scaleY}`:void 0},children:(0,D.tZ)(pt,{children:c({dragging:Boolean(n),sorting:Boolean(o),listeners:a,transform:i,transition:r,value:t,index:s,attributes:d})})})}lt.displayName="Item";const dt="0 0 0 calc(1px / var(--scale-x, 1)) rgba(63, 63, 68, 0.05)",ct=`${dt}, 0 1px calc(3px / var(--scale-x, 1)) 0 rgba(34, 33, 81, 0.15)`,ut=(0,q.Z)("div",{target:"e1qaz8jb1"})("transform:translate3d(var(--translate-x, 0), var(--translate-y, 0), 0) scaleX(var(--scale-x, 1)) scaleY(var(--scale-y, 1));transform-origin:0 0;touch-action:manipulation;--box-shadow:",ct,";--box-shadow-picked-up:",dt,",-1px 0 15px 0 rgba(34, 33, 81, 0.01),0px 15px 15px 0 rgba(34, 33, 81, 0.25);"),pt=(0,q.Z)("div",{target:"e1qaz8jb0"})("background-color:",(e=>e.theme.background),";animation:pop 200ms cubic-bezier(0.18, 0.67, 0.6, 1.22);box-shadow:var(--box-shadow-picked-up);opacity:1;:focus{box-shadow:0 0px 4px 1px rgba(76, 159, 254, 1),",ct,";}@keyframes pop{0%{transform:scale(1);box-shadow:var(--box-shadow);}100%{box-shadow:var(--box-shadow-picked-up);}}");function gt(e){let{id:t,index:n,renderItem:s,disabled:i,wrapperStyle:a}=e;const{attributes:o,isSorting:r,isDragging:l,listeners:d,setNodeRef:c,transform:u,transition:p}=(0,rt.nB)({id:t,disabled:i});return(0,D.tZ)(lt,{forwardRef:c,value:t,sorting:r,renderItem:s,index:n,transform:u,transition:p,listeners:d,attributes:o,wrapperStyle:a({index:n,isDragging:l,isSorting:r})})}function mt(e){let{items:t,onUpdateItems:n,renderItem:s,disabled:i=!1,wrapperStyle:a=(()=>({}))}=e;const[o,r]=(0,c.useState)({}),l=t.map((e=>e.id)),d=l.indexOf.bind(l),u=o.activeId?d(o.activeId):-1;return(0,D.BX)(ot.LB,{onDragStart:e=>{let{active:t}=e;t&&r({activeId:t.id})},onDragEnd:e=>{let{over:t}=e;if(r({activeId:void 0}),t){const e=d(t.id);u!==e&&n({activeIndex:u,overIndex:e,reorderedItems:(0,rt.Rp)(l,u,e)})}},onDragCancel:()=>r({activeId:void 0}),children:[(0,D.tZ)(rt.Fo,{items:l,strategy:rt.qw,children:l.map(((e,n)=>(0,D.tZ)(gt,{id:e,index:n,renderItem:s,disabled:i||t[n].disabled,wrapperStyle:a},e)))}),(0,at.createPortal)((0,D.tZ)(ot.y9,{children:o.activeId?(0,D.tZ)(lt,{value:l[u],renderItem:s,wrapperStyle:a({index:u,isDragging:!0,isSorting:!1})}):null}),document.body)]})}gt.displayName="SortableItem",mt.displayName="DraggableList";var ht=n("./app/components/tooltip.tsx"),Et=n("./app/icons/iconGrabbable.tsx");const _t=e=>`\n> * {\n  :nth-child(-n + 5):nth-child(5n - 1) {\n    text-align: right;\n  }\n\n  @media (max-width: ${e.breakpoints.small}) {\n    :nth-child(5n - 4),\n    :nth-child(5n - 3) {\n      display: none;\n    }\n  }\n}\n\ngrid-template-columns: 1fr 0.5fr 66px;\n\n@media (min-width: ${e.breakpoints.small}) {\n  grid-template-columns: 48px 95px 1fr 0.5fr 66px;\n}\n\n@media (min-width: ${e.breakpoints.large}) {\n  grid-template-columns: 48px 95px 1.5fr 1fr 124px;\n}\n\n@media (min-width: ${e.breakpoints.xlarge}) {\n  grid-template-columns: 48px 95px 1fr 0.5fr 124px;\n}\n`;var Tt=n("./app/components/actions/menuItemActionLink.tsx"),yt=n("./app/components/confirm.tsx"),It=n("./app/components/dropdownLink.tsx");const Rt=(0,r.t)("Are you sure you wish to delete this sampling rule?"),Nt=(0,r.t)("You do not have permission to delete sampling rules."),bt=(0,r.t)("You do not have permission to edit sampling rules.");function Zt(e){let{disabled:t,onEditRule:n,onDeleteRule:s,onOpenMenuActions:i,isMenuActionsOpen:a}=e;return(0,D.BX)(c.Fragment,{children:[(0,D.BX)(ft,{gap:1,children:[(0,D.tZ)(J.ZP,{"aria-label":(0,r.t)("Edit Rule"),size:"small",onClick:n,icon:(0,D.tZ)(ie.yl,{}),disabled:t,title:t?bt:void 0}),(0,D.tZ)(yt.Z,{priority:"danger",message:Rt,onConfirm:s,disabled:t,children:(0,D.tZ)(J.ZP,{"aria-label":(0,r.t)("Delete Rule"),size:"small",icon:(0,D.tZ)(ie.Fz,{}),title:t?Nt:void 0})})]}),(0,D.BX)(xt,{caret:!1,customTitle:(0,D.tZ)(J.ZP,{"aria-label":(0,r.t)("Actions"),icon:(0,D.tZ)(ie.YR,{size:"sm"}),size:"xsmall",onClick:i}),isOpen:a,anchorRight:!0,children:[(0,D.tZ)(Tt.Z,{shouldConfirm:!1,icon:(0,D.tZ)(ie.Dj,{size:"xs"}),title:(0,r.t)("Edit"),onClick:t?e=>{null==e||e.stopPropagation()}:n,disabled:t,children:(0,D.tZ)(ht.Z,{disabled:!t,title:bt,containerDisplayMode:"block",children:(0,r.t)("Edit")})}),(0,D.tZ)(Tt.Z,{onAction:s,message:Rt,icon:(0,D.tZ)(ie.Dj,{size:"xs"}),title:(0,r.t)("Delete"),disabled:t,priority:"danger",shouldConfirm:!0,children:(0,D.tZ)(ht.Z,{disabled:!t,title:Nt,containerDisplayMode:"block",children:(0,r.t)("Delete")})})]})]})}Zt.displayName="Actions";const ft=(0,q.Z)(ee.ZP,{target:"e1nslgmf1"})("justify-content:flex-end;flex:1;display:none;@media (min-width: ",(e=>e.theme.breakpoints.large),"){display:grid;}"),xt=(0,q.Z)(It.Z,{target:"e1nslgmf0"})("display:flex;align-items:center;transition:none;@media (min-width: ",(e=>e.theme.breakpoints.large),"){display:none;}");function St(e){var t,n;let{value:s}=e;return Array.isArray(s)?(0,D.tZ)("div",{children:[...s].map(((e,t)=>{var n,i;return(0,D.BX)(c.Fragment,{children:[(0,D.tZ)(At,{children:null!==(n=null===(i=C[e])||void 0===i?void 0:i.title)&&void 0!==n?n:e}),t!==s.length-1&&(0,D.tZ)(vt,{children:","})]},e)}))}):(0,D.tZ)(At,{children:null!==(t=null===(n=C[String(s)])||void 0===n?void 0:n.title)&&void 0!==t?t:String(s)})}St.displayName="ConditionValue";const At=(0,q.Z)("span",{target:"e19kzc9b1"})("color:",(e=>e.theme.gray300),";"),vt=(0,q.Z)(At,{target:"e19kzc9b0"})("padding-right:",(0,oe.Z)(.5),";");function Ct(e){let{dragging:t,sorting:n,rule:s,noPermission:i,onEditRule:a,onDeleteRule:o,listeners:l,operator:d,grabAttributes:u,hideGrabButton:p}=e;const[g,m]=(0,c.useState)({isMenuActionsOpen:!1});return(0,c.useEffect)((()=>{(t||n)&&g.isMenuActionsOpen&&m({isMenuActionsOpen:!1})}),[t,n,g.isMenuActionsOpen]),(0,D.BX)(Mt,{disabled:s.disabled||i,children:[p?(0,D.tZ)(Vt,{}):(0,D.tZ)(kt,{children:(0,D.tZ)(ht.Z,{title:i?(0,r.t)("You do not have permission to reorder rules."):d===I.eV.ELSE?(0,r.t)("Rules without conditions cannot be reordered."):void 0,containerDisplayMode:"flex",children:(0,D.tZ)(jt,{...l,...u,children:(0,D.tZ)(Et.L,{})})})}),(0,D.tZ)(Vt,{children:(0,D.tZ)(wt,{children:d===I.eV.IF?(0,r.t)("If"):d===I.eV.ELSE_IF?(0,r.t)("Else if"):(0,r.t)("Else")})}),(0,D.tZ)(Vt,{children:(0,D.tZ)(Bt,{children:p&&!s.condition.inner.length?(0,r.t)("All"):s.condition.inner.map(((e,t)=>(0,D.BX)(c.Fragment,{children:[(0,D.tZ)(Lt,{children:w(e.name)}),(0,D.tZ)(Ut,{children:"="}),(0,D.tZ)(St,{value:e.value})]},t)))})}),(0,D.tZ)(Dt,{children:(0,D.tZ)(Ot,{children:100*s.sampleRate+"%"})}),(0,D.tZ)(Vt,{children:(0,D.tZ)(Zt,{onEditRule:a,onDeleteRule:o,disabled:i,onOpenMenuActions:()=>m({isMenuActionsOpen:!g.isMenuActionsOpen}),isMenuActionsOpen:g.isMenuActionsOpen})})]})}Ct.displayName="Rule";const wt=(0,q.Z)("div",{target:"e1pnylbl9"})("color:",(e=>e.theme.active),";"),Ot=(0,q.Z)("div",{target:"e1pnylbl8"})({name:"1h3cbh4",styles:"white-space:pre-wrap;word-break:break-all"}),Vt=(0,q.Z)("div",{target:"e1pnylbl7"})("display:flex;padding:",(0,oe.Z)(1)," ",(0,oe.Z)(2),";cursor:default;white-space:pre-wrap;word-break:break-all;line-height:34px;"),jt=(0,q.Z)("div",{target:"e1pnylbl6"})({name:"cguhaz",styles:"outline:none;display:flex;align-items:center;height:34px"}),kt=(0,q.Z)(Vt,{target:"e1pnylbl5"})({name:"1hxppjt",styles:"[role='button']{cursor:grab;}"}),Mt=(0,q.Z)("div",{target:"e1pnylbl4"})("display:grid;align-items:flex-start;line-height:34px;",(e=>_t(e.theme)),">*{overflow:visible;:nth-child(5n){justify-content:flex-end;}}",(e=>e.disabled&&(0,S.iv)(kt,"{color:",e.theme.disabled,";[role='button']{cursor:not-allowed;}}","")),";"),Dt=(0,q.Z)(Vt,{target:"e1pnylbl3"})({name:"e8bs7r",styles:"text-align:right;justify-content:flex-end"}),Bt=(0,q.Z)("div",{target:"e1pnylbl2"})("display:grid;color:",(e=>e.theme.purple300),";align-items:flex-start;width:100%;@media (min-width: ",(e=>e.theme.breakpoints.medium),"){grid-template-columns:max-content max-content 1fr;grid-column-gap:",(0,oe.Z)(1),";}"),Lt=(0,q.Z)("div",{target:"e1pnylbl1"})("color:",(e=>e.theme.gray400),";"),Ut=(0,q.Z)("div",{target:"e1pnylbl0"})("display:none;@media (min-width: ",(e=>e.theme.breakpoints.medium),"){display:block;}");class Pt extends c.PureComponent{constructor(){super(...arguments),(0,d.Z)(this,"state",{rules:[]}),(0,d.Z)(this,"handleUpdateRules",(e=>{let{activeIndex:t,overIndex:n,reorderedItems:s}=e;const{rules:i}=this.state,a=i[t],o=i[n];if(!o.condition.inner.length)return void(0,g.Iw)((0,r.t)("Rules with conditions cannot be below rules without conditions"));if(a.type===I.C7.TRACE&&o.type===I.C7.TRANSACTION)return void(0,g.Iw)((0,r.t)("Transaction traces rules cannot be under individual transactions rules"));if(a.type===I.C7.TRANSACTION&&o.type===I.C7.TRACE)return void(0,g.Iw)((0,r.t)("Individual transactions rules cannot be above transaction traces rules"));const l=s.map((e=>i.find((t=>String(t.id)===e)))).filter((e=>!!e));this.setState({rules:l})}))}componentDidMount(){this.getRules()}componentDidUpdate(e){Q()(e.rules,this.props.rules)?Q()(this.props.rules,this.state.rules)||this.handleUpdateRulesParent():this.getRules()}getRules(){this.setState({rules:this.props.rules})}handleUpdateRulesParent(){const{onUpdateRules:e}=this.props,{rules:t}=this.state;e(t)}render(){const{onEditRule:e,onDeleteRule:t,disabled:n,infoAlert:s}=this.props,{rules:i}=this.state,a=i.map((e=>({...e,id:String(e.id),disabled:!e.condition.inner.length})));return(0,D.BX)(zt,{headers:["",(0,r.t)("Operator"),(0,r.t)("Condition"),(0,r.t)("Rate"),""],isEmpty:!i.length,emptyMessage:(0,r.t)("There are no transaction rules to display"),children:[s&&(0,D.tZ)(Xt,{type:"info",children:s}),(0,D.tZ)(mt,{disabled:n,items:a,onUpdateItems:this.handleUpdateRules,wrapperStyle:e=>{let{isDragging:t,isSorting:n,index:s}=e;return t?{cursor:"grabbing"}:n?{}:{transform:"none",transformOrigin:"0","--box-shadow":"none","--box-shadow-picked-up":"none",overflow:"visible",position:"relative",zIndex:i.length-s,cursor:"default"}},renderItem:s=>{let{value:i,listeners:o,attributes:r,dragging:l,sorting:d}=s;const c=a.findIndex((e=>e.id===i));if(-1===c)return null;const u=a[c],p={condition:u.condition,sampleRate:u.sampleRate,type:u.type,id:Number(u.id)};return(0,D.tZ)(Ct,{operator:u.id===a[0].id?I.eV.IF:u.disabled?I.eV.ELSE:I.eV.ELSE_IF,hideGrabButton:1===a.length,rule:{...p,disabled:u.disabled},onEditRule:e(p),onDeleteRule:t(p),noPermission:n,listeners:o,grabAttributes:r,dragging:l,sorting:d})}})]})}}Pt.displayName="Rules";const zt=(0,q.Z)(o.KB,{target:"e64zed31"})("overflow:visible;margin-bottom:0;border:none;border-bottom-right-radius:0;border-bottom-left-radius:0;",(e=>_t(e.theme)),">*{",(e=>e.theme.overflowEllipsis),";:not(:last-child){border-bottom:1px solid ",(e=>e.theme.border),";}:nth-child(n + 6){",(e=>e.isEmpty?"\n              display: block;\n              grid-column: 1/-1;\n            ":"\n              display: grid;\n              grid-column: 1/-1;\n              padding: 0;\n            "),";}}"),Xt=(0,q.Z)(o.aU,{target:"e64zed30"})({name:"5eh9f4",styles:"grid-column:1/-1;white-space:pre-wrap;&&{display:flex;}"});function Ft(e){let{rules:t,onAddRule:n,onEditRule:s,onDeleteRule:i,onUpdateRules:a,disabled:l,infoAlert:d}=e;return(0,D.BX)(o.s_,{children:[(0,D.tZ)(Pt,{rules:t,onEditRule:s,onDeleteRule:i,disabled:l,onUpdateRules:a,infoAlert:d}),(0,D.tZ)($t,{children:(0,D.BX)(Gt,{gap:1,children:[(0,D.tZ)(J.ZP,{href:v,external:!0,children:(0,r.t)("Read Docs")}),(0,D.tZ)(Wt,{priority:"primary",onClick:n,icon:(0,D.tZ)(ie.N_,{isCircled:!0}),children:(0,r.t)("Add Rule")})]})})]})}Ft.displayName="RulesPanel";const $t=(0,q.Z)(o.jH,{target:"e7v8x362"})("padding:",(0,oe.Z)(1)," ",(0,oe.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){display:flex;align-items:center;justify-content:flex-end;}"),Gt=(0,q.Z)(ee.ZP,{target:"e7v8x361"})("@media (max-width: ",(e=>e.theme.breakpoints.small),"){grid-auto-flow:row;grid-row-gap:",(0,oe.Z)(1),";}"),Wt=(0,q.Z)(J.ZP,{target:"e7v8x360"})("@media (max-width: ",(e=>e.theme.breakpoints.small),"){width:100%;}");function qt(e){const t=e.rules.some((e=>e.condition.op!==I.fz.AND));return(0,D.BX)(c.Fragment,{children:[(0,D.tZ)(x.Z,{children:(0,r.t)("Using a Trace ID, select all Transactions distributed across multiple projects/services which match your conditions.")}),t?(0,D.tZ)(it.Z,{type:"error",children:(0,r.t)("A condition operator has been found that is not yet supported.")}):(0,D.tZ)(Ft,{...e})]})}function Yt(e){const t=e.rules.some((e=>e.condition.op!==I.fz.AND));return(0,D.BX)(c.Fragment,{children:[(0,D.tZ)(x.Z,{children:(0,r.t)("Select Transactions only within this project which match your conditions.")}),t?(0,D.tZ)(it.Z,{type:"error",children:(0,r.t)("A condition operator has been found that is not yet supported.")}):(0,D.tZ)(Ft,{...e})]})}qt.displayName="TraceRules",Yt.displayName="TransactionRules";class Ht extends b.Z{constructor(){super(...arguments),(0,d.Z)(this,"successfullySubmitted",((e,t)=>{this.setState({projectDetails:e}),t&&(0,g.S9)(t)})),(0,d.Z)(this,"handleOpenRule",(e=>t=>()=>{const{project:n,organization:s,hasAccess:i}=this.props,{rules:a}=this.state;return(0,m.openModal)((o=>(0,D.tZ)(He,{...o,organization:s,project:n,rule:t,rules:a,onSubmitSuccess:this.successfullySubmitted,disabled:!i,type:e})),{modalCss:L})})),(0,d.Z)(this,"handleDeleteRule",(e=>()=>{const{organization:t,project:n}=this.props,{rules:s}=this.state,i=e.condition.inner.map((e=>{let{name:t}=e;return t}));(0,R.Z)("sampling.settings.rule.delete",{organization:t,project_id:n.id,sampling_rate:100*e.sampleRate,conditions:i,conditions_stringified:i.sort().join(", ")});const a=s.filter((t=>{let{id:n}=t;return n!==e.id}));this.submitRules(a,(0,r.t)("Successfully deleted sampling rule"),(0,r.t)("An error occurred while deleting sampling rule"))})),(0,d.Z)(this,"handleUpdateRules",(e=>{e.length&&this.submitRules(e)}))}getTitle(){return(0,r.t)("Sampling")}getDefaultState(){return{...super.getDefaultState(),rules:[],projectDetails:null}}getEndpoints(){const{organization:e,project:t}=this.props;return[["projectDetails",`/projects/${e.slug}/${t.slug}/`]]}componentDidMount(){const{organization:e,project:t}=this.props;(0,R.Z)("sampling.settings.view",{organization:e,project_id:t.id}),this.getRules()}componentDidUpdate(e,t){t.projectDetails===this.state.projectDetails||this.getRules()}getRules(){var e;const{projectDetails:t}=this.state;if(!t)return;const{dynamicSampling:n}=t,s=(null!==(e=null==n?void 0:n.rules)&&void 0!==e?e:[]).filter((e=>e.type===I.C7.TRANSACTION||e.type===I.C7.TRACE)),[i,a]=p()(s,(e=>!e.condition.inner.length));this.setState({rules:[...a,...i]})}async submitRules(e,t,n){const{organization:s,project:i}=this.props;try{const n=await this.api.requestPromise(`/projects/${s.slug}/${i.slug}/`,{method:"PUT",data:{dynamicSampling:{rules:e}}});this.successfullySubmitted(n,t)}catch(e){this.getRules(),n&&(0,g.Iw)(n)}}renderBody(){const{rules:e}=this.state,{hasAccess:t,location:n,params:s,routes:i}=this.props,a=!t,[o,l]=p()(e,(e=>e.type===I.C7.TRACE));return(0,D.BX)(c.Fragment,{children:[(0,D.tZ)(Z.Z,{title:this.getTitle(),subtitle:(0,D.BX)(c.Fragment,{children:[(0,D.tZ)(x.Z,{children:(0,r._N)("Here you can define what transactions count towards your quota without updating your SDK. Any rules specified here are applied after your [link:SDK sampling configuration]. New rules will propagate within a few minutes.",{link:(0,D.tZ)(E.Z,{href:v})})}),(0,D.tZ)(f.Z,{})]}),tabs:(0,D.BX)(y.Z,{role:"tablist","aria-label":(0,r.t)("Rules tabs"),underlined:!0,children:[(0,D.BX)(T.Z,{to:(0,N.Z)(`${I.C7.TRACE}/`,{routes:i,location:n,params:s,stepBack:-1}),role:"tab","aria-selected":s.ruleType===I.C7.TRACE,tabIndex:s.ruleType===I.C7.TRACE?0:-1,isActive:()=>s.ruleType===I.C7.TRACE,index:!0,children:[(0,r.t)("Distributed Traces"),(0,D.tZ)(h.Z,{children:o.length})]}),(0,D.BX)(T.Z,{to:(0,N.Z)(`${I.C7.TRANSACTION}/`,{routes:i,location:n,params:s,stepBack:-1}),role:"tab","aria-selected":s.ruleType===I.C7.TRANSACTION,tabIndex:s.ruleType===I.C7.TRANSACTION?0:-1,isActive:()=>s.ruleType===I.C7.TRANSACTION,children:[(0,r.t)("Individual Transactions"),(0,D.tZ)(h.Z,{children:l.length})]})]})}),s.ruleType===I.C7.TRANSACTION?(0,D.tZ)(Yt,{rules:l,infoAlert:o.length?(0,r._N)("[link] will initiate before these rules",{link:(0,D.tZ)(_.Z,{to:(0,N.Z)(`${I.C7.TRACE}/`,{routes:i,location:n,params:s,stepBack:-1}),children:(0,r.tn)("%s Distributed Trace rule","%s Distributed Trace rules",o.length)})}):null,onUpdateRules:e=>this.handleUpdateRules([...o,...e]),onDeleteRule:this.handleDeleteRule,onAddRule:this.handleOpenRule(I.C7.TRANSACTION)(),onEditRule:this.handleOpenRule(I.C7.TRANSACTION),disabled:a}):(0,D.tZ)(qt,{rules:o,onUpdateRules:e=>this.handleUpdateRules([...l,...e]),onDeleteRule:this.handleDeleteRule,onAddRule:this.handleOpenRule(I.C7.TRACE)(),onEditRule:this.handleOpenRule(I.C7.TRACE),disabled:a})]})}}function Kt(e){const t=(0,l.Z)();return(0,D.tZ)(i.Z,{features:["filters-and-sampling"],organization:t,renderDisabled:()=>(0,D.tZ)(a.Z,{alert:o.aU,features:["organization:filters-and-sampling"],featureName:(0,r.t)("Sampling")}),children:(0,D.tZ)(s.Z,{organization:t,access:["project:write"],children:n=>{let{hasAccess:s}=n;return(0,D.tZ)(Ht,{...e,hasAccess:s,organization:t})}})})}Kt.displayName="Index";const Qt=Kt},"../node_modules/lodash/_baseDifference.js":(e,t,n)=>{var s=n("../node_modules/lodash/_SetCache.js"),i=n("../node_modules/lodash/_arrayIncludes.js"),a=n("../node_modules/lodash/_arrayIncludesWith.js"),o=n("../node_modules/lodash/_arrayMap.js"),r=n("../node_modules/lodash/_baseUnary.js"),l=n("../node_modules/lodash/_cacheHas.js");e.exports=function(e,t,n,d){var c=-1,u=i,p=!0,g=e.length,m=[],h=t.length;if(!g)return m;n&&(t=o(t,r(n))),d?(u=a,p=!1):t.length>=200&&(u=l,p=!1,t=new s(t));e:for(;++c<g;){var E=e[c],_=null==n?E:n(E);if(E=d||0!==E?E:0,p&&_==_){for(var T=h;T--;)if(t[T]===_)continue e;m.push(E)}else u(t,_,d)||m.push(E)}return m}},"../node_modules/lodash/_baseIntersection.js":(e,t,n)=>{var s=n("../node_modules/lodash/_SetCache.js"),i=n("../node_modules/lodash/_arrayIncludes.js"),a=n("../node_modules/lodash/_arrayIncludesWith.js"),o=n("../node_modules/lodash/_arrayMap.js"),r=n("../node_modules/lodash/_baseUnary.js"),l=n("../node_modules/lodash/_cacheHas.js"),d=Math.min;e.exports=function(e,t,n){for(var c=n?a:i,u=e[0].length,p=e.length,g=p,m=Array(p),h=1/0,E=[];g--;){var _=e[g];g&&t&&(_=o(_,r(t))),h=d(_.length,h),m[g]=!n&&(t||u>=120&&_.length>=120)?new s(g&&_):void 0}_=e[0];var T=-1,y=m[0];e:for(;++T<u&&E.length<h;){var I=_[T],R=t?t(I):I;if(I=n||0!==I?I:0,!(y?l(y,R):c(E,R,n))){for(g=p;--g;){var N=m[g];if(!(N?l(N,R):c(e[g],R,n)))continue e}y&&y.push(R),E.push(I)}}return E}},"../node_modules/lodash/_baseXor.js":(e,t,n)=>{var s=n("../node_modules/lodash/_baseDifference.js"),i=n("../node_modules/lodash/_baseFlatten.js"),a=n("../node_modules/lodash/_baseUniq.js");e.exports=function(e,t,n){var o=e.length;if(o<2)return o?a(e[0]):[];for(var r=-1,l=Array(o);++r<o;)for(var d=e[r],c=-1;++c<o;)c!=r&&(l[r]=s(l[r]||d,e[c],t,n));return a(i(l,1),t,n)}},"../node_modules/lodash/_castArrayLikeObject.js":(e,t,n)=>{var s=n("../node_modules/lodash/isArrayLikeObject.js");e.exports=function(e){return s(e)?e:[]}},"../node_modules/lodash/intersection.js":(e,t,n)=>{var s=n("../node_modules/lodash/_arrayMap.js"),i=n("../node_modules/lodash/_baseIntersection.js"),a=n("../node_modules/lodash/_baseRest.js"),o=n("../node_modules/lodash/_castArrayLikeObject.js"),r=a((function(e){var t=s(e,o);return t.length&&t[0]===e[0]?i(t):[]}));e.exports=r},"../node_modules/lodash/xor.js":(e,t,n)=>{var s=n("../node_modules/lodash/_arrayFilter.js"),i=n("../node_modules/lodash/_baseRest.js"),a=n("../node_modules/lodash/_baseXor.js"),o=n("../node_modules/lodash/isArrayLikeObject.js"),r=i((function(e){return a(s(e,o))}));e.exports=r}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_project_sampling_index_tsx.d06a844193a41e8a16b67136f8110c65.js.map