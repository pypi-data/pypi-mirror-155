"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_landing_widgets_components_performanceWidget_tsx-app_views_performance_-1d625a"],{"./app/views/performance/landing/widgets/components/performanceWidget.tsx":(e,t,n)=>{n.d(t,{I:()=>V});var a=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),r=n("../node_modules/react-router/es/index.js"),s=n("./app/components/charts/errorPanel.tsx"),o=n("./app/components/placeholder.tsx"),d=n("./app/icons/iconWarning.tsx"),l=n("./app/styles/space.tsx"),c=n("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),p=n("./app/utils/getDynamicText.tsx"),m=(n("../node_modules/core-js/modules/es.array.includes.js"),n("./app/components/tag.tsx")),u=n("./app/locale.tsx"),g=n("./app/utils/useOrganization.tsx"),y=n("./app/views/performance/landing/widgets/utils.tsx"),h=n("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),Z=n("./app/utils/performance/contexts/utils.tsx"),x=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const[f,v]=(0,Z.n)({name:"MetricsEnhancedPerformanceDataContext"}),w=e=>{let{children:t,chartSetting:n}=e;const{setAutoSampleState:a}=(0,h.Eg)(),[r,s]=(0,i.useState)(void 0),o=(0,i.useCallback)((e=>{y.zS.includes(n)||(!0===e?a(h.nl.metrics):!1===e&&a(h.nl.transactions),s(e))}),[a,s]);return(0,x.tZ)(f,{value:{isMetricsData:r,setIsMetricsData:o},children:t})};w.displayName="MEPDataProvider";const b=v,S=()=>{const{isMetricsData:e}=b(),{metricSettingState:t}=(0,h.Eg)();return(0,g.Z)().features.includes("performance-use-metrics")?t===h.oR.auto&&!1===e?(0,x.tZ)(m.Z,{tooltipText:(0,u.t)("These search conditions are only applicable to sampled transaction data. To edit sampling rates, go to Filters & Sampling in settings."),"data-test-id":"has-metrics-data-tag",children:"Sampled"}):(0,x.tZ)("span",{"data-test-id":"no-metrics-data-tag"}):null};S.displayName="MEPTag";var D=n("./app/utils/useApi.tsx"),q=n("./app/components/panels/index.tsx");const j=(0,a.Z)(q.s_,{target:"e1evmidq1"})("padding-top:",(0,l.Z)(2),";margin-bottom:0;"),C=(0,a.Z)("div",{target:"e1evmidq0"})("");function P(e){return e.isErrored?e.errorComponent:e.isLoading&&e.loadingComponent?e.loadingComponent:e.hasData?(0,x.tZ)(i.Fragment,{children:e.dataComponents}):e.emptyComponent}P.displayName="DataStateSwitch",n("../node_modules/core-js/modules/es.string.replace.js");var _=n("./app/utils/dates.tsx");function k(e){var t;const n=null!==(t=e.children)&&void 0!==t?t:(0,x.tZ)(i.Fragment,{});return e.queries.length?(0,x.tZ)(i.Fragment,{children:e.queries.filter((t=>!t.enabled||t.enabled(e.widgetData))).map((t=>(0,x.tZ)(z,{...e,query:t},t.queryKey)))}):(0,x.tZ)(i.Fragment,{children:n})}function z(e){const t=e.query,n=e.queryProps.eventView.getPageFilters(),a=n.datetime.start?(0,_.hC)(n.datetime.start):null,r=n.datetime.end?(0,_.hC)(n.datetime.end):null;return(0,i.useEffect)((()=>()=>{e.removeWidgetDataForKey(t.queryKey)}),[]),(0,x.tZ)(t.component,{fields:t.fields,yAxis:t.fields,start:a,end:r,period:n.datetime.period,project:n.projects,environment:n.environments,organization:e.queryProps.organization,orgSlug:e.queryProps.organization.slug,eventView:e.queryProps.eventView,query:e.queryProps.eventView.getQueryWithAdditionalConditions(),widgetData:e.widgetData,referrer:(s=e.queryProps.chartSetting,`api.performance.generic-widget-chart.${s.replace(/_/g,"-")}`),children:n=>(0,x.tZ)(i.Fragment,{children:(0,x.tZ)(E,{results:n,...e,query:t})})},t.queryKey);var s}function E(e){const t=b(),{results:n,query:a}=e,r=a.transform(e.queryProps,n,e.query);return(0,i.useEffect)((()=>{var i,s;const o=null==n||null===(i=n.seriesAdditionalInfo)||void 0===i||null===(s=i[e.queryProps.fields[0]])||void 0===s?void 0:s.isMetricsData;t.setIsMetricsData(o),e.setWidgetDataForKey(a.queryKey,r)}),[null==r?void 0:r.hasData,null==r?void 0:r.isLoading,null==r?void 0:r.isErrored]),(0,x.tZ)(i.Fragment,{})}k.displayName="QueryHandler",z.displayName="SingleQueryHandler",E.displayName="QueryResultSaver";var F=n("./app/components/charts/styles.tsx"),N=n("./app/components/questionTooltip.tsx"),W=n("./app/components/textOverflow.tsx");function T(e){const{title:t,titleTooltip:n,Subtitle:a,HeaderActions:i}=e;return(0,x.BX)(I,{children:[(0,x.BX)(M,{children:[(0,x.BX)(K,{"data-test-id":"performance-widget-title",children:[(0,x.tZ)(W.Z,{children:t}),(0,x.tZ)(S,{}),(0,x.tZ)(N.Z,{position:"top",size:"sm",title:n})]}),a?(0,x.tZ)(a,{...e}):null]}),(0,x.tZ)(L,{children:i&&(0,x.tZ)(i,{...e})})]})}T.displayName="WidgetHeader";const K=(0,a.Z)(F.ws,{target:"evi51ay3"})({name:"ld8wu3",styles:"position:relative;z-index:initial"}),M=(0,a.Z)("div",{target:"evi51ay2"})({name:"6kz1wu",styles:"display:flex;flex-direction:column;align-items:flex-start"}),I=(0,a.Z)("div",{target:"evi51ay1"})("display:flex;justify-content:space-between;align-items:flex-start;gap:",(0,l.Z)(1),";"),L=(0,a.Z)("div",{target:"evi51ay0"})("display:flex;align-items:center;gap:",(0,l.Z)(1),";");function V(e){var t;const[n,a]=(0,i.useState)({}),r=null!==(t=n[e.chartSetting])&&void 0!==t?t:{},s=(0,i.useRef)(r),o=(0,i.useCallback)(((t,n)=>{const i={...s.current,[t]:n};s.current=i,a({[e.chartSetting]:i})}),[n,a]),d=(0,i.useCallback)((t=>{const n={...s.current};delete n[t],s.current=n,a({[e.chartSetting]:n})}),[n,a]),l={widgetData:r,setWidgetDataForKey:o,removeWidgetDataForKey:d},c=Object.entries(e.Queries).map((e=>{let[t,n]=e;return{...n,queryKey:t}})),p=(0,D.Z)(),m=e.Visualizations.reduce(((e,t)=>e+t.height),0);return(0,x.tZ)(i.Fragment,{children:(0,x.BX)(w,{chartSetting:e.chartSetting,children:[(0,x.tZ)(k,{eventView:e.eventView,widgetData:r,setWidgetDataForKey:o,removeWidgetDataForKey:d,queryProps:e,queries:c,api:p}),(0,x.tZ)(A,{...e,...l,totalHeight:m})]})})}function A(e){const{Visualizations:t,chartHeight:n,totalHeight:a,containerType:i,EmptyComponent:r}=e,s=(e=>{let{containerType:t}=e;return"panel"===t?j:C})({containerType:i}),d=Object.keys(e.Queries).length,l=Object.values(e.widgetData).length!==d,m=!l&&Object.values(e.widgetData).every((e=>!e||e.hasData)),u=Object.values(e.widgetData).some((e=>!e||e.isLoading)),g=!l&&Object.values(e.widgetData).some((e=>e&&e.isErrored));return(0,x.BX)(s,{"data-test-id":"performance-widget-container",children:[(0,x.tZ)(Q,{children:(0,x.tZ)(T,{...e})}),(0,x.tZ)(P,{isLoading:u,isErrored:g,hasData:m,errorComponent:(0,x.tZ)(H,{height:a}),dataComponents:t.map(((t,a)=>(0,x.tZ)(Q,{noPadding:t.noPadding,bottomPadding:t.bottomPadding,"data-test-id":"widget-state-has-data",onClick:()=>{return t=e.chartSetting,n=e.organization,void(0,c.Z)("performance_views.landingv3.widget.interaction",{organization:n,widget_type:t});var t,n},children:(0,p.Z)({value:(0,x.tZ)(t.component,{grid:O,queryFields:t.fields,widgetData:e.widgetData,height:n}),fixed:(0,x.tZ)(o.Z,{height:`${n}px`})})},a))),loadingComponent:(0,x.tZ)(B,{height:`${a}px`}),emptyComponent:r?(0,x.tZ)(r,{}):(0,x.tZ)(B,{height:`${a}px`})})]})}V.displayName="GenericPerformanceWidget",A.displayName="_DataDisplay",(0,r.withRouter)(A);const H=e=>(0,x.tZ)(s.Z,{"data-test-id":"widget-state-is-errored",height:`${e.height}px`,children:(0,x.tZ)(d.F,{color:"gray300",size:"lg"})});H.displayName="DefaultErrorComponent";const O={left:(0,l.Z)(0),right:(0,l.Z)(0),top:(0,l.Z)(2),bottom:(0,l.Z)(1)},Q=(0,a.Z)("div",{target:"eqcpc8s1"})("padding-left:",(e=>e.noPadding?(0,l.Z)(0):(0,l.Z)(2)),";padding-right:",(e=>e.noPadding?(0,l.Z)(0):(0,l.Z)(2)),";padding-bottom:",(e=>e.bottomPadding?(0,l.Z)(1):(0,l.Z)(0)),";"),B=(0,a.Z)(o.Z,{target:"eqcpc8s0"})({name:"cs3onb",styles:"border-color:transparent;border-bottom-right-radius:inherit;border-bottom-left-radius:inherit"});V.defaultProps={containerType:"panel",chartHeight:200}},"./app/views/performance/landing/widgets/components/selectableList.tsx":(e,t,n)=>{n.d(t,{Nm:()=>v,QE:()=>Z,S$:()=>h,ZP:()=>g,qL:()=>x,xq:()=>f});var a=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=n("./app/components/emptyStateWarning.tsx"),r=n("./app/components/forms/controls/radioGroup.tsx"),s=n("./app/components/links/link.tsx"),o=n("./app/components/radio.tsx"),d=n("./app/components/tooltip.tsx"),l=n("./app/icons/index.tsx"),c=n("./app/locale.tsx"),p=n("./app/styles/space.tsx"),m=n("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),u=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function g(e){return(0,u.tZ)("div",{children:e.items.map(((t,n)=>(0,m.az)(y,{...e,isSelected:n===e.selectedIndex,currentIndex:n,key:n},t())))})}function y(e){let{isSelected:t,currentIndex:n,children:a,setSelectedIndex:i,radioColor:s}=e;return(0,u.BX)(D,{children:[(0,u.tZ)(q,{color:null!=s?s:"",children:(0,u.tZ)(r.V,{index:n,role:"radio",children:(0,u.tZ)(o.Z,{checked:t,onChange:()=>i(n)})})}),a]})}g.displayName="SelectableList",y.displayName="SelectableItem";const h=(0,a.Z)("div",{target:"e1fgyx4u7"})("text-align:right;display:flex;align-items:center;justify-content:center;padding:0 ",(0,p.Z)(1),";"),Z=(0,a.Z)("span",{target:"e1fgyx4u6"})("color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeMedium),";display:inline-block;"),x=(0,a.Z)(s.Z,{target:"e1fgyx4u5"})({name:"pu304d",styles:"flex-grow:1;display:inherit"}),f=()=>(0,u.tZ)(S,{small:!0,children:(0,c.t)("No results")});function v(e){return(0,u.tZ)(w,{title:(0,c.t)("Exclude this transaction from the search filter."),children:(0,u.tZ)(b,{onClick:()=>{e.onClick(),e.setSelectListIndex(0)}})})}f.displayName="WidgetEmptyStateWarning",v.displayName="ListClose";const w=(0,a.Z)(d.Z,{target:"e1fgyx4u4"})({name:"1wnowod",styles:"display:flex;align-items:center;justify-content:center"}),b=(0,a.Z)(l.bM,{target:"e1fgyx4u3"})("cursor:pointer;color:",(e=>e.theme.gray200),";"),S=(0,a.Z)(i.Z,{target:"e1fgyx4u2"})({name:"1t1oqhu",styles:"min-height:300px;justify-content:center"}),D=(0,a.Z)("div",{target:"e1fgyx4u1"})("display:flex;border-top:1px solid ",(e=>e.theme.border),";padding:",(0,p.Z)(1)," ",(0,p.Z)(2),";font-size:",(e=>e.theme.fontSizeMedium),";"),q=(0,a.Z)("div",{target:"e1fgyx4u0"})("grid-row:1/3;input{cursor:pointer;}input:checked::after{background-color:",(e=>e.color),";}")}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_landing_widgets_components_performanceWidget_tsx-app_views_performance_-1d625a.870ccee5f2f6ee421f76217052343c00.js.map