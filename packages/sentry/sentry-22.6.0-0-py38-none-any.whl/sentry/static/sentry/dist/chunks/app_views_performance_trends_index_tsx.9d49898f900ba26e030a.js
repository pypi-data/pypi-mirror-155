"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_trends_index_tsx"],{"./app/views/performance/trends/index.tsx":(e,t,r)=>{r.r(t),r.d(t,{default:()=>W});var n=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/react/index.js")),i=r("./app/components/noProjectMessage.tsx"),a=r("./app/components/sentryDocumentTitle.tsx"),p=r("./app/locale.tsx"),l=r("./app/styles/organization.tsx"),d=r("./app/utils/withApi.tsx"),c=r("./app/utils/withOrganization.tsx"),h=r("./app/utils/withPageFilters.tsx"),m=r("./app/utils/withProjects.tsx"),u=r("./app/views/performance/data.tsx"),g=r("../node_modules/react-router/es/index.js"),Z=r("./app/components/alert.tsx"),f=r("./app/components/breadcrumbs.tsx"),y=r("./app/components/datePageFilter.tsx"),x=r("./app/components/dropdownControl.tsx"),w=r("./app/components/environmentPageFilter.tsx"),v=r("./app/components/events/searchBar.tsx"),b=r("./app/components/layouts/thirds.tsx"),P=r("./app/components/organizations/pageFilterBar.tsx"),j=r("./app/components/organizations/pageFilters/container.tsx"),_=r("./app/components/projectPageFilter.tsx"),T=r("./app/constants/index.tsx"),F=r("./app/styles/space.tsx"),C=r("./app/utils/analytics.tsx"),S=r("./app/utils/discover/fields.tsx"),q=r("./app/utils/queryString.tsx"),z=r("./app/utils/tokenizeSearch.tsx"),E=r("./app/views/performance/utils.tsx"),V=r("./app/views/performance/trends/changedTransactions.tsx"),k=r("./app/views/performance/trends/types.tsx"),D=r("./app/views/performance/trends/utils.tsx"),B=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const I={start:null,end:null,utc:!1,period:D._1};class O extends o.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{}),(0,n.Z)(this,"handleSearch",(e=>{const{location:t}=this.props,r=(0,D.Ws)();g.browserHistory.push({pathname:t.pathname,query:{...t.query,...r,query:String(e).trim()||void 0}})})),(0,n.Z)(this,"setError",(e=>{this.setState({error:e})})),(0,n.Z)(this,"handleTrendFunctionChange",(e=>{const{organization:t,location:r}=this.props,n={};Object.values(k.ER).forEach((e=>{const t=(0,D.j_)(e);n[t]=void 0})),(0,C.ec)({eventKey:"performance_views.trends.change_function",eventName:"Performance Views: Change Function",organization_id:parseInt(t.id,10),function_name:e}),this.setState({previousTrendFunction:(0,D.CE)(r).field});const s=(0,D.Ws)();g.browserHistory.push({pathname:r.pathname,query:{...r.query,...n,...s,trendFunction:e}})})),(0,n.Z)(this,"handleParameterChange",(e=>{const{organization:t,location:r}=this.props,n=(0,D.Ws)();(0,C.ec)({eventKey:"performance_views.trends.change_parameter",eventName:"Performance Views: Change Parameter",organization_id:parseInt(t.id,10),parameter_name:e}),g.browserHistory.push({pathname:r.pathname,query:{...r.query,...n,trendParameter:e}})}))}renderError(){const{error:e}=this.state;return e?(0,B.tZ)(Z.Z,{type:"error",showIcon:!0,children:e}):null}getPerformanceLink(){const{location:e}=this.props,t={...e.query},r=(0,q.ro)(e.query.query,""),n=new z.MY(r);return n.removeFilter("tpm()"),n.removeFilter("confidence()"),n.removeFilter("transaction.duration"),t.query=n.formatString(),{pathname:(0,E.de)(this.props.organization),query:t}}render(){const{organization:e,eventView:t,location:r,projects:n}=this.props,{previousTrendFunction:s}=this.state,o=t.clone();(0,D.iF)(o,r);const i=(0,S.db)(e,[{field:"absolute_correlation()"},{field:"trend_percentage()"},{field:"trend_difference()"},{field:"count_percentage()"},{field:"tpm()"},{field:"tps()"}],["epm()","eps()"]),a=(0,D.CE)(r),l=(0,D.IO)(r,n,t.project),d=(0,E.Ov)(r);return(0,B.BX)(j.Z,{defaultSelection:{datetime:I},hideGlobalHeader:!0,children:[(0,B.tZ)(b.h4,{children:(0,B.BX)(b.oB,{children:[(0,B.tZ)(f.Z,{crumbs:[{label:"Performance",to:this.getPerformanceLink()},{label:"Trends"}]}),(0,B.tZ)(b.Dx,{children:(0,p.t)("Trends")})]})}),(0,B.tZ)(b.uT,{children:(0,B.tZ)(b.or,{fullWidth:!0,children:(0,B.BX)(H,{location:r,eventView:t,projects:n,children:[(0,B.BX)(N,{children:[(0,B.BX)(P.Z,{condensed:!0,children:[(0,B.tZ)(_.Z,{}),(0,B.tZ)(w.Z,{}),(0,B.tZ)(y.Z,{alignDropdown:"left"})]}),(0,B.tZ)(R,{searchSource:"trends",organization:e,projectIds:o.project,query:d,fields:i,onSearch:this.handleSearch,maxQueryLength:T.dI}),(0,B.tZ)("div",{"data-test-id":"trends-dropdown",children:(0,B.tZ)(x.ZP,{buttonProps:{prefix:(0,p.t)("Percentile")},label:a.label,children:D.T1.map((e=>{let{label:t,field:r}=e;return(0,B.tZ)(x.hP,{onSelect:this.handleTrendFunctionChange,eventKey:r,"data-test-id":r,isActive:r===a.field,children:t},r)}))})}),(0,B.tZ)(x.ZP,{buttonProps:{prefix:(0,p.t)("Parameter")},label:l.label,children:D.cs.map((e=>{let{label:t}=e;return(0,B.tZ)(x.hP,{onSelect:this.handleParameterChange,eventKey:t,"data-test-id":t,isActive:t===l.label,children:t},t)}))})]}),(0,B.BX)(X,{children:[(0,B.tZ)(V.Z,{trendChangeType:k.ER.IMPROVED,previousTrendFunction:s,trendView:o,location:r,setError:this.setError}),(0,B.tZ)(V.Z,{trendChangeType:k.ER.REGRESSION,previousTrendFunction:s,trendView:o,location:r,setError:this.setError})]})]})})})]})}}O.displayName="TrendsContent";class H extends o.Component{constructor(){super(...arguments),(0,n.Z)(this,"hasPushedDefaults",!1)}render(){const{children:e,location:t,eventView:r,projects:n}=this.props,s=(0,q.ro)(t.query.query),i=(0,D.IO)(t,n,r.project),a=new z.MY(s||"");if(s||this.hasPushedDefaults)return this.hasPushedDefaults=!0,(0,B.tZ)(o.Fragment,{children:e});this.hasPushedDefaults=!0,a.setFilterValues("tpm()",[">0.01"]),a.setFilterValues(i.column,[">0",`<${D.bg}`]);const p=a.formatString();return r.query=p,g.browserHistory.push({pathname:t.pathname,query:{...t.query,cursor:void 0,query:String(p).trim()||void 0}}),null}}H.displayName="DefaultTrends";const N=(0,s.Z)("div",{target:"e1yf76wj2"})("display:grid;gap:",(0,F.Z)(2),";margin-bottom:",(0,F.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:repeat(3, min-content);}@media (min-width: ",(e=>e.theme.breakpoints.xlarge),"){grid-template-columns:auto 1fr auto auto;}"),R=(0,s.Z)(v.Z,{target:"e1yf76wj1"})("@media (min-width: ",(e=>e.theme.breakpoints.small),"){order:1;grid-column:1/5;}@media (min-width: ",(e=>e.theme.breakpoints.xlarge),"){order:initial;grid-column:auto;}"),X=(0,s.Z)("div",{target:"e1yf76wj0"})("display:grid;gap:",(0,F.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:repeat(2, minmax(0, 1fr));}"),K=(0,h.Z)(O);class M extends o.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{eventView:(0,u.C)(this.props.location,this.props.projects,{isTrends:!0}),error:void 0}),(0,n.Z)(this,"setError",(e=>{this.setState({error:e})}))}static getDerivedStateFromProps(e,t){return{...t,eventView:(0,u.C)(e.location,e.projects,{isTrends:!0})}}getDocumentTitle(){return[(0,p.t)("Trends"),(0,p.t)("Performance")].join(" - ")}renderContent(){const{organization:e,location:t,projects:r}=this.props,{eventView:n}=this.state;return(0,B.tZ)(K,{organization:e,location:t,eventView:n,projects:r})}render(){const{organization:e}=this.props;return(0,B.tZ)(a.Z,{title:this.getDocumentTitle(),orgSlug:e.slug,children:(0,B.tZ)(A,{children:(0,B.tZ)(i.Z,{organization:e,children:this.renderContent()})})})}}M.displayName="TrendsSummary";const W=(0,c.Z)((0,m.Z)((0,h.Z)((0,d.Z)(M)))),A=(0,s.Z)(l.JH,{target:"e183k9ay0"})({name:"1hcx8jb",styles:"padding:0"})}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_trends_index_tsx.4e9b9a7e64b3dda4272baf924bee94f7.js.map