"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_organizationDeveloperSettings_sentryApplicationDashboard_index_tsx"],{"./app/components/charts/lineChart.tsx":(e,t,n)=>{n.d(t,{w:()=>i});var s=n("./app/components/charts/series/lineSeries.tsx"),r=n("./app/components/charts/baseChart.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{series:t,seriesOptions:n,...i}=e;return(0,a.tZ)(r.Z,{...i,series:t.map((e=>{let{seriesName:t,data:r,dataArray:a,...i}=e;return(0,s.Z)({...n,...i,name:t,data:a||(null==r?void 0:r.map((e=>{let{value:t,name:n}=e;return[n,t]}))),animation:!1,animationThreshold:1,animationDuration:0})}))})}i.displayName="LineChart"},"./app/views/asyncView.tsx":(e,t,n)=>{n.d(t,{Z:()=>i});var s=n("./app/components/asyncComponent.tsx"),r=n("./app/components/sentryDocumentTitle.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class i extends s.Z{getTitle(){return""}render(){return(0,a.tZ)(r.Z,{title:this.getTitle(),children:this.renderComponent()})}}i.displayName="AsyncView"},"./app/views/settings/organizationDeveloperSettings/sentryApplicationDashboard/index.tsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>U});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=n("../node_modules/react/index.js"),a=n("./app/components/charts/barChart.tsx"),i=n("./app/components/charts/lineChart.tsx"),o=n("./app/components/dateTime.tsx"),l=n("./app/components/links/link.tsx"),d=n("./app/components/panels/index.tsx"),c=n("./app/locale.tsx"),p=n("./app/styles/space.tsx"),h=n("./app/views/asyncView.tsx"),u=n("./app/views/settings/components/settingsPageHeader.tsx"),m=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),g=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/lodash/memoize.js")),Z=n.n(g),y=n("./app/components/asyncComponent.tsx"),x=n("./app/components/button.tsx"),v=n("./app/components/checkbox.tsx"),b=n("./app/components/dropdownButton.tsx"),k=n("./app/components/dropdownControl.tsx"),w=n("./app/components/links/externalLink.tsx"),f=n("./app/components/loadingIndicator.tsx"),P=n("./app/components/tag.tsx"),z=n("./app/icons/index.tsx"),_=n("./app/utils/dates.tsx"),C=n("./app/views/settings/components/emptyMessage.tsx"),B=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const T=(0,c.t)("All Events"),j=(0,_.gn)(),I=Z()((e=>{let t=[];const n=(e.schema.elements||[]).find((e=>"issue-link"===e.type));return n&&(t=["external_issue.created","external_issue.linked"],(e=>{const t=e=>e.some((e=>"select"===e.type&&"uri"in e)),n=t(e.create.required_fields)||t(e.create.optional_fields||[]),s=t(e.link.required_fields)||t(e.link.optional_fields||[]);return n||s})(n)&&t.push("select_options.requested")),[T,..."internal"!==e.status?["installation.created","installation.deleted"]:[],...e.events.includes("error")?["error.created"]:[],...e.events.includes("issue")?["issue.created","issue.resolved","issue.ignored","issue.assigned"]:[],...e.isAlertable?["event_alert.triggered","metric_alert.open","metric_alert.resolved","metric_alert.critical","metric_alert.warning"]:[],...t]})),O=e=>{let{code:t}=e,n="error";return t<=399&&t>=300?n="warning":t<=299&&t>=100&&(n="success"),(0,B.tZ)(M,{children:(0,B.tZ)(H,{type:n,children:0===t?"timeout":t})})};O.displayName="ResponseCode";const X=e=>{let{date:t,link:n}=e;return n?(0,B.BX)(w.Z,{href:n,children:[(0,B.tZ)(o.Z,{date:t}),(0,B.tZ)(L,{size:"12px"})]}):(0,B.tZ)(o.Z,{date:t,format:j?"MMM D, YYYY HH:mm:ss z":"ll LTS z"})};class D extends y.Z{constructor(){super(...arguments),(0,m.Z)(this,"shouldReload",!0),(0,m.Z)(this,"handleChangeEventType",(e=>{this.setState({eventType:e,currentPage:0},this.remountComponent)})),(0,m.Z)(this,"handleChangeErrorsOnly",(()=>{this.setState({errorsOnly:!this.state.errorsOnly,currentPage:0},this.remountComponent)})),(0,m.Z)(this,"handleNextPage",(()=>{this.setState({currentPage:this.state.currentPage+1})})),(0,m.Z)(this,"handlePrevPage",(()=>{this.setState({currentPage:this.state.currentPage-1})}))}get hasNextPage(){return 10*(this.state.currentPage+1)<this.state.requests.length}get hasPrevPage(){return this.state.currentPage>0}getEndpoints(){const{slug:e}=this.props.app,t={};return this.state&&(this.state.eventType!==T&&(t.eventType=this.state.eventType),this.state.errorsOnly&&(t.errorsOnly=!0)),[["requests",`/sentry-apps/${e}/requests/`,{query:t}]]}getDefaultState(){return{...super.getDefaultState(),requests:[],eventType:T,errorsOnly:!1,currentPage:0}}renderLoading(){return this.renderBody()}renderBody(){const{requests:e,eventType:t,errorsOnly:n,currentPage:s}=this.state,{app:a}=this.props,i=e.slice(10*s,10*(s+1));return(0,B.BX)(r.Fragment,{children:[(0,B.tZ)("h5",{children:(0,c.t)("Request Log")}),(0,B.BX)("div",{children:[(0,B.tZ)("p",{children:(0,c.t)("This log shows the status of any outgoing webhook requests from Sentry to your integration.")}),(0,B.BX)(V,{children:[(0,B.tZ)(k.ZP,{label:t,menuWidth:"220px",button:e=>{let{isOpen:n,getActorProps:s}=e;return(0,B.tZ)(A,{...s(),isOpen:n,children:t})},children:I(a).map((e=>(0,B.tZ)(k.hP,{onSelect:this.handleChangeEventType,eventKey:e,isActive:t===e,children:e},e)))}),(0,B.tZ)($,{onClick:this.handleChangeErrorsOnly,children:(0,B.BX)(E,{children:[(0,B.tZ)(v.Z,{checked:n,onChange:()=>{}}),(0,c.t)("Errors Only")]})})]})]}),(0,B.BX)(d.s_,{children:[(0,B.tZ)(d.V9,{children:(0,B.BX)(N,{hasOrganization:"internal"!==a.status,children:[(0,B.tZ)("div",{children:(0,c.t)("Time")}),(0,B.tZ)("div",{children:(0,c.t)("Status Code")}),"internal"!==a.status&&(0,B.tZ)("div",{children:(0,c.t)("Organization")}),(0,B.tZ)("div",{children:(0,c.t)("Event Type")}),(0,B.tZ)("div",{children:(0,c.t)("Webhook URL")})]})}),this.state.loading?(0,B.tZ)(f.Z,{}):(0,B.tZ)(d.N,{children:i.length>0?i.map(((e,t)=>(0,B.tZ)(d.Lv,{children:(0,B.BX)(N,{hasOrganization:"internal"!==a.status,children:[(0,B.tZ)(X,{date:e.date,link:e.errorUrl}),(0,B.tZ)(O,{code:e.responseCode}),"internal"!==a.status&&(0,B.tZ)("div",{children:e.organization?e.organization.name:null}),(0,B.tZ)("div",{children:e.eventType}),(0,B.tZ)(S,{children:e.webhookUrl})]})},t))):(0,B.tZ)(C.Z,{icon:(0,B.tZ)(z.Gy,{size:"xl"}),children:(0,c.t)("No requests found in the last 30 days.")})})]}),(0,B.BX)(q,{children:[(0,B.tZ)(x.ZP,{icon:(0,B.tZ)(z.g6,{direction:"left",size:"sm"}),onClick:this.handlePrevPage,disabled:!this.hasPrevPage,"aria-label":(0,c.t)("Previous page")}),(0,B.tZ)(x.ZP,{icon:(0,B.tZ)(z.g6,{direction:"right",size:"sm"}),onClick:this.handleNextPage,disabled:!this.hasNextPage,"aria-label":(0,c.t)("Next page")})]})]})}}const N=(0,s.Z)("div",{target:"ev8k1zo9"})("display:grid;grid-template-columns:1fr 0.5fr ",(e=>e.hasOrganization?"1fr":"")," 1fr 1fr;grid-column-gap:",(0,p.Z)(1.5),";width:100%;align-items:center;"),S=(0,s.Z)("div",{target:"ev8k1zo8"})({name:"1sdjnkx",styles:"word-break:break-word"}),q=(0,s.Z)("div",{target:"ev8k1zo7"})({name:"6izmta",styles:"display:flex;justify-content:flex-end;align-items:center;>:first-child{border-top-right-radius:0;border-bottom-right-radius:0;}>:nth-child(2){margin-left:-1px;border-top-left-radius:0;border-bottom-left-radius:0;}"}),V=(0,s.Z)("div",{target:"ev8k1zo6"})("display:flex;align-items:center;padding-bottom:",(0,p.Z)(1),";"),E=(0,s.Z)("div",{target:"ev8k1zo5"})("input{margin:0 ",(0,p.Z)(1)," 0 0;}display:flex;align-items:center;"),A=(0,s.Z)(b.Z,{target:"ev8k1zo4"})("z-index:",(e=>e.theme.zIndex.header-1),";white-space:nowrap;border-top-right-radius:0;border-bottom-right-radius:0;"),$=(0,s.Z)(x.ZP,{target:"ev8k1zo3"})({name:"9aiwao",styles:"margin-left:-1px;border-top-left-radius:0;border-bottom-left-radius:0"}),L=(0,s.Z)(z.V$,{target:"ev8k1zo2"})("margin-left:6px;color:",(e=>e.theme.subText),";"),M=(0,s.Z)("div",{target:"ev8k1zo1"})("margin:-",(0,p.Z)(.5),";"),H=(0,s.Z)(P.Z,{target:"ev8k1zo0"})("padding:",(0,p.Z)(.5),";display:inline-flex;");class U extends h.Z{getEndpoints(){const{appSlug:e}=this.props.params,t=Math.floor((new Date).getTime()/1e3),n=7776e3;return[["stats",`/sentry-apps/${e}/stats/`,{query:{since:t-n,until:t}}],["interactions",`/sentry-apps/${e}/interaction/`,{query:{since:t-n,until:t}}],["app",`/sentry-apps/${e}/`]]}getTitle(){return(0,c.t)("Integration Dashboard")}renderInstallData(){const{app:e,stats:t}=this.state,{totalUninstalls:n,totalInstalls:s}=t;return(0,B.BX)(r.Fragment,{children:[(0,B.tZ)("h5",{children:(0,c.t)("Installation & Interaction Data")}),(0,B.BX)(Y,{children:[e.datePublished?(0,B.BX)(F,{children:[(0,B.tZ)(G,{children:(0,c.t)("Date published")}),(0,B.tZ)(o.Z,{dateOnly:!0,date:e.datePublished})]}):null,(0,B.BX)(F,{children:[(0,B.tZ)(G,{children:(0,c.t)("Total installs")}),(0,B.tZ)("p",{children:s})]}),(0,B.BX)(F,{children:[(0,B.tZ)(G,{children:(0,c.t)("Total uninstalls")}),(0,B.tZ)("p",{children:n})]})]}),this.renderInstallCharts()]})}renderInstallCharts(){const{installStats:e,uninstallStats:t}=this.state.stats,n={data:e.map((e=>({name:1e3*e[0],value:e[1]}))),seriesName:(0,c.t)("installed")},s={data:t.map((e=>({name:1e3*e[0],value:e[1]}))),seriesName:(0,c.t)("uninstalled")};return(0,B.BX)(d.s_,{children:[(0,B.tZ)(d.V9,{children:(0,c.t)("Installations/Uninstallations over Last 90 Days")}),(0,B.tZ)(K,{children:(0,B.tZ)(a.v,{series:[n,s],height:150,stacked:!0,isGroupedByDate:!0,legend:{show:!0,orient:"horizontal",data:["installed","uninstalled"],itemWidth:15},yAxis:{type:"value",minInterval:1,max:"dataMax"},xAxis:{type:"time"},grid:{left:(0,p.Z)(4),right:(0,p.Z)(4)}})})]})}renderIntegrationViews(){const{views:e}=this.state.interactions,{appSlug:t,orgId:n}=this.props.params;return(0,B.BX)(d.s_,{children:[(0,B.tZ)(d.V9,{children:(0,c.t)("Integration Views")}),(0,B.tZ)(d.N,{children:(0,B.tZ)(R,{data:{Views:e}})}),(0,B.tZ)(d.jH,{children:(0,B.BX)(W,{children:[(0,c.t)("Integration views are measured through views on the "),(0,B.tZ)(l.Z,{to:`/sentry-apps/${t}/external-install/`,children:(0,c.t)("external installation page")}),(0,c.t)(" and views on the Learn More/Install modal on the "),(0,B.tZ)(l.Z,{to:`/settings/${n}/integrations/`,children:(0,c.t)("integrations page")})]})})]})}renderComponentInteractions(){const{componentInteractions:e}=this.state.interactions,t={"stacktrace-link":(0,c.t)("Each link click or context menu open counts as one interaction"),"issue-link":(0,c.t)("Each open of the issue link modal counts as one interaction")};return(0,B.BX)(d.s_,{children:[(0,B.tZ)(d.V9,{children:(0,c.t)("Component Interactions")}),(0,B.tZ)(d.N,{children:(0,B.tZ)(R,{data:e})}),(0,B.tZ)(d.jH,{children:(0,B.tZ)(W,{children:Object.keys(e).map(((e,n)=>t[e]&&(0,B.BX)(r.Fragment,{children:[(0,B.tZ)("strong",{children:`${e}: `}),t[e],(0,B.tZ)("br",{})]},n)))})})]})}renderBody(){const{app:e}=this.state;return(0,B.BX)("div",{children:[(0,B.tZ)(u.Z,{title:`${(0,c.t)("Integration Dashboard")} - ${e.name}`}),"published"===e.status&&this.renderInstallData(),"published"===e.status&&this.renderIntegrationViews(),e.schema.elements&&this.renderComponentInteractions(),(0,B.tZ)(D,{app:e})]})}}const R=e=>{let{data:t}=e;const n=Object.keys(t).map((e=>({seriesName:e,data:t[e].map((e=>({value:e[1],name:1e3*e[0]})))})));return(0,B.tZ)(K,{children:(0,B.tZ)(i.w,{isGroupedByDate:!0,series:n,grid:{left:(0,p.Z)(4),right:(0,p.Z)(4)},legend:{show:!0,orient:"horizontal",data:Object.keys(t)}})})};R.displayName="InteractionsChart";const Y=(0,s.Z)("div",{target:"e1b7k1wi4"})({name:"zjik7",styles:"display:flex"}),F=(0,s.Z)("div",{target:"e1b7k1wi3"})("margin-right:",(0,p.Z)(4),";"),G=(0,s.Z)("h6",{target:"e1b7k1wi2"})("margin-bottom:",(0,p.Z)(1),";font-size:12px;text-transform:uppercase;color:",(e=>e.theme.subText),";"),W=(0,s.Z)("div",{target:"e1b7k1wi1"})("padding:",(0,p.Z)(1.5),";"),K=(0,s.Z)("div",{target:"e1b7k1wi0"})("padding-top:",(0,p.Z)(3),";")}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationDeveloperSettings_sentryApplicationDashboard_index_tsx.6fc7d7eaa6c910f8f3697df34c030d1e.js.map