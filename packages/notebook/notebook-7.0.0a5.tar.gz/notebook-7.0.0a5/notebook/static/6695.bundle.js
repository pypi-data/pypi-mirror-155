"use strict";(self.webpackChunk_JUPYTERLAB_CORE_OUTPUT=self.webpackChunk_JUPYTERLAB_CORE_OUTPUT||[]).push([[6695],{66695:(e,t,s)=>{s.r(t),s.d(t,{AttachmentsCell:()=>ue,AttachmentsCellModel:()=>F,Cell:()=>le,CellDragUtils:()=>l,CellFooter:()=>y,CellHeader:()=>C,CellModel:()=>N,CellSearchProvider:()=>$,CodeCell:()=>he,CodeCellModel:()=>R,Collapser:()=>p,InputArea:()=>x,InputCollapser:()=>m,InputPlaceholder:()=>T,InputPrompt:()=>f,MarkdownCell:()=>ce,MarkdownCellModel:()=>B,OutputCollapser:()=>g,OutputPlaceholder:()=>z,Placeholder:()=>U,RawCell:()=>pe,RawCellModel:()=>W,SELECTED_HIGHLIGHT_CLASS:()=>Q,createCellSearchProvider:()=>X,isCodeCellModel:()=>k,isMarkdownCellModel:()=>A,isRawCellModel:()=>H});var i=s(81734),n=s(96158);const a="jp-dragImage",r="jp-dragImage-content",o="jp-dragImage-prompt",d="jp-dragImage-multipleBack";var l;!function(e){e.findCell=function(e,t,s){let n=-1;for(;e&&e.parentElement;){if(s(e)){(0,i.each)(t,((t,s)=>{if(t.node===e)return n=s,!1}));break}e=e.parentElement}return n},e.detectTargetArea=function(e,t){let s;return s=e?e.editorWidget.node.contains(t)?"input":e.promptNode.contains(t)?"prompt":"cell":"unknown",s},e.shouldStartDrag=function(e,t,s,i){const n=Math.abs(s-e),a=Math.abs(i-t);return n>=5||a>=5},e.createCellDragImage=function(e,t){const s=t.length;let i;if("code"===e.model.type){const t=e.model.executionCount;i=" ",t&&(i=t.toString())}else i="";const l=e.model.value.text.split("\n")[0].slice(0,26);return s>1?""!==i?n.VirtualDOM.realize(n.h.div(n.h.div({className:a},n.h.span({className:o},"["+i+"]:"),n.h.span({className:r},l)),n.h.div({className:d},""))):n.VirtualDOM.realize(n.h.div(n.h.div({className:a},n.h.span({className:o}),n.h.span({className:r},l)),n.h.div({className:d},""))):""!==i?n.VirtualDOM.realize(n.h.div(n.h.div({className:"jp-dragImage jp-dragImage-singlePrompt"},n.h.span({className:o},"["+i+"]:"),n.h.span({className:r},l)))):n.VirtualDOM.realize(n.h.div(n.h.div({className:"jp-dragImage jp-dragImage-singlePrompt"},n.h.span({className:o}),n.h.span({className:r},l))))}}(l||(l={}));var h=s(43306),u=s(32480),c=s(72245);class p extends h.ReactWidget{constructor(){super(),this.addClass("jp-Collapser")}get collapsed(){return!1}render(){return c.createElement("div",{className:"jp-Collapser-child",onClick:e=>this.handleClick(e)})}}class m extends p{constructor(){super(),this.addClass("jp-InputCollapser")}get collapsed(){var e;const t=null===(e=this.parent)||void 0===e?void 0:e.parent;return!!t&&t.inputHidden}handleClick(e){var t;const s=null===(t=this.parent)||void 0===t?void 0:t.parent;s&&(s.inputHidden=!s.inputHidden),this.update()}}class g extends p{constructor(){super(),this.addClass("jp-OutputCollapser")}get collapsed(){var e;const t=null===(e=this.parent)||void 0===e?void 0:e.parent;return!!t&&t.outputHidden}handleClick(e){var t,s;const i=null===(t=this.parent)||void 0===t?void 0:t.parent;if(i&&(i.outputHidden=!i.outputHidden,i.outputHidden)){let e=null===(s=i.parent)||void 0===s?void 0:s.node;e&&u.ElementExt.scrollIntoViewIfNeeded(e,i.node)}this.update()}}var _=s(59985);class C extends _.Widget{constructor(){super(),this.addClass("jp-CellHeader")}}class y extends _.Widget{constructor(){super(),this.addClass("jp-CellFooter")}}var v=s(38957),w=s(32853);class x extends _.Widget{constructor(e){super(),this.addClass("jp-InputArea");const t=this.model=e.model,s=this.contentFactory=e.contentFactory||x.defaultContentFactory,i=this._prompt=s.createInputPrompt();i.addClass("jp-InputArea-prompt");const n={model:t,factory:s.editorFactory,updateOnShow:e.updateOnShow},a=this._editor=new v.CodeEditorWrapper(n);a.addClass("jp-InputArea-editor");const r=this.layout=new _.PanelLayout;r.addWidget(i),e.placeholder||r.addWidget(a)}get editorWidget(){return this._editor}get editor(){return this._editor.editor}get promptNode(){return this._prompt.node}get renderedInput(){return this._rendered}renderInput(e){const t=this.layout;this._rendered&&(this._rendered.parent=null),this._editor.hide(),this._rendered=e,t.addWidget(e)}showEditor(){this._rendered&&(this._rendered.parent=null),this._editor.show()}setPrompt(e){this._prompt.executionCount=e}dispose(){this.isDisposed||(this._prompt=null,this._editor=null,this._rendered=null,super.dispose())}}!function(e){class t{constructor(t={}){this._editor=t.editorFactory||e.defaultEditorFactory}get editorFactory(){return this._editor}createInputPrompt(){return new f}}e.ContentFactory=t,e.defaultEditorFactory=(new w.CodeMirrorEditorFactory).newInlineEditor,e.defaultContentFactory=new t({})}(x||(x={}));class f extends _.Widget{constructor(){super(),this._executionCount=null,this.addClass("jp-InputPrompt")}get executionCount(){return this._executionCount}set executionCount(e){this._executionCount=e,this.node.textContent=null===e?" ":`[${e||" "}]:`}}var O=s(74547),P=s(58646),S=s(60887),b=s(38186);class I{constructor(e={}){if(this._map=new S.ObservableMap,this._isDisposed=!1,this._stateChanged=new P.Signal(this),this._changed=new P.Signal(this),this._modelDB=null,this._serialized=null,this._changeGuard=!1,this.contentFactory=e.contentFactory||I.defaultContentFactory,e.values)for(const t of Object.keys(e.values))void 0!==e.values[t]&&this.set(t,e.values[t]);this._map.changed.connect(this._onMapChanged,this),e.modelDB&&(this._modelDB=e.modelDB,this._serialized=this._modelDB.createValue("attachments"),this._serialized.get()?this.fromJSON(this._serialized.get()):this._serialized.set(this.toJSON()),this._serialized.changed.connect(this._onSerializedChanged,this))}get stateChanged(){return this._stateChanged}get changed(){return this._changed}get keys(){return this._map.keys()}get length(){return this._map.keys().length}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,this._map.dispose(),P.Signal.clearData(this))}has(e){return this._map.has(e)}get(e){return this._map.get(e)}set(e,t){const s=this._createItem({value:t});this._map.set(e,s)}remove(e){this._map.delete(e)}clear(){this._map.values().forEach((e=>{e.dispose()})),this._map.clear()}fromJSON(e){this.clear(),Object.keys(e).forEach((t=>{void 0!==e[t]&&this.set(t,e[t])}))}toJSON(){const e={};for(const t of this._map.keys())e[t]=this._map.get(t).toJSON();return e}_createItem(e){const t=this.contentFactory.createAttachmentModel(e);return t.changed.connect(this._onGenericChange,this),t}_onMapChanged(e,t){this._serialized&&!this._changeGuard&&(this._changeGuard=!0,this._serialized.set(this.toJSON()),this._changeGuard=!1),this._changed.emit(t),this._stateChanged.emit(void 0)}_onSerializedChanged(e,t){this._changeGuard||(this._changeGuard=!0,this.fromJSON(t.newValue),this._changeGuard=!1)}_onGenericChange(){this._stateChanged.emit(void 0)}}!function(e){class t{createAttachmentModel(e){return new b.AttachmentModel(e)}}e.ContentFactory=t,e.defaultContentFactory=new t}(I||(I={}));class D{constructor(e){this._parent=e.parent||null,this._model=e.model}async resolveUrl(e){return this._parent&&!e.startsWith("attachment:")?this._parent.resolveUrl(e):e}async getDownloadUrl(e){if(this._parent&&!e.startsWith("attachment:"))return this._parent.getDownloadUrl(e);const t=e.slice("attachment:".length),s=this._model.get(t);if(void 0===s)return e;const{data:i}=s,n=Object.keys(i)[0];if(void 0===n||-1===b.imageRendererFactory.mimeTypes.indexOf(n))throw new Error(`Cannot render unknown image mime type "${n}".`);return`data:${n};base64,${i[n]}`}isLocal(e){var t,s,i;return!(this._parent&&!e.startsWith("attachment:"))||null===(i=null===(s=(t=this._parent).isLocal)||void 0===s?void 0:s.call(t,e))||void 0===i||i}}var M=s(14620),E=s(83831);const j=M.createMutex();function k(e){return"code"===e.type}function A(e){return"markdown"===e.type}function H(e){return"raw"===e.type}class N extends v.CodeEditor.Model{constructor(e){var t;super({modelDB:e.modelDB,id:e.id||(null===(t=e.cell)||void 0===t?void 0:t.id)||O.UUID.uuid4()}),this.contentChanged=new P.Signal(this),this.stateChanged=new P.Signal(this),this.value.changed.connect(this.onGenericChange,this),this.modelDB.createValue("type").set(this.type);const s=this.modelDB.createMap("metadata");s.changed.connect(this.onModelDBMetadataChange,this),s.changed.connect(this.onGenericChange,this);const i=e.cell,n=this.modelDB.createValue("trusted");if(n.changed.connect(this.onTrustedChanged,this),!i)return void n.set(!1);n.set(!!i.metadata.trusted),delete i.metadata.trusted,Array.isArray(i.source)?this.value.text=i.source.map((e=>e.replace(/\r\n/g,"\n").replace(/\r/g,"\n"))).join(""):this.value.text=i.source.replace(/\r\n/g,"\n").replace(/\r/g,"\n");const a=O.JSONExt.deepCopy(i.metadata);"raw"!==this.type&&delete a.format,"code"!==this.type&&(delete a.collapsed,delete a.scrolled);for(const e in a)s.set(e,a[e])}get type(){return"raw"}get id(){return this.sharedModel.getId()}get metadata(){return this.modelDB.get("metadata")}get trusted(){return this.modelDB.getValue("trusted")}set trusted(e){this.trusted!==e&&this.modelDB.setValue("trusted",e)}toJSON(){const e=Object.create(null);for(const t of this.metadata.keys()){const s=JSON.parse(JSON.stringify(this.metadata.get(t)));e[t]=s}return this.trusted&&(e.trusted=!0),{cell_type:this.type,source:this.value.text,metadata:e}}onTrustedChanged(e,t){}switchSharedModel(e,t){if(t){const t=e.getMetadata();t&&this._updateModelDBMetadata(t)}super.switchSharedModel(e,t)}onModelDBMetadataChange(e,t){const s=this.sharedModel.getMetadata();j((()=>{switch(t.type){case"add":case"change":this._changeCellMetadata(s,t);break;case"remove":delete s[t.key];break;default:throw new Error(`Invalid event type: ${t.type}`)}this.sharedModel.setMetadata(s)}))}_changeCellMetadata(e,t){switch(t.key){case"jupyter":e.jupyter=t.newValue;break;case"collapsed":e.collapsed=t.newValue;break;case"name":e.name=t.newValue;break;case"scrolled":e.scrolled=t.newValue;break;case"tags":e.tags=t.newValue;break;case"trusted":e.trusted=t.newValue;break;default:e[t.key]=t.newValue}}_onSharedModelChanged(e,t){super._onSharedModelChanged(e,t),j((()=>{var e;if(t.metadataChange){const s=null===(e=t.metadataChange)||void 0===e?void 0:e.newValue;s&&this._updateModelDBMetadata(s)}}))}_updateModelDBMetadata(e){Object.keys(e).map((t=>{switch(t){case"collapsed":this.metadata.set("collapsed",e.jupyter);break;case"jupyter":this.metadata.set("jupyter",e.jupyter);break;case"name":this.metadata.set("name",e.name);break;case"scrolled":this.metadata.set("scrolled",e.scrolled);break;case"tags":this.metadata.set("tags",e.tags);break;case"trusted":this.metadata.set("trusted",e.trusted);break;default:this.metadata.set(t,e[t])}}))}onGenericChange(){this.contentChanged.emit(void 0)}}class F extends N{constructor(e){super(e);const t=e.contentFactory||F.defaultContentFactory;let s;const i=e.cell;!i||"raw"!==i.cell_type&&"markdown"!==i.cell_type||(s=i.attachments),this._attachments=t.createAttachmentsModel({values:s,modelDB:this.modelDB}),this._attachments.stateChanged.connect(this.onGenericChange,this)}get attachments(){return this._attachments}toJSON(){const e=super.toJSON();return this.attachments.length&&(e.attachments=this.attachments.toJSON()),e}}!function(e){class t{createAttachmentsModel(e){return new I(e)}}e.ContentFactory=t,e.defaultContentFactory=new t}(F||(F={}));class W extends F{get type(){return"raw"}toJSON(){const e=super.toJSON();return e.id=this.id,e}}class B extends F{constructor(e){super(e),this.mimeType="text/x-ipythongfm"}get type(){return"markdown"}toJSON(){const e=super.toJSON();return e.id=this.id,e}}class R extends N{constructor(e){var t;super(e),this._executedCode="",this._isDirty=!1;const s=e.contentFactory||R.defaultContentFactory,i=this.trusted,n=e.cell;let a=[];const r=this.modelDB.createValue("executionCount");if(n&&"code"===n.cell_type?(r.set(n.execution_count||null),a=null!==(t=n.outputs)&&void 0!==t?t:[],j((()=>{this.sharedModel.execution_count=n.execution_count,this.sharedModel.setOutputs(a)})),null!==n.execution_count&&(this._executedCode=this.value.text.trim())):(r.set(this.sharedModel.execution_count),a=this.sharedModel.getOutputs()),this.value.changed.connect(this._onValueChanged,this),r.changed.connect(this._onExecutionCountChanged,this),this._outputs=s.createOutputArea({trusted:i,values:a}),this._outputs.changed.connect(this.onGenericChange,this),this._outputs.changed.connect(this.onModelDBOutputsChange,this),this.metadata.changed.connect(V.collapseChanged,this),this.metadata.has("collapsed")){const e=this.metadata.get("collapsed");V.collapseChanged(this.metadata,{type:"change",key:"collapsed",oldValue:e,newValue:e})}else if(this.metadata.has("jupyter")){const e=this.metadata.get("jupyter");e.hasOwnProperty("outputs_hidden")&&V.collapseChanged(this.metadata,{type:"change",key:"jupyter",oldValue:e,newValue:e})}}switchSharedModel(e,t){t&&(this.executionCount=e.execution_count,this.outputs.clear(),e.getOutputs().forEach((e=>this._outputs.add(e)))),super.switchSharedModel(e,t),this._setDirty(!1)}get type(){return"code"}get executionCount(){return this.modelDB.has("executionCount")?this.modelDB.getValue("executionCount"):null}set executionCount(e){e!==this.executionCount&&this.modelDB.setValue("executionCount",e||null)}get isDirty(){return this._isDirty}_setDirty(e){e!==this._isDirty&&(e||(this._executedCode=this.value.text.trim()),this._isDirty=e,this.stateChanged.emit({name:"isDirty",oldValue:!e,newValue:e}))}clearExecution(){this.outputs.clear(),this.executionCount=null,this._setDirty(!1),this.metadata.delete("execution")}get outputs(){return this._outputs}dispose(){this.isDisposed||(this._outputs.dispose(),this._outputs=null,super.dispose())}toJSON(){const e=super.toJSON();return e.execution_count=this.executionCount||null,e.outputs=this.outputs.toJSON(),e.id=this.id,e}onTrustedChanged(e,t){this._outputs&&(this._outputs.trusted=t.newValue),this.stateChanged.emit({name:"trusted",oldValue:t.oldValue,newValue:t.newValue})}onModelDBOutputsChange(e,t){const s=this.sharedModel;j((()=>{switch(t.type){case"add":{const e=t.newValues.map((e=>e.toJSON()));s.updateOutputs(t.newIndex,t.newIndex+e.length,e);break}case"set":{const e=t.newValues.map((e=>e.toJSON()));s.updateOutputs(t.oldIndex,t.oldIndex+e.length,e);break}case"remove":s.updateOutputs(t.oldIndex,t.oldValues.length);break;default:throw new Error(`Invalid event type: ${t.type}`)}}))}_onValueChanged(){null!==this.executionCount&&this._setDirty(this._executedCode!==this.value.text.trim())}_onSharedModelChanged(e,t){super._onSharedModelChanged(e,t),j((()=>{t.outputsChange&&(this.clearExecution(),e.getOutputs().forEach((e=>this._outputs.add(e)))),t.executionCountChange&&(this.executionCount=t.executionCountChange.newValue?t.executionCountChange.newValue:null)}))}_onExecutionCountChanged(e,t){const s=this.sharedModel;j((()=>{s.execution_count=t.newValue?t.newValue:null})),this.contentChanged.emit(void 0),this.stateChanged.emit({name:"executionCount",oldValue:t.oldValue,newValue:t.newValue}),t.newValue&&this.isDirty&&this._setDirty(!1)}}var V;!function(e){class t{createOutputArea(e){return new E.OutputAreaModel(e)}}e.ContentFactory=t,e.defaultContentFactory=new t}(R||(R={})),function(e){e.collapseChanged=function(e,t){if("collapsed"===t.key){const s=e.get("jupyter")||{},{outputs_hidden:i}=s,n=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(s[i[n]]=e[i[n]])}return s}(s,["outputs_hidden"]);i!==t.newValue&&(void 0!==t.newValue&&(n.outputs_hidden=t.newValue),0===Object.keys(n).length?e.delete("jupyter"):e.set("jupyter",n))}else if("jupyter"===t.key){const s=t.newValue||{};s.hasOwnProperty("outputs_hidden")?e.set("collapsed",s.outputs_hidden):e.delete("collapsed")}}}(V||(V={}));const L="jp-Placeholder-content";class U extends h.ReactWidget{constructor(e){super(),this.addClass("jp-Placeholder"),this._callback=e}handleClick(e){(0,this._callback)(e)}}class T extends U{constructor(e){super(e),this.addClass("jp-InputPlaceholder")}render(){return[c.createElement("div",{className:"jp-Placeholder-prompt jp-InputPrompt",key:"input"}),c.createElement("div",{className:L,onClick:e=>this.handleClick(e),key:"content"},c.createElement(h.ellipsesIcon.react,{className:"jp-MoreHorizIcon",elementPosition:"center",height:"auto",width:"32px"}))]}}class z extends U{constructor(e){super(e),this.addClass("jp-OutputPlaceholder")}render(){return[c.createElement("div",{className:"jp-Placeholder-prompt jp-OutputPrompt",key:"output"}),c.createElement("div",{className:L,onClick:e=>this.handleClick(e),key:"content"},c.createElement(h.ellipsesIcon.react,{className:"jp-MoreHorizIcon",elementPosition:"center",height:"auto",width:"32px"}))]}}var J=s(87859);const Q="jp-mod-selected";class ${constructor(e){this.cell=e,this.currentIndex=null,this.query=null,this._isActive=!0,this._isDisposed=!1,this._lastReplacementPosition=null,this.currentIndex=null,this._stateChanged=new P.Signal(this),this.cmHandler=new w.CodeMirrorSearchHighlighter(this.cell.editor)}get stateChanged(){return this._stateChanged}get currentMatchIndex(){return this.isActive?this.currentIndex:null}get isActive(){return this._isActive}get isDisposed(){return this._isDisposed}get matchesCount(){return this.isActive?this.cmHandler.matches.length:0}clearHighlight(){return this.currentIndex=null,this.cmHandler.clearHighlight(),Promise.resolve()}dispose(){this._isDisposed||(this._isDisposed=!0,P.Signal.clearData(this),this.isActive&&this.endQuery().catch((e=>{console.error("Failed to end search query on cells.",e)})))}async setIsActive(e){this._isActive!==e&&(this._isActive=e),this._isActive?null!==this.query&&await this.startQuery(this.query,this.filters):await this.endQuery()}async startQuery(e,t){this.query=e,this.filters=t;const s=this.cell.model.modelDB.get("value");await this._updateCodeMirror(s),s.changed.connect(this.onInputChanged,this)}async endQuery(){await this.cmHandler.endQuery(),this.currentIndex=null}async highlightNext(){if(0!==this.matchesCount&&this.isActive){this._lastReplacementPosition&&(this.cell.editor.setCursorPosition(this._lastReplacementPosition),this._lastReplacementPosition=null);let e=await this.cmHandler.highlightNext();return this.currentIndex=e?this.cmHandler.currentIndex:null,e}return this.currentIndex=null,Promise.resolve(this.getCurrentMatch())}async highlightPrevious(){if(0!==this.matchesCount&&this.isActive){let e=await this.cmHandler.highlightPrevious();return this.currentIndex=e?this.cmHandler.currentIndex:null,e}return this.currentIndex=null,Promise.resolve(this.getCurrentMatch())}replaceCurrentMatch(e){if(!this.isActive)return Promise.resolve(!1);let t=!1;if(null!==this.currentIndex&&this.currentIndex<this.cmHandler.matches.length){const s=this.cell.editor,i=s.doc.getSelection(),n=this.getCurrentMatch();i!==(null==n?void 0:n.text)?this.currentIndex=null:(this.cmHandler.matches.splice(this.currentIndex,1),this.currentIndex=null,this._lastReplacementPosition=s.getCursorPosition(),this.cell.model.value.text=this.cell.model.value.text.slice(0,n.position)+e+this.cell.model.value.text.slice(n.position+n.text.length),t=!0)}return Promise.resolve(t)}replaceAllMatches(e){if(!this.isActive)return Promise.resolve(!1);let t=this.cmHandler.matches.length>0,s=this.cell.model.value.text,i=0;const n=this.cmHandler.matches.reduce(((t,n)=>{const a=n.position,r=a+n.text.length,o=`${t}${s.slice(i,a)}${e}`;return i=r,o}),"");return t&&(this.cmHandler.matches=[],this.currentIndex=null,this.cell.model.value.text=`${n}${s.slice(i)}`),Promise.resolve(t)}getCurrentMatch(){if(null!==this.currentIndex){let e;return this.currentIndex<this.cmHandler.matches.length&&(e=this.cmHandler.matches[this.currentIndex]),e}}async onInputChanged(e,t){await this._updateCodeMirror(e),this._stateChanged.emit()}async _updateCodeMirror(e){null!==this.query&&(this.isActive?this.cmHandler.matches=await J.TextSearchEngine.search(this.query,e.text):this.cmHandler.matches=[])}}class G extends ${constructor(e){super(e),this.currentProviderIndex=-1,this.outputsProvider=[];const t=this.cell.outputArea;this._onOutputsChanged(t,t.widgets.length).catch((e=>{console.error("Failed to initialize search on cell outputs.",e)})),t.outputLengthChanged.connect(this._onOutputsChanged,this),t.disposed.connect((()=>{t.outputLengthChanged.disconnect(this._onOutputsChanged)}),this)}get matchesCount(){return this.isActive?super.matchesCount+this.outputsProvider.reduce(((e,t)=>{var s;return e+(null!==(s=t.matchesCount)&&void 0!==s?s:0)}),0):0}async clearHighlight(){await super.clearHighlight(),await Promise.all(this.outputsProvider.map((e=>e.clearHighlight())))}dispose(){this.isDisposed||(super.dispose(),this.outputsProvider.map((e=>{e.dispose()})),this.outputsProvider.length=0)}async highlightNext(){if(0!==this.matchesCount&&this.isActive){if(-1===this.currentProviderIndex){const e=await super.highlightNext();if(e)return this.currentIndex=this.cmHandler.currentIndex,e;this.currentProviderIndex=0}for(;this.currentProviderIndex<this.outputsProvider.length;){const e=this.outputsProvider[this.currentProviderIndex],t=await e.highlightNext(!1);if(t)return this.currentIndex=super.matchesCount+this.outputsProvider.slice(0,this.currentProviderIndex).reduce(((e,t)=>{var s;return e+(null!==(s=t.matchesCount)&&void 0!==s?s:0)}),0)+e.currentMatchIndex,t;this.currentProviderIndex+=1}return this.currentProviderIndex=-1,void(this.currentIndex=null)}this.currentIndex=null}async highlightPrevious(){if(0!==this.matchesCount&&this.isActive){for(null===this.currentIndex&&(this.currentProviderIndex=this.outputsProvider.length-1);this.currentProviderIndex>=0;){const e=this.outputsProvider[this.currentProviderIndex],t=await e.highlightPrevious(!1);if(t)return this.currentIndex=super.matchesCount+this.outputsProvider.slice(0,this.currentProviderIndex).reduce(((e,t)=>{var s;return e+(null!==(s=t.matchesCount)&&void 0!==s?s:0)}),0)+e.currentMatchIndex,t;this.currentProviderIndex-=1}const e=await super.highlightPrevious();return e?(this.currentIndex=this.cmHandler.currentIndex,e):void(this.currentIndex=null)}this.currentIndex=null}async startQuery(e,t){await super.startQuery(e,t),!1!==(null==t?void 0:t.output)&&this.isActive&&await Promise.all(this.outputsProvider.map((t=>t.startQuery(e))))}async endQuery(){var e;await super.endQuery(),!1!==(null===(e=this.filters)||void 0===e?void 0:e.output)&&this.isActive&&await Promise.all(this.outputsProvider.map((e=>e.endQuery())))}async _onOutputsChanged(e,t){var s;this.outputsProvider.forEach((e=>{e.dispose()})),this.outputsProvider.length=0,this.currentProviderIndex=-1,this.outputsProvider=this.cell.outputArea.widgets.map((e=>new J.GenericSearchProvider(e))),this.isActive&&this.query&&!1!==(null===(s=this.filters)||void 0===s?void 0:s.output)&&await Promise.all([this.outputsProvider.map((e=>{e.startQuery(this.query)}))]),this._stateChanged.emit()}}class q extends ${constructor(e){super(e),this._unrenderedByHighligh=!1,this.renderedProvider=new J.GenericSearchProvider(e.renderer)}async clearHighlight(){await super.clearHighlight(),await this.renderedProvider.clearHighlight()}dispose(){this.isDisposed||(super.dispose(),this.renderedProvider.dispose())}async endQuery(){await super.endQuery(),await this.renderedProvider.endQuery()}async highlightNext(){let e;if(!this.isActive)return e;const t=this.cell;return t.rendered&&this.matchesCount>0&&(this._unrenderedByHighligh=!0,t.rendered=!1),e=await super.highlightNext(),e}async highlightPrevious(){let e;const t=this.cell;return t.rendered&&this.matchesCount>0&&(this._unrenderedByHighligh=!0,t.rendered=!1),e=await super.highlightPrevious(),e}async startQuery(e,t){await super.startQuery(e,t);const s=this.cell;s.rendered&&this.onRenderedChanged(s,s.rendered),s.renderedChanged.connect(this.onRenderedChanged,this)}async replaceAllMatches(e){const t=await super.replaceAllMatches(e);return this.cell.rendered&&this.cell.update(),t}onRenderedChanged(e,t){this._unrenderedByHighligh||(this.currentIndex=null),this._unrenderedByHighligh=!1,this.isActive&&(t?this.renderedProvider.startQuery(this.query):(e.editor.setCursorPosition({column:0,line:0}),this.renderedProvider.endQuery()))}}function X(e){if(e.isPlaceholder())return new $(e);switch(e.model.type){case"code":return new G(e);case"markdown":return new q(e);default:return new $(e)}}var Y=s(50354),K=s(52082),Z=s(96936),ee=s(6814);const te="jp-mod-resizedCell";class se extends _.Widget{constructor(e){super(),this.targetNode=e,this._isActive=!1,this._isDragging=!1,this._protectedWidth=10,this.addClass("jp-CellResizeHandle")}onAfterAttach(e){super.onAfterAttach(e),this.node.addEventListener("dblclick",this),this.node.addEventListener("mousedown",this)}onAfterDetach(e){super.onAfterAttach(e),this.node.removeEventListener("dblclick",this),this.node.removeEventListener("mousedown",this)}handleEvent(e){var t,s;switch(e.type){case"dblclick":null===(t=this.targetNode.parentNode)||void 0===t||t.childNodes.forEach((e=>{e.classList.remove(te)})),document.documentElement.style.setProperty("--jp-side-by-side-resized-cell",""),this._isActive=!1;break;case"mousedown":this._mouseOffset=e.clientX-this.node.getBoundingClientRect().x,this._isDragging=!0,this._isActive||(null===(s=this.targetNode.parentNode)||void 0===s||s.childNodes.forEach((e=>{e.classList.add(te)})),this._isActive=!0),window.addEventListener("mousemove",this),window.addEventListener("mouseup",this);break;case"mousemove":{if(!this._isActive||!this._isDragging)return;const t=this.targetNode.getBoundingClientRect(),s=e.clientX-t.x-this._mouseOffset,i=1-Math.min(Math.max(s,this._protectedWidth),t.width-this._protectedWidth)/(t.width-this._protectedWidth);Math.round(100*i)%10==0&&document.documentElement.style.setProperty("--jp-side-by-side-resized-cell",i+"fr");break}case"mouseup":this._isDragging=!1,window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this)}}}const ie="jp-mod-dirty",ne="jp-MarkdownHeadingCollapsed",ae="jp-collapseHeadingButton",re="jp-mod-rendered",oe="jp-mod-noOutputs",de="application/x-jupyter-icontentsrich";class le extends _.Widget{constructor(e){var t;super(),this._displayChanged=new P.Signal(this),this._readOnly=!1,this._inputHidden=!1,this._isPlaceholder=!1,this._syncCollapse=!1,this._syncEditable=!1,this._resizeDebouncer=new ee.Debouncer((()=>{this._displayChanged.emit()}),0),this.addClass("jp-Cell");const s=this._model=e.model,i=this.contentFactory=e.contentFactory||le.defaultContentFactory;this.layout=new _.PanelLayout,this.translator=e.translator||Z.nullTranslator;const n=i.createCellHeader();n.addClass("jp-Cell-header"),this.layout.addWidget(n);const a=this._inputWrapper=new _.Panel;a.addClass("jp-Cell-inputWrapper");const r=new m;r.addClass("jp-Cell-inputCollapser");const o=this._input=new x({model:s,contentFactory:i,updateOnShow:e.updateEditorOnShow,placeholder:e.placeholder});o.addClass("jp-Cell-inputArea"),a.addWidget(r),a.addWidget(o),this.layout.addWidget(a),this._inputPlaceholder=new T((()=>{this.inputHidden=!this.inputHidden}));const d=this.contentFactory.createCellFooter();d.addClass("jp-Cell-footer"),this.layout.addWidget(d),this._isPlaceholder=null!==(t=e.placeholder)&&void 0!==t&&t,e.editorConfig&&this.editor.setOptions(Object.assign({},e.editorConfig)),s.metadata.changed.connect(this.onMetadataChanged,this)}initializeState(){return this.loadCollapseState(),this.loadEditableState(),this}get displayChanged(){return this._displayChanged}get promptNode(){return this._inputHidden?this._inputPlaceholder.node.firstElementChild:this._input.promptNode}get editorWidget(){return this._input.editorWidget}get editor(){return this._input.editor}get model(){return this._model}get inputArea(){return this._input}get readOnly(){return this._readOnly}set readOnly(e){e!==this._readOnly&&(this._readOnly=e,this.syncEditable&&this.saveEditableState(),this.update())}isPlaceholder(){return this._isPlaceholder}saveEditableState(){const{metadata:e}=this.model,t=e.get("editable");this.readOnly&&!1===t||!this.readOnly&&void 0===t||(this.readOnly?this.model.metadata.set("editable",!1):this.model.metadata.delete("editable"))}loadEditableState(){this.readOnly=!1===this.model.metadata.get("editable")}get ready(){return Promise.resolve(void 0)}setPrompt(e){this._input.setPrompt(e)}get inputHidden(){return this._inputHidden}set inputHidden(e){if(this._inputHidden===e)return;const t=this._inputWrapper.layout;e?(this._input.parent=null,t.addWidget(this._inputPlaceholder)):(this._inputPlaceholder.parent=null,t.addWidget(this._input)),this._inputHidden=e,this.syncCollapse&&this.saveCollapseState(),this.handleInputHidden(e)}saveCollapseState(){const e=Object.assign({},this.model.metadata.get("jupyter"));this.inputHidden&&!0===e.source_hidden||!this.inputHidden&&void 0===e.source_hidden||(this.inputHidden?e.source_hidden=!0:delete e.source_hidden,0===Object.keys(e).length?this.model.metadata.delete("jupyter"):this.model.metadata.set("jupyter",e))}loadCollapseState(){const e=this.model.metadata.get("jupyter")||{};this.inputHidden=!!e.source_hidden}handleInputHidden(e){}get syncCollapse(){return this._syncCollapse}set syncCollapse(e){this._syncCollapse!==e&&(this._syncCollapse=e,e&&this.loadCollapseState())}get syncEditable(){return this._syncEditable}set syncEditable(e){this._syncEditable!==e&&(this._syncEditable=e,e&&this.loadEditableState())}clone(){return new(0,this.constructor)({model:this.model,contentFactory:this.contentFactory,placeholder:!1,translator:this.translator})}dispose(){this.isDisposed||(this._input=null,this._model=null,this._inputWrapper=null,this._inputPlaceholder=null,super.dispose())}onAfterAttach(e){this.update()}onActivateRequest(e){this.editor.focus()}onFitRequest(e){this.editor.refresh()}onResize(e){this._resizeDebouncer.invoke()}onUpdateRequest(e){this._model&&this.editor.getOption("readOnly")!==this._readOnly&&(this.editor.setOption("readOnly",this._readOnly),this.toggleClass("jp-mod-readOnly",this._readOnly))}onMetadataChanged(e,t){switch(t.key){case"jupyter":this.syncCollapse&&this.loadCollapseState();break;case"editable":this.syncEditable&&this.loadEditableState()}}}!function(e){class t{constructor(e={}){this._editorFactory=e.editorFactory||x.defaultEditorFactory}get editorFactory(){return this._editorFactory}createCellHeader(){return new C}createCellFooter(){return new y}createInputPrompt(){return new f}createOutputPrompt(){return new E.OutputPrompt}createStdin(e){return new E.Stdin(e)}}e.ContentFactory=t,e.defaultContentFactory=new t}(le||(le={}));class he extends le{constructor(e){super(e),this._outputHidden=!1,this._syncScrolled=!1,this._savingMetadata=!1,this.addClass("jp-CodeCell");const t=this.translator.load("jupyterlab"),s=this._rendermime=e.rendermime,i=this.contentFactory,n=this.model;let a=t.__("Code Cell Content with Output");if(!e.placeholder){const r=this._outputWrapper=new _.Panel;r.addClass("jp-Cell-outputWrapper");const o=new g;o.addClass("jp-Cell-outputCollapser");const d=this._output=new E.OutputArea({model:n.outputs,rendermime:s,contentFactory:i,maxNumberOutputs:e.maxNumberOutputs});d.addClass("jp-Cell-outputArea"),0===n.outputs.length&&(this.addClass(oe),a=t.__("Code Cell Content")),d.outputLengthChanged.connect(this._outputLengthHandler,this),r.addWidget(o),r.addWidget(d),this.layout.insertWidget(2,new se(this.node)),this.layout.insertWidget(3,r),n.isDirty&&this.addClass(ie),this._outputPlaceholder=new z((()=>{this.outputHidden=!this.outputHidden}))}n.stateChanged.connect(this.onStateChanged,this),this.node.setAttribute("aria-label",a)}initializeState(){return super.initializeState(),this.loadScrolledState(),this.setPrompt(`${this.model.executionCount||""}`),this}get outputArea(){return this._output}get outputHidden(){return this._outputHidden}set outputHidden(e){if(this._outputHidden===e)return;const t=this._outputWrapper.layout;e?(t.removeWidget(this._output),t.addWidget(this._outputPlaceholder),this.inputHidden&&!this._outputWrapper.isHidden&&this._outputWrapper.hide()):(this._outputWrapper.isHidden&&this._outputWrapper.show(),t.removeWidget(this._outputPlaceholder),t.addWidget(this._output)),this._outputHidden=e,this.syncCollapse&&this.saveCollapseState()}saveCollapseState(){this._savingMetadata=!0;try{super.saveCollapseState();const e=this.model.metadata,t=this.model.metadata.get("collapsed");if(this.outputHidden&&!0===t||!this.outputHidden&&void 0===t)return;this.outputHidden?e.set("collapsed",!0):e.delete("collapsed")}finally{this._savingMetadata=!1}}loadCollapseState(){super.loadCollapseState(),this.outputHidden=!!this.model.metadata.get("collapsed")}get outputsScrolled(){return this._outputsScrolled}set outputsScrolled(e){this.toggleClass("jp-mod-outputsScrolled",e),this._outputsScrolled=e,this.syncScrolled&&this.saveScrolledState()}saveScrolledState(){const{metadata:e}=this.model,t=e.get("scrolled");this.outputsScrolled&&!0===t||!this.outputsScrolled&&void 0===t||(this.outputsScrolled?e.set("scrolled",!0):e.delete("scrolled"))}loadScrolledState(){const e=this.model.metadata;"auto"===e.get("scrolled")?this.outputsScrolled=!1:this.outputsScrolled=!!e.get("scrolled")}get syncScrolled(){return this._syncScrolled}set syncScrolled(e){this._syncScrolled!==e&&(this._syncScrolled=e,e&&this.loadScrolledState())}handleInputHidden(e){!e&&this._outputWrapper.isHidden?this._outputWrapper.show():e&&!this._outputWrapper.isHidden&&this._outputHidden&&this._outputWrapper.hide()}clone(){return new(0,this.constructor)({model:this.model,contentFactory:this.contentFactory,rendermime:this._rendermime,placeholder:!1,translator:this.translator})}cloneOutputArea(){return new E.SimplifiedOutputArea({model:this.model.outputs,contentFactory:this.contentFactory,rendermime:this._rendermime})}dispose(){this.isDisposed||(this._output.outputLengthChanged.disconnect(this._outputLengthHandler,this),this._rendermime=null,this._output=null,this._outputWrapper=null,this._outputPlaceholder=null,super.dispose())}onStateChanged(e,t){switch(t.name){case"executionCount":this.setPrompt(`${e.executionCount||""}`);break;case"isDirty":e.isDirty?this.addClass(ie):this.removeClass(ie)}}onMetadataChanged(e,t){if(!this._savingMetadata){switch(t.key){case"scrolled":this.syncScrolled&&this.loadScrolledState();break;case"collapsed":this.syncCollapse&&this.loadCollapseState()}super.onMetadataChanged(e,t)}}_outputLengthHandler(e,t){const s=0===t;this.toggleClass(oe,s);const i=this.translator.load("jupyterlab"),n=s?i.__("Code Cell Content"):i.__("Code Cell Content with Output");this.node.setAttribute("aria-label",n)}}!function(e){e.execute=async function(e,t,s){var i;const n=e.model,a=n.value.text;if(!a.trim()||!(null===(i=t.session)||void 0===i?void 0:i.kernel))return void n.clearExecution();const r={cellId:n.id};s=Object.assign(Object.assign(Object.assign({},n.metadata.toJSON()),s),r);const{recordTiming:o}=s;let d;n.clearExecution(),e.outputHidden=!1,e.setPrompt("*"),n.trusted=!0;try{const i=E.OutputArea.execute(a,e.outputArea,t,s);if(o){const t=e=>{let t;switch(e.header.msg_type){case"status":t=`status.${e.content.execution_state}`;break;case"execute_input":t="execute_input";break;default:return!0}const s=e.header.date||(new Date).toISOString(),i=Object.assign({},n.metadata.get("execution"));return i[`iopub.${t}`]=s,n.metadata.set("execution",i),!0};e.outputArea.future.registerMessageHook(t)}else n.metadata.delete("execution");d=e.outputArea.future;const r=await i;if(n.executionCount=r.content.execution_count,o){const e=Object.assign({},n.metadata.get("execution")),t=r.metadata.started;t&&(e["shell.execute_reply.started"]=t);const s=r.header.date;e["shell.execute_reply"]=s||(new Date).toISOString(),n.metadata.set("execution",e)}return r}catch(t){throw d&&!e.isDisposed&&e.outputArea.future===d&&e.setPrompt(""),t}}}(he||(he={}));class ue extends le{handleEvent(e){switch(e.type){case"paste":this._evtPaste(e);break;case"dragenter":case"dragover":e.preventDefault();break;case"drop":this._evtNativeDrop(e);break;case"lm-dragover":this._evtDragOver(e);break;case"lm-drop":this._evtDrop(e)}}onAfterAttach(e){super.onAfterAttach(e);const t=this.node;t.addEventListener("lm-dragover",this),t.addEventListener("lm-drop",this),t.addEventListener("dragenter",this),t.addEventListener("dragover",this),t.addEventListener("drop",this),t.addEventListener("paste",this)}onBeforeDetach(e){const t=this.node;t.removeEventListener("drop",this),t.removeEventListener("dragover",this),t.removeEventListener("dragenter",this),t.removeEventListener("paste",this),t.removeEventListener("lm-dragover",this),t.removeEventListener("lm-drop",this)}_evtDragOver(e){(0,i.some)(b.imageRendererFactory.mimeTypes,(t=>!!e.mimeData.hasData(de)&&e.mimeData.getData(de).model.mimetype===t))&&(e.preventDefault(),e.stopPropagation(),e.dropAction=e.proposedAction)}_evtPaste(e){if(e.clipboardData){const t=e.clipboardData.items;for(let s=0;s<t.length;s++){if("text/plain"===t[s].type){if(s<t.length-1&&"file"===t[s+1].kind)continue;t[s].getAsString((e=>{var t,s;null===(s=(t=this.editor).replaceSelection)||void 0===s||s.call(t,e)}))}this._attachFiles(e.clipboardData.items)}}e.preventDefault()}_evtNativeDrop(e){e.dataTransfer&&this._attachFiles(e.dataTransfer.items),e.preventDefault()}_evtDrop(e){const t=(0,i.toArray)((0,i.filter)(e.mimeData.types(),(t=>{if(t===de){const t=e.mimeData.getData(de);return-1!==b.imageRendererFactory.mimeTypes.indexOf(t.model.mimetype)}return-1!==b.imageRendererFactory.mimeTypes.indexOf(t)})));if(0!==t.length)if(e.preventDefault(),e.stopPropagation(),"none"!==e.proposedAction){e.dropAction="copy";for(const s of t)if(s===de){const{model:t,withContent:s}=e.mimeData.getData(de);if("file"===t.type){const e=this._generateURI(t.name);this.updateCellSourceWithAttachment(t.name,e),s().then((t=>{this.model.attachments.set(e,{[t.mimetype]:t.content})}))}}else{const t=this._generateURI();this.model.attachments.set(t,{[s]:e.mimeData.getData(s)}),this.updateCellSourceWithAttachment(t,t)}}else e.dropAction="none"}_attachFiles(e){for(let t=0;t<e.length;t++){const s=e[t];if("file"===s.kind){const e=s.getAsFile();e&&this._attachFile(e)}}}_attachFile(e){const t=new FileReader;t.onload=s=>{const{href:i,protocol:n}=Y.URLExt.parse(t.result);if("data:"!==n)return;const a=/([\w+\/\+]+)?(?:;(charset=[\w\d-]*|base64))?,(.*)/.exec(i);if(!a||4!==a.length)return;const r=a[1],o={[r]:a[3]},d=this._generateURI(e.name);r.startsWith("image/")&&(this.model.attachments.set(d,o),this.updateCellSourceWithAttachment(e.name,d))},t.onerror=t=>{console.error(`Failed to attach ${e.name}`+t)},t.readAsDataURL(e)}_generateURI(e=""){const t=e.lastIndexOf(".");return-1!==t?O.UUID.uuid4().concat(e.substring(t)):O.UUID.uuid4()}}class ce extends ue{constructor(e){var t,s,i;super(e),this._headingCollapsedChanged=new P.Signal(this),this._rendered=!0,this._renderedChanged=new P.Signal(this),this._prevText="",this._ready=new O.PromiseDelegate,this._showEditorForReadOnlyMarkdown=!0,this.addClass("jp-MarkdownCell");const n=this.translator.load("jupyterlab");this.node.setAttribute("aria-label",n.__("Markdown Cell Content")),this._rendermime=e.rendermime.clone({resolver:new D({parent:null!==(t=e.rendermime.resolver)&&void 0!==t?t:void 0,model:this.model.attachments})}),this._renderer=this._rendermime.createRenderer("text/markdown"),this._renderer.addClass("jp-MarkdownOutput"),this.editor.setOption("handlePaste",!1),this._headingCollapsed=null!==(s=this.model.metadata.get(ne))&&void 0!==s&&s,this._monitor=new Y.ActivityMonitor({signal:this.model.contentChanged,timeout:1e3}),this._monitor.activityStopped.connect((()=>{this._rendered&&this.update()}),this),this._updateRenderedInput().then((()=>{this._ready.resolve(void 0)})),this.renderCollapseButtons(this._renderer),this.renderInput(this._renderer),this._showEditorForReadOnlyMarkdown=null!==(i=e.showEditorForReadOnlyMarkdown)&&void 0!==i?i:ce.defaultShowEditorForReadOnlyMarkdown}get ready(){return this._ready.promise}get headingInfo(){const e=K.TableOfContentsUtils.Markdown.getHeadings(this.model.value.text,{maximalDepth:6,numberHeaders:!1});if(e.length>0){const{text:t,level:s}=e.reduce(((e,t)=>e.level<=t.level?e:t),e[0]);return{text:t,level:s}}return{text:"",level:-1}}get headingCollapsed(){return this._headingCollapsed}set headingCollapsed(e){if(this._headingCollapsed!==e){this._headingCollapsed=e,e?this.model.metadata.set(ne,e):this.model.metadata.has(ne)&&this.model.metadata.delete(ne);const t=this.inputArea.promptNode.getElementsByClassName(ae)[0];t&&(e?t.classList.add("jp-mod-collapsed"):t.classList.remove("jp-mod-collapsed")),this.renderCollapseButtons(this._renderer),this._headingCollapsedChanged.emit(this._headingCollapsed)}}get numberChildNodes(){return this._numberChildNodes}set numberChildNodes(e){this._numberChildNodes=e,this.renderCollapseButtons(this._renderer)}get headingCollapsedChanged(){return this._headingCollapsedChanged}get rendered(){return this._rendered}set rendered(e){this.readOnly&&!1===this._showEditorForReadOnlyMarkdown&&(e=!0),e!==this._rendered&&(this._rendered=e,this._handleRendered(),this._rendered||this.editor.refresh(),this._displayChanged.emit(),this._renderedChanged.emit(this._rendered))}get renderedChanged(){return this._renderedChanged}get showEditorForReadOnly(){return this._showEditorForReadOnlyMarkdown}set showEditorForReadOnly(e){this._showEditorForReadOnlyMarkdown=e,!1===e&&(this.rendered=!0)}get renderer(){return this._renderer}maybeCreateCollapseButton(){if(this.headingInfo.level>0&&0==this.inputArea.promptNode.getElementsByClassName(ae).length){let e=this.inputArea.promptNode.appendChild(document.createElement("button"));e.className="jp-Button jp-collapseHeadingButton",e.setAttribute("data-heading-level",this.headingInfo.level.toString()),this._headingCollapsed?e.classList.add("jp-mod-collapsed"):e.classList.remove("jp-mod-collapsed"),e.onclick=e=>{this.headingCollapsed=!this.headingCollapsed}}}maybeCreateOrUpdateExpandButton(){const e=this.node.getElementsByClassName("jp-showHiddenCellsButton");let t=this.translator.load("jupyterlab")._n("%1 cell hidden","%1 cells hidden",this._numberChildNodes);if(this.headingCollapsed&&this._numberChildNodes>0&&0==e.length){const e=document.createElement("button");e.className="jp-mod-minimal jp-Button jp-showHiddenCellsButton",h.addIcon.render(e);const s=document.createElement("div");s.textContent=t,e.appendChild(s),e.onclick=()=>{this.headingCollapsed=!1},this.node.appendChild(e)}if(this.headingCollapsed&&this._numberChildNodes>0&&1==e.length&&(e[0].childNodes[1].textContent=t),!(this.headingCollapsed&&this._numberChildNodes>0))for(const t of e)this.node.removeChild(t)}renderCollapseButtons(e){this.node.classList.toggle(ne,this._headingCollapsed),this.maybeCreateCollapseButton(),this.maybeCreateOrUpdateExpandButton()}renderInput(e){this.addClass(re),this.renderCollapseButtons(e),this.inputArea.renderInput(e)}showEditor(){this.removeClass(re),this.inputArea.showEditor();let e=(this.model.value.text.match(/^#+/g)||[""])[0].length;e>0&&this.inputArea.editor.setCursorPosition({column:e+1,line:0})}onUpdateRequest(e){this._handleRendered(),super.onUpdateRequest(e)}updateCellSourceWithAttachment(e,t){var s,i;const n=`![${e}](attachment:${null!=t?t:e})`;null===(i=(s=this.editor).replaceSelection)||void 0===i||i.call(s,n)}_handleRendered(){this._rendered?(this._updateRenderedInput(),this.renderInput(this._renderer)):this.showEditor()}_updateRenderedInput(){const e=this.model,t=e&&e.value.text||"Type Markdown and LaTeX: $ α^2 $";if(t!==this._prevText){const e=new b.MimeModel({data:{"text/markdown":t}});return this._prevText=t,this._renderer.renderModel(e)}return Promise.resolve()}clone(){return new(0,this.constructor)({model:this.model,contentFactory:this.contentFactory,rendermime:this._rendermime,placeholder:!1,translator:this.translator})}}!function(e){e.defaultShowEditorForReadOnlyMarkdown=!0}(ce||(ce={}));class pe extends le{constructor(e){super(e),this.addClass("jp-RawCell");const t=this.translator.load("jupyterlab");this.node.setAttribute("aria-label",t.__("Raw Cell Content"))}clone(){return new(0,this.constructor)({model:this.model,contentFactory:this.contentFactory,placeholder:!1,translator:this.translator})}}}}]);