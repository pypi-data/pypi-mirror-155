"use strict";(self.webpackChunk_JUPYTERLAB_CORE_OUTPUT=self.webpackChunk_JUPYTERLAB_CORE_OUTPUT||[]).push([[7576],{7576:(e,t,n)=>{n.r(t),n.d(t,{EditorTableOfContentsFactory:()=>y,FileEditor:()=>d,FileEditorFactory:()=>u,FileEditorSearchProvider:()=>h,IEditorTracker:()=>k,LaTeXTableOfContentsFactory:()=>w,LaTeXTableOfContentsModel:()=>T,MarkdownTableOfContentsFactory:()=>O,MarkdownTableOfContentsModel:()=>S,PythonTableOfContentsFactory:()=>A,PythonTableOfContentsModel:()=>P,TabSpaceStatus:()=>_});var s=n(92238),i=n(32853),o=n(38957),r=n(57434),a=n(43306),c=n(74547),l=n(59985);class d extends l.Widget{constructor(e){super(),this._ready=new c.PromiseDelegate,this.addClass("jp-FileEditor");const t=this._context=e.context;this._mimeTypeService=e.mimeTypeService;const n=this._editorWidget=new o.CodeEditorWrapper({factory:e.factory,model:t.model});this._editorWidget.addClass("jp-FileEditorCodeWrapper"),this._editorWidget.node.dataset.jpCodeRunner="true",this._editorWidget.node.dataset.jpUndoer="true",this.editor=n.editor,this.model=n.model,t.ready.then((()=>{this._onContextReady()})),t.pathChanged.connect(this._onPathChanged,this),this._onPathChanged(),(this.layout=new l.StackedLayout).addWidget(n)}get context(){return this._context}get ready(){return this.ready}handleEvent(e){this.model&&"mousedown"===e.type&&this._ensureFocus()}onAfterAttach(e){super.onAfterAttach(e),this.node.addEventListener("mousedown",this)}onBeforeDetach(e){this.node.removeEventListener("mousedown",this)}onActivateRequest(e){this._ensureFocus()}_ensureFocus(){this.editor.hasFocus()||this.editor.focus()}_onContextReady(){this.isDisposed||(this.editor.clearHistory(),this._ready.resolve(void 0))}_onPathChanged(){const e=this.editor,t=this._context.localPath;e.model.mimeType=this._mimeTypeService.getMimeTypeByFilePath(t)}}class u extends r.ABCWidgetFactory{constructor(e){super(e.factoryOptions),this._services=e.editorServices}createNewWidget(e){const t=this._services.factoryService.newDocumentEditor,n=new d({factory:e=>t(e),context:e,mimeTypeService:this._services.mimeTypeService});return n.title.icon=a.textEditorIcon,new r.DocumentWidget({content:n,context:e})}}class h extends i.CodeMirrorSearchProvider{constructor(e){super(),this.editor=e.content.editor}static createNew(e,t){return new h(e)}static isApplicable(e){return e instanceof s.MainAreaWidget&&e.content instanceof d&&e.content.editor instanceof i.CodeMirrorEditor}getInitialQuery(){const e=this.editor.doc.getSelection();return-1===e.search(/\r?\n|\r/g)?e:""}}var p=n(1721),m=n(96936),g=n(72245),f=n.n(g);function v(e){const t=(e.translator||m.nullTranslator).load("jupyterlab"),n=e.isSpaces?t.__("Spaces"):t.__("Tab Size");return f().createElement(p.TextItem,{onClick:e.handleClick,source:`${n}: ${e.tabSpace}`,title:t.__("Change Tab indentationâ€¦")})}class _ extends a.VDomRenderer{constructor(e){super(new _.Model),this._popup=null,this._menu=e.menu,this.translator=e.translator||m.nullTranslator,this.addClass(p.interactiveItem)}render(){return this.model&&this.model.config?f().createElement(v,{isSpaces:this.model.config.insertSpaces,tabSpace:this.model.config.tabSize,handleClick:()=>this._handleClick(),translator:this.translator}):null}_handleClick(){const e=this._menu;this._popup&&this._popup.dispose(),e.aboutToClose.connect(this._menuClosed,this),this._popup=(0,p.showPopup)({body:e,anchor:this,align:"right"})}_menuClosed(){this.removeClass(p.clickedItem)}}!function(e){class t extends a.VDomModel{constructor(){super(...arguments),this._config=null}get config(){return this._config}set config(e){const t=this._config;this._config=e,this._triggerChange(t,this._config)}_triggerChange(e,t){const n=e&&e.insertSpaces,s=e&&e.tabSize,i=t&&t.insertSpaces,o=t&&t.tabSize;n===i&&s===o||this.stateChanged.emit(void 0)}}e.Model=t}(_||(_={}));var b=n(52082);class y extends b.TableOfContentsFactory{createNew(e,t){const n=super.createNew(e,t),s=(t,n)=>{n&&e.content.editor.setCursorPosition({line:n.line,column:0})};return n.activeHeadingChanged.connect(s),e.disposed.connect((()=>{n.activeHeadingChanged.disconnect(s)})),n}}const C={part:1,chapter:1,section:1,subsection:2,subsubsection:3,paragraph:4,subparagraph:5},x=/^\s*\\(section|subsection|subsubsection){(.+)}/;class T extends b.TableOfContentsModel{get documentType(){return"latex"}get supportedOptions(){return["maximalDepth","numberHeaders"]}getHeadings(){if(!this.isActive)return Promise.resolve(null);const e=this.widget.content.model.value.text.split("\n"),t=new Array;let n=t.length;const s=new Array;for(let i=0;i<e.length;i++){const o=e[i].match(x);if(o){const e=C[o[1]];if(e<=this.configuration.maximalDepth){const r=b.TableOfContentsUtils.getPrefix(e,n,t,Object.assign(Object.assign({},this.configuration),{baseNumbering:1,numberingH1:!0}));n=e,s.push({text:o[2],prefix:r,level:e,line:i})}}}return Promise.resolve(s)}}class w extends y{isApplicable(e){var t,n;if(super.isApplicable(e)){let s=null===(n=null===(t=e.content)||void 0===t?void 0:t.model)||void 0===n?void 0:n.mimeType;return s&&("text/x-latex"===s||"text/x-stex"===s)}return!1}_createNew(e,t){return new T(e,t)}}class S extends b.TableOfContentsModel{get documentType(){return"markdown"}getHeadings(){if(!this.isActive)return Promise.resolve(null);const e=this.widget.content.model.value.text,t=b.TableOfContentsUtils.Markdown.getHeadings(e,Object.assign(Object.assign({},this.configuration),{numberHeaders:!1}));return Promise.resolve(t)}}class O extends y{isApplicable(e){var t,n;if(super.isApplicable(e)){let s=null===(n=null===(t=e.content)||void 0===t?void 0:t.model)||void 0===n?void 0:n.mimeType;return s&&b.TableOfContentsUtils.Markdown.isMarkdown(s)}return!1}_createNew(e,t){return new S(e,t)}}let E;try{E=new RegExp("^\\s*(class |def |from |import )","d")}catch(e){E=new RegExp("^\\s*(class |def |from |import )")}class P extends b.TableOfContentsModel{get documentType(){return"python"}async getHeadings(){if(!this.isActive)return Promise.resolve(null);const e=this.widget.content.model.value.text.split("\n");let t=new Array,s=!1,i=1,o=-1;for(const r of e){let e;if(o++,E.flags.includes("d"))e=E.exec(r);else{const{default:t}=await n.e(2913).then(n.t.bind(n,32913,23));e=t(E,r)}if(e){const[n]=e.indices[1];1===i&&n>0&&(i=n);const a=["from ","import "].includes(e[1]);if(a&&s)continue;s=a;const c=1+n/i;if(c>this.configuration.maximalDepth)continue;t.push({text:r.slice(n),level:c,line:o})}}return Promise.resolve(t)}}class A extends y{isApplicable(e){var t,n;if(super.isApplicable(e)){let s=null===(n=null===(t=e.content)||void 0===t?void 0:t.model)||void 0===n?void 0:n.mimeType;return s&&("application/x-python-code"===s||"text/x-python"===s)}return!1}_createNew(e,t){return new P(e,t)}}const k=new c.Token("@jupyterlab/fileeditor:IEditorTracker")}}]);